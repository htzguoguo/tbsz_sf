!function(e){function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=67)}([function(e,t){e.exports=require("express")},function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e:{default:e}}(r(37));e.exports.InternalServerError=function(e,t,r){var n={error:{code:"bf-500",message:t,context:r}};e.status(500),e.setHeader("Content-Type","application/json"),e.send(n)},e.exports.BadRequest=function(e,t,r){var n={error:{code:"bf-400",message:t,context:r}};e.status(400),e.setHeader("Content-Type","application/json"),e.send(n)},e.exports.ResourceNotFound=function(e,t,r){var n={error:{code:"bf-404",message:r||"Not Found",context:t}};e.status(404),e.setHeader("Content-Type","application/json"),e.send(n)},e.exports.ResourceDeleted=function(e){e.status(204),e.end()},e.exports.ResourceCreated=function(e,t){e.status(201),e.setHeader("Content-Type","application/json"),t?e.send(t):e.send({data:"Created"})},e.exports.ResourceUpdated=function(e,t){e.status(201),e.setHeader("Content-Type","application/json"),t?e.send(t):e.send({data:"Updated"})},e.exports.ResourceFound=function(e,t){var r=t;e.status(200),e.setHeader("Content-Type","application/json"),e.send(r)},e.exports.NotAuthorized=function(e,t){var r={error:{code:"bf-401",message:"Not Authorized",context:{url:e.url}}};t.status(401).send(r)},e.exports.ConvertNullToZeroString=function(e){var t=function(e){(0,n.default)(e).forEach(function(t){null===e[t]&&(e[t]="")})};Array.isArray(e)?e.forEach(function(e){return t(e)}):t(e)}},function(e,t){var r=e.exports={version:"2.5.1"};"number"==typeof __e&&(__e=r)},function(e,t){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(e,t,r){var n=r(46)("wks"),a=r(47),u=r(3).Symbol,s="function"==typeof u;(e.exports=function(e){return n[e]||(n[e]=s&&u[e]||(s?u:a)("Symbol."+e))}).store=n},function(e,t,r){e.exports=r(72)},function(e,t,r){"use strict";t.__esModule=!0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r(40));t.default=function(e){return function(){var t=e.apply(this,arguments);return new n.default(function(e,r){function a(u,s){try{var o=t[u](s),c=o.value}catch(e){return void r(e)}if(!o.done)return n.default.resolve(c).then(function(e){a("next",e)},function(e){a("throw",e)});e(c)}return a("next")})}}},function(e,t,r){"use strict";var n=new(r(15))("TBSZ2000","sa","ghjsj",{host:"61.136.61.40",dialect:"mssql",dialectOptions:{options:{tdsVersion:"7_3_A"}},pool:{max:5,min:0,acquire:3e4,idle:1e4}});e.exports=n},function(e,t){e.exports=require("webpack")},function(e,t){e.exports=require("path")},function(e,t,r){var n=r(3),a=r(2),u=r(20),s=r(13),o="prototype",c=function(e,t,r){var i,p,l,f=e&c.F,d=e&c.G,y=e&c.S,h=e&c.P,m=e&c.B,v=e&c.W,x=d?a:a[t]||(a[t]={}),w=x[o],E=d?n:y?n[t]:(n[t]||{})[o];d&&(r=t);for(i in r)(p=!f&&E&&void 0!==E[i])&&i in x||(l=p?E[i]:r[i],x[i]=d&&"function"!=typeof E[i]?r[i]:m&&p?u(l,n):v&&E[i]==l?function(e){var t=function(t,r,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,n)}return e.apply(this,arguments)};return t[o]=e[o],t}(l):h&&"function"==typeof l?u(Function.call,l):l,h&&((x.virtual||(x.virtual={}))[i]=l,e&c.R&&w&&!w[i]&&s(w,i,l)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t,r){var n=r(17);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=require("dateformat")},function(e,t,r){var n=r(16),a=r(43);e.exports=r(14)?function(e,t,r){return n.f(e,t,a(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){e.exports=!r(22)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports=require("sequelize")},function(e,t,r){var n=r(11),a=r(77),u=r(78),s=Object.defineProperty;t.f=r(14)?Object.defineProperty:function(e,t,r){if(n(e),t=u(t,!0),n(r),a)try{return s(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){e.exports={}},function(e,t){e.exports=require("webpack-merge")},function(e,t,r){var n=r(21);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,a){return e.call(t,r,n,a)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t,r){var n=r(83),a=r(48);e.exports=Object.keys||function(e){return n(e,a)}},function(e,t,r){var n=r(44),a=r(31);e.exports=function(e){return n(a(e))}},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t,r){"use strict";var n=r(9),a={root:n.join(__dirname,"../../"),app:n.join(__dirname,"../../app"),build:n.join(__dirname,"../../build"),style:n.join(__dirname,"../../app/styles/index.less"),antStyle:n.join(__dirname,"../../node_modules/antd/dist/antd.css"),test:n.join(__dirname,"../../tests"),node_modules:n.join(__dirname,"../../node_modules")};e.exports=a},function(e,t){e.exports=require("fs")},function(e,t,r){"use strict";var n=r(38),a=r(28),u=r(9);e.exports.toExcel=function(e,t,r){var s=a.readFileSync(u.join("./","assets","excel",e+".xlsx")),o=new n(s);return o.substitute(t,r),o.generate({type:"base64"})},e.exports.toExcelMultiSheets=function(e,t,r){for(var s=a.readFileSync(u.join("./","assets","excel",e+".xlsx")),o=new n(s),c=0;c<t.length;c++)o.substitute(t[c],r[c]);return o.generate({type:"base64"})}},function(e,t){var r=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,r){var n=r(17),a=r(3).document,u=n(a)&&n(a.createElement);e.exports=function(e){return u?a.createElement(e):{}}},function(e,t,r){var n=r(46)("keys"),a=r(47);e.exports=function(e){return n[e]||(n[e]=a(e))}},function(e,t,r){var n=r(16).f,a=r(23),u=r(4)("toStringTag");e.exports=function(e,t,r){e&&!a(e=r?e:e.prototype,u)&&n(e,u,{configurable:!0,value:t})}},function(e,t,r){var n=r(31);e.exports=function(e){return Object(n(e))}},function(e,t,r){"use strict";var n=r(21);e.exports.f=function(e){return new function(e){var t,r;this.promise=new e(function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n}),this.resolve=n(t),this.reject=n(r)}(e)}},function(e,t,r){e.exports={default:r(105),__esModule:!0}},function(e,t){e.exports=require("xlsx-template")},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(){return f.base32String(h)}function u(e,t){var r=a(),n=a(),u={access_token:r,token_type:"Bearer",expires_in:y,refresh_token:n};!function(e,t){var r=p.clone(e);r.username=t,m[r.access_token]=r,v[r.refresh_token]=r,setTimeout(function(){s(r.access_token)},1e3*y)}(u),t(u)}function s(e){delete m[e]}var o=n(r(5)),c=n(r(6)),i=function(){var e=(0,c.default)(o.default.mark(function e(t,r,n){var a,s,c,i,f,y;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.grant_type,s=t.username,c=t.password,"password"===a){e.next=3;break}return e.abrupt("return",l.BadRequest(n,"用户名或者密码错误",{username:s}));case 3:if(s&&c){e.next=5;break}return e.abrupt("return",l.BadRequest(n,"用户名或者密码错误",{username:s}));case 5:return e.prev=5,i="\n        Select * from 人事操作权限 where 姓名=:username \n        ",e.next=9,d.query(i,{replacements:{username:s},type:d.QueryTypes.SELECT});case 9:1===(f=e.sent).length?(y=f[0]).密码===c?u(0,function(e){l.ResourceFound(n,p.extend({status:"online",desc:"0",user:y},e))}):l.ResourceNotFound(n,{username:s},"密码错误"):l.ResourceNotFound(n,{username:s},"用户名不存在"),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),l.ResourceNotFound(n,{username:s},"用户名或者密码错误");case 16:case"end":return e.stop()}},e,this,[[5,13]])}));return function(t,r,n){return e.apply(this,arguments)}}(),p=r(104),l=r(1),f=(r(55),r(109)),d=r(7),y=3600,h=20,m={},v={};e.exports={logout:function(e,t){var r=(e.headers.authorization||"").split(" "),n=(r[0],r[1]);s(n),l.ResourceFound(t,p.extend({status:"offline",desc:"1"},n))},authenticate:function(e,t){i(e.body||{},e,t)},authorizationRequired:function(e,t,r){var n=e.headers.authorization||"";if(!n)return l.NotAuthorized(e,t);var a=n.split(" "),u=a[0],s=a[1];if(!u||"Bearer"!==u||!s)return l.NotAuthorized(e,t);!function(e,t){p.has(m,e)?t({valid:!0,token:m[e]}):t({valid:!1,token:null})}(s,function(n){if(!n.valid)return l.NotAuthorized(e,t);r()})}}},function(e,t,r){e.exports={default:r(73),__esModule:!0}},function(e,t,r){"use strict";var n=r(42),a=r(10),u=r(79),s=r(13),o=r(23),c=r(18),i=r(80),p=r(34),l=r(86),f=r(4)("iterator"),d=!([].keys&&"next"in[].keys()),y="values",h=function(){return this};e.exports=function(e,t,r,m,v,x,w){i(r,t,m);var E,b,S,T=function(e){if(!d&&e in C)return C[e];switch(e){case"keys":case y:return function(){return new r(this,e)}}return function(){return new r(this,e)}},g=t+" Iterator",k=v==y,F=!1,C=e.prototype,q=C[f]||C["@@iterator"]||v&&C[v],I=q||T(v),L=v?k?T("entries"):I:void 0,A="Array"==t?C.entries||q:q;if(A&&(S=l(A.call(new e)))!==Object.prototype&&S.next&&(p(S,g,!0),n||o(S,f)||s(S,f,h)),k&&q&&q.name!==y&&(F=!0,I=function(){return q.call(this)}),n&&!w||!d&&!F&&C[f]||s(C,f,I),c[t]=I,c[g]=h,v)if(E={values:k?I:T(y),keys:x?I:T("keys"),entries:L},w)for(b in E)b in C||u(C,b,E[b]);else a(a.P+a.F*(d||F),t,E);return E}},function(e,t){e.exports=!0},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,r){var n=r(26);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},function(e,t,r){var n=r(30),a=Math.min;e.exports=function(e){return e>0?a(n(e),9007199254740991):0}},function(e,t,r){var n=r(3),a="__core-js_shared__",u=n[a]||(n[a]={});e.exports=function(e){return u[e]||(u[e]={})}},function(e,t){var r=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+n).toString(36))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,r){var n=r(3).document;e.exports=n&&n.documentElement},function(e,t,r){var n=r(26),a=r(4)("toStringTag"),u="Arguments"==n(function(){return arguments}());e.exports=function(e){var t,r,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),a))?r:u?n(t):"Object"==(s=n(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t,r){var n=r(11),a=r(21),u=r(4)("species");e.exports=function(e,t){var r,s=n(e).constructor;return void 0===s||void 0==(r=n(s)[u])?t:a(r)}},function(e,t,r){var n,a,u,s=r(20),o=r(97),c=r(49),i=r(32),p=r(3),l=p.process,f=p.setImmediate,d=p.clearImmediate,y=p.MessageChannel,h=p.Dispatch,m=0,v={},x="onreadystatechange",w=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},E=function(e){w.call(e.data)};f&&d||(f=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return v[++m]=function(){o("function"==typeof e?e:Function(e),t)},n(m),m},d=function(e){delete v[e]},"process"==r(26)(l)?n=function(e){l.nextTick(s(w,e,1))}:h&&h.now?n=function(e){h.now(s(w,e,1))}:y?(u=(a=new y).port2,a.port1.onmessage=E,n=s(u.postMessage,u,1)):p.addEventListener&&"function"==typeof postMessage&&!p.importScripts?(n=function(e){p.postMessage(e+"","*")},p.addEventListener("message",E,!1)):n=x in i("script")?function(e){c.appendChild(i("script"))[x]=function(){c.removeChild(this),w.call(e)}}:function(e){setTimeout(s(w,e,1),0)}),e.exports={set:f,clear:d}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,r){var n=r(11),a=r(17),u=r(36);e.exports=function(e,t){if(n(e),a(t)&&t.constructor===e)return t;var r=u.f(e);return(0,r.resolve)(t),r.promise}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=n(r(5)),u=n(r(6)),s=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.username,e.prev=1,e.next=4,o(n);case 4:(u=e.sent)&&u.length>0?p.ResourceFound(r,u[0]):p.ResourceNotFound(r,{username:n}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),p.InternalServerError(r,e.t0,{username:n});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),o=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="\n    Select * from 人事操作权限 where 姓名=:username \n    ",e.next=3,i.query(r,{replacements:{username:t},type:i.QueryTypes.SELECT});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),c=r(15),i=(r(108),r(7)),p=r(1),l=i.define("user",{"姓名":{type:c.STRING},"单位编号":{type:c.STRING},"单位名称":{type:c.STRING},"部门编号":{type:c.STRING},"部门名称":{type:c.STRING},"密码":{type:c.STRING}},{timestamps:!1,tableName:"人事操作权限"});l.prototype.checkPassword=function(e,t){e===this.密码?t(null,!0):t(null,!1)},l.prototype.initAdminUser=function(e,t,r){l.findAll({where:{"姓名":"admin1"}}).then(function(e){0===e.length?l.build({"姓名":"admin1","密码":"123456"}).save().then(function(e){console.log("Creating Admin user")}).catch(function(e){console.log(e)}):console.log("Admin user already exist")}).catch(function(e){console.log(e)})},e.exports=l,e.exports.queryUser=s},function(e,t,r){"use strict";e.exports=function(e){return{module:{rules:[{test:/\.(js|jsx)$/,loaders:["babel-loader"],include:e}]}}}},function(e,t,r){e.exports={default:r(121),__esModule:!0}},function(e,t,r){"use strict";e.exports=function(e){return{module:{rules:[{test:/\.(css)$/,loaders:["style-loader","css-loader"]}]}}}},function(e,t,r){"use strict";e.exports=function(e){return{module:{rules:[{test:/\.less$/,include:e,loaders:["style-loader","css-loader","less-loader"]}]}}}},function(e,t,r){"use strict";var n=r(126);e.exports=function(e,t){return{plugins:[new n([{context:e,from:"**/*",to:t}])]}}},function(e,t){e.exports=require("extract-text-webpack-plugin")},function(e,t){e.exports=require("clean-webpack-plugin")},function(e,t){e.exports={name:"tbsz_sf",version:"1.0.0",description:"天保市政水费收费系统",main:"index.js",repository:{type:"git",url:"https://github.com/htzguoguo/tbsz_sf.git"},scripts:{stats:"webpack --profile --json > stats.json",test:"karma start","build:client":"webpack --config webpack/client.webpack.config.js --progress","build:server":"cross-env NODE_ENV=production webpack --config webpack/server.webpack.config.js --progress",start:"nodemon server/app.js",pru:"cd server &&set NODE_ENV=production&& pm2 start bin/main.js --name csgs_admin",deploy:"gh-pages -d build",tdd:"karma start --auto-watch --no-single-run",flow:"flow check",lint:"eslint ./app ./tests --ext .js --ext .jsx","lint:style":"stylelint app/**/*.css"},keywords:[],author:"",license:"ISC",devDependencies:{"@types/react":"^16.4.6","@types/react-dom":"^16.0.6",alt:"^0.18.6","alt-container":"^1.1.1","alt-utils":"^2.0.0","axios-mock-adapter":"^1.10.0","babel-core":"^6.26.0","babel-eslint":"^8.0.3","babel-loader":"^7.1.2","babel-plugin-import":"^1.6.2","babel-plugin-syntax-decorators":"^6.13.0","babel-plugin-syntax-dynamic-import":"^6.18.0","babel-plugin-transform-class-properties":"^6.24.1","babel-plugin-transform-decorators-legacy":"^1.3.4","babel-plugin-transform-object-rest-spread":"^6.26.0","babel-plugin-transform-runtime":"^6.23.0","babel-preset-env":"^1.6.1","babel-preset-es2015":"^6.24.1","babel-preset-flow":"^6.23.0","babel-preset-latest":"^6.24.1","babel-preset-react":"^6.24.1","babel-preset-react-hmre":"^1.1.1","bcrypt-nodejs":"0.0.3","body-parser":"^1.18.2","clean-webpack-plugin":"^0.1.17","cookie-parser":"^1.4.3","copy-webpack-plugin":"^4.3.0","crispy-string":"0.0.2","cross-env":"^5.1.3","css-loader":"^0.28.7",cssnano:"^3.10.0","es6-shim":"^0.35.3",eslint:"^4.12.1","eslint-loader":"^1.9.0","eslint-plugin-react":"^7.5.1",express:"^4.16.2","express-cache-control":"^1.0.2","express-session":"^1.15.6","extract-text-webpack-plugin":"^3.0.2","file-loader":"^1.1.5","flow-bin":"^0.60.1",formidable:"^1.2.1","gh-pages":"^1.1.0","html-webpack-plugin":"^2.30.1","html-webpack-template":"^6.1.0","iconv-lite":"^0.4.24","isparta-instrumenter-loader":"^1.0.1","isparta-loader":"^2.0.0",jscs:"^3.0.7","jscs-loader":"^0.3.0",karma:"^1.7.1","karma-chrome-launcher":"^2.2.0","karma-coverage":"^1.1.1","karma-mocha":"^1.3.0","karma-phantomjs-launcher":"^1.0.4","karma-sourcemap-loader":"^0.3.7","karma-spec-reporter":"0.0.31","karma-webpack":"^2.0.6",less:"^2.7.3","less-loader":"^4.0.5",lodash:"^4.17.4",mocha:"^4.0.1","node-uuid":"^1.4.8","npm-install-webpack-plugin":"^4.0.5",nzh:"^1.0.3","optimize-css-assets-webpack-plugin":"^3.2.0","phantomjs-polyfill":"0.0.2","phantomjs-prebuilt":"^2.1.16","postcss-loader":"^2.0.9","react-addons-test-utils":"^15.6.2","react-addons-update":"^15.6.2","react-dnd":"^2.5.4","react-dnd-html5-backend":"^2.5.4","react-dnd-test-backend":"^2.5.4","react-hot-loader":"^3.1.3","redux-devtools":"^3.4.1","redux-devtools-dock-monitor":"^1.1.2","redux-devtools-log-monitor":"^1.4.0",sequelize:"^4.28.6","style-loader":"^0.19.0",stylelint:"^8.3.1","stylelint-config-recommended":"^2.0.0",tedious:"^2.1.5","uglifyjs-webpack-plugin":"^1.1.5",underscore:"^1.8.3","url-loader":"^0.6.2",uuid:"^3.1.0",webpack:"^3.8.1","webpack-dev-middleware":"^2.0.3","webpack-dev-server":"^2.9.4","webpack-hot-middleware":"^2.21.0","webpack-merge":"^4.1.1","webpack-node-externals":"^1.6.0",xlsx:"^0.13.2","xlsx-style":"^0.8.13","xlsx-template":"^0.3.1"},dependencies:{antd:"^3.8.2",axios:"^0.17.1","print-html-element":"^0.5.1","print-js":"^1.0.47","prop-types":"^15.6.2",react:"^16.1.1","react-dom":"^16.1.1","react-intl":"^2.4.0","react-redux":"^5.0.6","react-router":"^4.2.0","react-router-dom":"^4.2.2",redux:"^3.7.2","redux-thunk":"^2.2.0"},bundledDependencies:["cross-env","express"]}},function(e,t,r){"use strict";t.__esModule=!0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r(152));t.default=n.default||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,r){"use strict";var n=/^([+-])?0*(\d+)(\.(\d+))?$/,a=/^([+-])?0*(\d+)(\.(\d+))?e(([+-])?(\d+))$/i,u=t.e2ten=function(e){var t=a.exec(e.toString());if(!t)return e;var r=t[2],n=t[4]||"",u=t[5]?+t[5]:0;if(u>0){var s=n.substr(0,u);s=s.length<u?s+new Array(u-s.length+1).join("0"):s,n=n.substr(u),r+=s}else{u=-u;var o=r.length-u;o=o<0?0:o;var c=r.substr(o,u);c=c.length<u?new Array(u-c.length+1).join("0")+c:c,r=r.substring(0,o),n=c+n}return r=""==r?"0":r,("-"==t[1]?"-":"")+r+(n?"."+n:"")};t.getNumbResult=function(e){var t=n.exec(e.toString());if(!t&&a.test(e.toString())&&(t=n.exec(u(e.toString()))),t)return{int:t[2],decimal:t[4],minus:"-"==t[1],num:t.slice(1,3).join("")}},t.centerArray=function e(t,r){if(t.splice.apply(t,[0,r.length].concat(r.splice(0,r.length))),arguments.length>2){var n=[].slice.call(arguments,2);n.unshift(t),e.apply(null,n)}return t};var s=t.hasAttr=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};t.extend=function(e){for(var t,r=arguments[0]||{},n=Array.prototype.slice.call(arguments,1),a=0;a<n.length;a++){var u=n[a];for(t in u)s(u,t)&&(r[t]=u[t])}return r},t.getDigit=function(e){return e>=5?4*(e-4)+4:e},t.unshiftZero=function(e,t){if(null==t&&(t=1),!(t<=0))for(;t--;)e.unshift(0)},t.clearZero=function(e,t,r){if(null==e)return"";var n=~"*.?+$^[](){}|\\/".indexOf(t)?"\\"+t:t,a=new RegExp("^"+n+"+"),u=new RegExp(n+"+$"),s=new RegExp(n+"{2}","g");return e=e.toString(),"^"==r&&(e=e.replace(a,"")),r&&"$"!=r||(e=e.replace(u,"")),r&&"nto1"!=r||(e=e.replace(s,t)),e}},function(e,t,r){"use strict";var n=r(0),a=(r(9),r(68)),u=r(69),s=r(70),o=(new(r(71))).middleware,c=r(39),i=r(110),p=r(138),l=r(139),f=n(),d=Object({NODE_ENV:"production"}).PORT||8180;f.use(s.json()),f.use(s.urlencoded({extended:!1})),f.use(u("login")),f.use(a({secret:"TKRv0IJs=HYqrvagQ#&!F!%V]Ww/4KiVs$s,<<MX",resave:!0,saveUninitialized:!0,cookie:{maxAge:3e5}})),i(f),f.use("/api/v1/auth",o("minutes",2),p),f.use("/api/v1",c.authorizationRequired,l),e.exports=f,f.listen(d)},function(e,t){e.exports=require("express-session")},function(e,t){e.exports=require("cookie-parser")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("express-cache-control")},function(e,t){e.exports=require("regenerator-runtime")},function(e,t,r){r(74),r(75),r(87),r(91),r(102),r(103),e.exports=r(2).Promise},function(e,t){},function(e,t,r){"use strict";var n=r(76)(!0);r(41)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=n(t,r),this._i+=e.length,{value:e,done:!1})})},function(e,t,r){var n=r(30),a=r(31);e.exports=function(e){return function(t,r){var u,s,o=String(a(t)),c=n(r),i=o.length;return c<0||c>=i?e?"":void 0:(u=o.charCodeAt(c))<55296||u>56319||c+1===i||(s=o.charCodeAt(c+1))<56320||s>57343?e?o.charAt(c):u:e?o.slice(c,c+2):s-56320+(u-55296<<10)+65536}}},function(e,t,r){e.exports=!r(14)&&!r(22)(function(){return 7!=Object.defineProperty(r(32)("div"),"a",{get:function(){return 7}}).a})},function(e,t,r){var n=r(17);e.exports=function(e,t){if(!n(e))return e;var r,a;if(t&&"function"==typeof(r=e.toString)&&!n(a=r.call(e)))return a;if("function"==typeof(r=e.valueOf)&&!n(a=r.call(e)))return a;if(!t&&"function"==typeof(r=e.toString)&&!n(a=r.call(e)))return a;throw TypeError("Can't convert object to primitive value")}},function(e,t,r){e.exports=r(13)},function(e,t,r){"use strict";var n=r(81),a=r(43),u=r(34),s={};r(13)(s,r(4)("iterator"),function(){return this}),e.exports=function(e,t,r){e.prototype=n(s,{next:a(1,r)}),u(e,t+" Iterator")}},function(e,t,r){var n=r(11),a=r(82),u=r(48),s=r(33)("IE_PROTO"),o=function(){},c="prototype",i=function(){var e,t=r(32)("iframe"),n=u.length;for(t.style.display="none",r(49).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),i=e.F;n--;)delete i[c][u[n]];return i()};e.exports=Object.create||function(e,t){var r;return null!==e?(o[c]=n(e),r=new o,o[c]=null,r[s]=e):r=i(),void 0===t?r:a(r,t)}},function(e,t,r){var n=r(16),a=r(11),u=r(24);e.exports=r(14)?Object.defineProperties:function(e,t){a(e);for(var r,s=u(t),o=s.length,c=0;o>c;)n.f(e,r=s[c++],t[r]);return e}},function(e,t,r){var n=r(23),a=r(25),u=r(84)(!1),s=r(33)("IE_PROTO");e.exports=function(e,t){var r,o=a(e),c=0,i=[];for(r in o)r!=s&&n(o,r)&&i.push(r);for(;t.length>c;)n(o,r=t[c++])&&(~u(i,r)||i.push(r));return i}},function(e,t,r){var n=r(25),a=r(45),u=r(85);e.exports=function(e){return function(t,r,s){var o,c=n(t),i=a(c.length),p=u(s,i);if(e&&r!=r){for(;i>p;)if((o=c[p++])!=o)return!0}else for(;i>p;p++)if((e||p in c)&&c[p]===r)return e||p||0;return!e&&-1}}},function(e,t,r){var n=r(30),a=Math.max,u=Math.min;e.exports=function(e,t){return(e=n(e))<0?a(e+t,0):u(e,t)}},function(e,t,r){var n=r(23),a=r(35),u=r(33)("IE_PROTO"),s=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=a(e),n(e,u)?e[u]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?s:null}},function(e,t,r){r(88);for(var n=r(3),a=r(13),u=r(18),s=r(4)("toStringTag"),o="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),c=0;c<o.length;c++){var i=o[c],p=n[i],l=p&&p.prototype;l&&!l[s]&&a(l,s,i),u[i]=u.Array}},function(e,t,r){"use strict";var n=r(89),a=r(90),u=r(18),s=r(25);e.exports=r(41)(Array,"Array",function(e,t){this._t=s(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,a(1)):a(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])},"values"),u.Arguments=u.Array,n("keys"),n("values"),n("entries")},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,r){"use strict";var n,a,u,s,o=r(42),c=r(3),i=r(20),p=r(50),l=r(10),f=r(17),d=r(21),y=r(92),h=r(93),m=r(51),v=r(52).set,x=r(98)(),w=r(36),E=r(53),b=r(54),S="Promise",T=c.TypeError,g=c.process,k=c[S],F="process"==p(g),C=function(){},q=a=w.f,I=!!function(){try{var e=k.resolve(1),t=(e.constructor={})[r(4)("species")]=function(e){e(C,C)};return(F||"function"==typeof PromiseRejectionEvent)&&e.then(C)instanceof t}catch(e){}}(),L=function(e){var t;return!(!f(e)||"function"!=typeof(t=e.then))&&t},A=function(e,t){if(!e._n){e._n=!0;var r=e._c;x(function(){for(var n=e._v,a=1==e._s,u=0,s=function(t){var r,u,s=a?t.ok:t.fail,o=t.resolve,c=t.reject,i=t.domain;try{s?(a||(2==e._h&&_(e),e._h=1),!0===s?r=n:(i&&i.enter(),r=s(n),i&&i.exit()),r===t.promise?c(T("Promise-chain cycle")):(u=L(r))?u.call(r,o,c):o(r)):c(n)}catch(e){c(e)}};r.length>u;)s(r[u++]);e._c=[],e._n=!1,t&&!e._h&&R(e)})}},R=function(e){v.call(c,function(){var t,r,n,a=e._v,u=Q(e);if(u&&(t=E(function(){F?g.emit("unhandledRejection",a,e):(r=c.onunhandledrejection)?r({promise:e,reason:a}):(n=c.console)&&n.error&&n.error("Unhandled promise rejection",a)}),e._h=F||Q(e)?2:1),e._a=void 0,u&&t.e)throw t.v})},Q=function(e){if(1==e._h)return!1;for(var t,r=e._a||e._c,n=0;r.length>n;)if((t=r[n++]).fail||!Q(t.promise))return!1;return!0},_=function(e){v.call(c,function(){var t;F?g.emit("rejectionHandled",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})})},N=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),A(t,!0))},D=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw T("Promise can't be resolved itself");(t=L(e))?x(function(){var n={_w:r,_d:!1};try{t.call(e,i(D,n,1),i(N,n,1))}catch(e){N.call(n,e)}}):(r._v=e,r._s=1,A(r,!1))}catch(e){N.call({_w:r,_d:!1},e)}}};I||(k=function(e){y(this,k,S,"_h"),d(e),n.call(this);try{e(i(D,this,1),i(N,this,1))}catch(e){N.call(this,e)}},(n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r(99)(k.prototype,{then:function(e,t){var r=q(m(this,k));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=F?g.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&A(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),u=function(){var e=new n;this.promise=e,this.resolve=i(D,e,1),this.reject=i(N,e,1)},w.f=q=function(e){return e===k||e===s?new u(e):a(e)}),l(l.G+l.W+l.F*!I,{Promise:k}),r(34)(k,S),r(100)(S),s=r(2)[S],l(l.S+l.F*!I,S,{reject:function(e){var t=q(this);return(0,t.reject)(e),t.promise}}),l(l.S+l.F*(o||!I),S,{resolve:function(e){return b(o&&this===s?k:this,e)}}),l(l.S+l.F*!(I&&r(101)(function(e){k.all(e).catch(C)})),S,{all:function(e){var t=this,r=q(t),n=r.resolve,a=r.reject,u=E(function(){var r=[],u=0,s=1;h(e,!1,function(e){var o=u++,c=!1;r.push(void 0),s++,t.resolve(e).then(function(e){c||(c=!0,r[o]=e,--s||n(r))},a)}),--s||n(r)});return u.e&&a(u.v),r.promise},race:function(e){var t=this,r=q(t),n=r.reject,a=E(function(){h(e,!1,function(e){t.resolve(e).then(r.resolve,n)})});return a.e&&n(a.v),r.promise}})},function(e,t){e.exports=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e}},function(e,t,r){var n=r(20),a=r(94),u=r(95),s=r(11),o=r(45),c=r(96),i={},p={};(t=e.exports=function(e,t,r,l,f){var d,y,h,m,v=f?function(){return e}:c(e),x=n(r,l,t?2:1),w=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(u(v)){for(d=o(e.length);d>w;w++)if((m=t?x(s(y=e[w])[0],y[1]):x(e[w]))===i||m===p)return m}else for(h=v.call(e);!(y=h.next()).done;)if((m=a(h,x,y.value,t))===i||m===p)return m}).BREAK=i,t.RETURN=p},function(e,t,r){var n=r(11);e.exports=function(e,t,r,a){try{return a?t(n(r)[0],r[1]):t(r)}catch(t){var u=e.return;throw void 0!==u&&n(u.call(e)),t}}},function(e,t,r){var n=r(18),a=r(4)("iterator"),u=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||u[a]===e)}},function(e,t,r){var n=r(50),a=r(4)("iterator"),u=r(18);e.exports=r(2).getIteratorMethod=function(e){if(void 0!=e)return e[a]||e["@@iterator"]||u[n(e)]}},function(e,t){e.exports=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},function(e,t,r){var n=r(3),a=r(52).set,u=n.MutationObserver||n.WebKitMutationObserver,s=n.process,o=n.Promise,c="process"==r(26)(s);e.exports=function(){var e,t,r,i=function(){var n,a;for(c&&(n=s.domain)&&n.exit();e;){a=e.fn,e=e.next;try{a()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(c)r=function(){s.nextTick(i)};else if(u){var p=!0,l=document.createTextNode("");new u(i).observe(l,{characterData:!0}),r=function(){l.data=p=!p}}else if(o&&o.resolve){var f=o.resolve();r=function(){f.then(i)}}else r=function(){a.call(n,i)};return function(n){var a={fn:n,next:void 0};t&&(t.next=a),e||(e=a,r()),t=a}}},function(e,t,r){var n=r(13);e.exports=function(e,t,r){for(var a in t)r&&e[a]?e[a]=t[a]:n(e,a,t[a]);return e}},function(e,t,r){"use strict";var n=r(3),a=r(2),u=r(16),s=r(14),o=r(4)("species");e.exports=function(e){var t="function"==typeof a[e]?a[e]:n[e];s&&t&&!t[o]&&u.f(t,o,{configurable:!0,get:function(){return this}})}},function(e,t,r){var n=r(4)("iterator"),a=!1;try{var u=[7][n]();u.return=function(){a=!0},Array.from(u,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!a)return!1;var r=!1;try{var u=[7],s=u[n]();s.next=function(){return{done:r=!0}},u[n]=function(){return s},e(u)}catch(e){}return r}},function(e,t,r){"use strict";var n=r(10),a=r(2),u=r(3),s=r(51),o=r(54);n(n.P+n.R,"Promise",{finally:function(e){var t=s(this,a.Promise||u.Promise),r="function"==typeof e;return this.then(r?function(r){return o(t,e()).then(function(){return r})}:e,r?function(r){return o(t,e()).then(function(){throw r})}:e)}})},function(e,t,r){"use strict";var n=r(10),a=r(36),u=r(53);n(n.S,"Promise",{try:function(e){var t=a.f(this),r=u(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}})},function(e,t){e.exports=require("underscore")},function(e,t,r){r(106),e.exports=r(2).Object.keys},function(e,t,r){var n=r(35),a=r(24);r(107)("keys",function(){return function(e){return a(n(e))}})},function(e,t,r){var n=r(10),a=r(2),u=r(22);e.exports=function(e,t){var r=(a.Object||{})[e]||Object[e],s={};s[e]=t(r),n(n.S+n.F*u(function(){r(1)}),"Object",s)}},function(e,t){e.exports=require("bcrypt-nodejs")},function(e,t){e.exports=require("crispy-string")},function(e,t,r){"use strict";var n=r(9),a=r(0);e.exports=function(e){var t=n.join("./","build");e.use(a.static(t)),e.get("/",function(e,t){t.sendFile(n.join("./","build","index.html"))})}},function(e,t){e.exports=require("webpack-dev-middleware")},function(e,t){e.exports=require("webpack-hot-middleware")},function(e,t,r){"use strict";r(8);var n=r(19),a=r(114),u=r(120),s=r(127),o=r(136),c=Object({NODE_ENV:"production"}).npm_lifecycle_event;if(Object({NODE_ENV:"production"}).BABEL_ENV=c,console.log("TARGET",c),"start"!==c&&c||(e.exports=n(a,u)),"build:client"!==c&&"stats"!==c||(e.exports=n(a,s)),"test"===c||"tdd"===c){var i=n(a,o);i.entry=null,e.exports=i}},function(e,t,r){"use strict";r(8);var n=r(19),a=r(27),u=r(115),s=r(56),o=(r(117),r(118),n({resolve:{extensions:[".js",".jsx"]},output:{path:a.build,filename:"[name].[hash].js",chunkFilename:"[hash].js"}},u({title:"天保市政水费收费管理系统",appMountId:"root"}),s(a.app)));e.exports=o},function(e,t,r){"use strict";var n=r(116);e.exports=function(e){return{plugins:[new n({template:"./node_modules/html-webpack-template/index.ejs",title:e.title,appMountId:e.appMountId,inject:!1})]}}},function(e,t){e.exports=require("html-webpack-plugin")},function(e,t,r){"use strict";e.exports=function(e){return{module:{rules:[{test:/\.(js|jsx)$/,loaders:["eslint-loader"],enforce:"pre",include:e}]}}}},function(e,t,r){"use strict";e.exports=function(e){return{module:{rules:[{test:/\.css$/,loader:"postcss-loader",enforce:"pre",include:e,options:{plugins:function(){return[r(119)({ignoreFiles:"node_modules/!**!/!*.css"})]}}}]}}}},function(e,t){e.exports=require("stylelint")},function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e:{default:e}}(r(57)),a=r(8),u=r(19),s=r(27),o=r(58),c=r(59),i=r(122),p=r(124),l=r(125),f=r(60),d=u({devtool:"eval-source-map",entry:["webpack-hot-middleware/client?reload=true",s.app+"/index.jsx"],plugins:[new a.optimize.OccurrenceOrderPlugin,new a.HotModuleReplacementPlugin,new a.NoErrorsPlugin,new a.DefinePlugin({"process.env.NODE_ENV":(0,n.default)("development")})]},o(s.app),c(s.app),p(),l(),i({save:!0}),f(s.app+"/assets",s.build+"/assets"));e.exports=d},function(e,t,r){var n=r(2),a=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return a.stringify.apply(a,arguments)}},function(e,t,r){"use strict";var n=r(123);e.exports=function(e){return e=e||{},{plugins:[new n(e)]}}},function(e,t){e.exports=require("npm-install-webpack-plugin")},function(e,t,r){"use strict";e.exports=function(){return{module:{rules:[{test:/\.(woff|woff2|eot|ttf|otf)$/,use:["url-loader"]}]}}}},function(e,t,r){"use strict";e.exports=function(){return{module:{rules:[{test:/\.(png|svg|jpg|gif)$/,use:["url-loader"]}]}}}},function(e,t){e.exports=require("copy-webpack-plugin")},function(e,t,r){"use strict";r(8);var n=r(19),a=(r(61),r(62),r(63),r(27)),u=r(128),s=r(129),o=r(130),c=r(131),i=r(132),p=r(60),l=r(133),f=n({entry:{app:a.app+"/index.jsx",style:a.style}},o(a.build),c("process.env.NODE_ENV","production"),s(),i(),u(a.app),p(a.app+"/assets",a.build+"/assets"),l({options:{discardComments:{removeAll:!0},safe:!0}}));e.exports=f},function(e,t,r){"use strict";var n=r(61);e.exports=function(e){return{module:{rules:[{test:/\.css$/,use:n.extract({fallback:"style-loader",use:["css-loader"]})},{test:/\.less$/,use:n.extract({fallback:"style-loader",use:["css-loader","less-loader"]}),include:e},{test:/\.(png|jpg)$/,loader:"url-loader?name=assets/images/[name].[ext]&limit=8192"}]},plugins:[new n("[name].[hash].css")]}}},function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e:{default:e}}(r(37)),a=r(8),u=r(63);e.exports=function(e){return{entry:{vendor:(0,n.default)(u.dependencies).filter(function(e){return"alt-utils"!==e})},plugins:[new a.optimize.CommonsChunkPlugin({names:["vendor","manifest"]})]}}},function(e,t,r){"use strict";var n=r(62);e.exports=function(e){return{plugins:[new n([e],{root:process.cwd()})]}}},function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e:{default:e}}(r(57)),a=r(8);e.exports=function(e,t){var r={};return r[e]=(0,n.default)(t),{plugins:[new a.DefinePlugin(r)]}}},function(e,t,r){"use strict";var n=r(8);e.exports=function(){return{plugins:[new n.optimize.UglifyJsPlugin({compress:{warnings:!1},mangle:!0,comments:!1})]}}},function(e,t,r){"use strict";var n=r(134),a=r(135);e.exports=function(e){var t=e.options;return{plugins:[new n({cssProcessor:a,cssProcessorOptions:t,canPrint:!1})]}}},function(e,t){e.exports=require("optimize-css-assets-webpack-plugin")},function(e,t){e.exports=require("cssnano")},function(e,t,r){"use strict";r(8);var n=r(19),a=r(27),u=r(137),s=r(58),o=(r(56),r(59)),c=n({entry:{app:a.app+"/index.jsx",style:a.style},devtool:"inline-source-map"},u(a.app),s(a.app),o(a.app));e.exports=c},function(e,t,r){"use strict";e.exports=function(e){return{module:{rules:[{test:/\.(js|jsx)$/,loaders:["isparta-instrumenter-loader"],enforce:"pre",include:e}]}}}},function(e,t,r){"use strict";var n=r(0).Router(),a=r(39);n.post("/",a.authenticate),n.delete("/",a.logout),e.exports=n},function(e,t,r){"use strict";var n=r(0).Router(),a=r(140),u=r(141),s=r(143),o=r(150),c=r(162),i=r(164),p=r(166),l=r(168),f=r(170),d=r(180),y=r(182);n.use("/users",a),n.use("/menu",u),n.use("/workitems",s),n.use("/water",o),n.use("/unit",c),n.use("/stat",i),n.use("/report",p),n.use("/detail",l),n.use("/collection",f),n.use("/upload",d),n.use("/dict",y),e.exports=n},function(e,t,r){"use strict";r(1);var n=r(0),a=r(55).queryUser,u=n.Router();u.get("/my/:username",a),e.exports=u},function(e,t,r){"use strict";var n=r(1),a=r(0).Router(),u=r(142);a.get("/",function(e,t,r){Number(e.params.id);n.ResourceFound(t,u)}),e.exports=a},function(e,t,r){"use strict";e.exports={menus:[{key:"menu1",name:"录入管理",icon:"home",baseurl:"/app/toll",url:"/app/toll/take/0/0/0",child:[{key:"sub11",name:"录入",icon:"user",child:[{key:"sidebarsub111",name:"录入月水费",icon:"user",matchurl:"/app/toll/take/:num/:year/:month",url:"/app/toll/take/0/0/0"},{key:"sidebarsub112",name:"浏览月水费",icon:"user",matchurl:"/app/toll/list",url:"/app/toll/list"},{key:"sidebarsub113",name:"查询月水费",icon:"user",matchurl:"/app/toll/search",url:"/app/toll/search"},{key:"sidebarsub114",name:"自动创建月水费",icon:"user",matchurl:"/app/toll/prepare",url:"/app/toll/prepare"}]},{key:"sub12",name:"单位",icon:"user",child:[{key:"sidebarsub121",name:"录入单位基本信息",icon:"user",matchurl:"/app/unit/entry",url:"/app/unit/entry"},{key:"sidebarsub122",name:"录入修改托收信息",icon:"user",matchurl:"/app/unit/collection",url:"/app/unit/collection"},{key:"sidebarsub123",name:"单位信息查询",icon:"user",matchurl:"/app/unit/search",url:"/app/unit/search"},{key:"sidebarsub124",name:"录入水贴费",icon:"user",matchurl:"/app/unit/allowedit",url:"/app/unit/allowedit"},{key:"sidebarsub125",name:"水表过户",icon:"user",matchurl:"/app/unit/change",url:"/app/unit/change"},{key:"sidebarsub126",name:"浏览过户信息",icon:"user",matchurl:"/app/unit/changebrowse",url:"/app/unit/changebrowse"},{key:"sidebarsub127",name:"水量错误检查",icon:"user",matchurl:"/app/unit/errorcheck",url:"/app/unit/errorcheck"},{key:"sidebarsub128",name:"更改用户编号",icon:"user",matchurl:"/app/unit/changeid",url:"/app/unit/changeid"}]}]},{key:"menu2",name:"查询管理",icon:"user",baseurl:"/app/search",url:"/app/search/unit",child:[{key:"sub21",name:"查询",icon:"user",child:[{key:"sidebarsub211",name:"单位信息查询",icon:"user",matchurl:"/app/search/unit",url:"/app/search/unit"},{key:"sidebarsub212",name:"水费信息查询",icon:"user",matchurl:"/app/search/toll",url:"/app/search/toll"},{key:"sidebarsub213",name:"统计水费",icon:"user",matchurl:"/app/search/stattoll",url:"/app/search/stattoll"},{key:"sidebarsub214",name:"按欠费单位统计",icon:"user",matchurl:"/app/search/lackunit",url:"/app/search/lackunit"}]}]},{key:"menu3",name:"报表管理",icon:"laptop",baseurl:"/app/report",url:"/app/report/commission",child:[{key:"sub31",name:"报表",icon:"user",child:[{key:"sidebarsub311",name:"委托收款报表",icon:"user",matchurl:"/app/report/commission",url:"/app/report/commission"},{key:"sidebarsub312",name:"水费结算单",icon:"user",matchurl:"/app/report/detail",url:"/app/report/detail"},{key:"sidebarsub313",name:"月汇总表",icon:"user",matchurl:"/app/report/chargemonth",url:"/app/report/chargemonth"},{key:"sidebarsub314",name:"年汇总表",icon:"user",matchurl:"/app/report/chargeyear",url:"/app/report/chargeyear"},{key:"sidebarsub315",name:"贴费汇总表",icon:"user",matchurl:"/app/report/allowance",url:"/app/report/allowance"},{key:"sidebarsub316",name:"委托收款报表_临时",icon:"user",matchurl:"/app/report/commissiontemp",url:"/app/report/commissiontemp"}]}]},{key:"menu4",name:"明细管理",icon:"notification",baseurl:"/app/detail",url:"/app/detail/allowance",child:[{key:"sub41",name:"明细",icon:"user",child:[{key:"sidebarsub411",name:"水贴费",icon:"user",matchurl:"/app/detail/allowance",url:"/app/detail/allowance"},{key:"sidebarsub412",name:"装表费",icon:"user",matchurl:"/app/detail/fixwatch",url:"/app/detail/fixwatch"},{key:"sidebarsub413",name:"用水指标",icon:"user",matchurl:"/app/detail/ration",url:"/app/detail/ration"},{key:"sidebarsub414",name:"供水合同",icon:"user",matchurl:"/app/detail/contract",url:"/app/detail/contract"},{key:"sidebarsub415",name:"市政公司用水",icon:"user",matchurl:"/app/detail/countshizheng",url:"/app/detail/countshizheng"},{key:"sidebarsub416",name:"公司销售水清单",icon:"user",matchurl:"/app/detail/countall",url:"/app/detail/countall"}]}]},{key:"menu5",name:"托收管理",icon:"notification",baseurl:"/app/collection",url:"/app/collection/outputbank",child:[{key:"sub51",name:"托收",icon:"user",child:[{key:"sidebarsub511",name:"按银行生成托收",icon:"user",matchurl:"/app/collection/outputbank",url:"/app/collection/outputbank"},{key:"sidebarsub512",name:"按用户生成托收",icon:"user",matchurl:"/app/collection/outputuser",url:"/app/collection/outputuser"},{key:"sidebarsub513",name:"打印托收信封及清单",icon:"user",matchurl:"/app/collection/rsoutputbank",url:"/app/collection/rsoutputbank"},{key:"sidebarsub514",name:"读取回盘信息",icon:"user",matchurl:"/app/collection/inputdisk",url:"/app/collection/inputdisk"},{key:"sidebarsub515",name:"打印托收明细",icon:"user",matchurl:"/app/collection/outputdetail",url:"/app/collection/outputdetail"},{key:"sidebarsub516",name:"托收统计",icon:"user",matchurl:"/app/collection/outputcount",url:"/app/collection/outputcount"},{key:"sidebarsub517",name:"银行默认设置",icon:"user",matchurl:"/app/collection/banksetup",url:"/app/collection/banksetup"}]}]},{key:"menu6",name:"字典管理",icon:"notification",baseurl:"/app/dict",url:"/app/dict/usekind",child:[{key:"sub61",name:"字典",icon:"user",child:[{key:"sidebarsub611",name:"用水形式字典",icon:"user",matchurl:"/app/dict/usekind",url:"/app/dict/usekind"},{key:"sidebarsub612",name:"收费形式字典",icon:"user",matchurl:"/app/dict/chargekind",url:"/app/dict/chargekind"},{key:"sidebarsub613",name:"抄表形式字典",icon:"user",matchurl:"/app/dict/InputKind",url:"/app/dict/InputKind"},{key:"sidebarsub614",name:"费用标准字典",icon:"user",matchurl:"/app/dict/chargestandard",url:"/app/dict/chargestandard"},{key:"sidebarsub615",name:"防火费标准字典",icon:"user",matchurl:"/app/dict/firestandard",url:"/app/dict/firestandard"}]}]}]}},function(e,t,r){"use strict";r(1);var n=r(0),a=r(144),u=n.Router();u.get("/",function(e,t,r){a.pagingQuery(e,t)}),e.exports=u},function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e:{default:e}}(r(145)),a=r(15),u=r(149),s=r(1),o=u.define("workitem",{ID:{type:a.INTEGER},CaseCatalog:{type:a.STRING},ParentCatalogName:{type:a.STRING},SubName:{type:a.STRING},ViewResult:{type:a.STRING},DealWithDesc:{type:a.STRING},FacilityDesc:{type:a.STRING},MonitoringUnit:{type:a.STRING},FinishedStandard:{type:a.STRING},RegistStandard:{type:a.STRING}},{timestamps:!1,tableName:"V_W_WorkingItems_Prices"});o.pagingQuery=function(e,t){var r=Number(e.query.page)||1,c=Number(e.query.results)||10,i=e.query.sortField||"ID",p=function(e){return e?e.replace("end",""):"asc"}(e.query.sortOrder),l=e.query.SubName||"%",f=e.query.ParentCatalogName||"%";c>100&&(c=100);var d="declare @rowsPerPage as bigint; declare @pageNum as bigint;set @rowsPerPage="+c+"; set @pageNum="+r+";   With SQLPaging As   ( Select Top(@rowsPerPage * @pageNum) ROW_NUMBER() OVER ( ORDER BY "+i+" "+p+") as resultNum, * FROM V_W_WorkingItems_Prices where SubName like :subName and ParentCatalogName like :parentName)select * from SQLPaging with (nolock) where resultNum > ((@pageNum - 1) * @rowsPerPage); ",y={};o.count({where:{SubName:(0,n.default)({},a.Op.like,"%"+l+"%"),ParentCatalogName:(0,n.default)({},a.Op.like,"%"+f+"%")}}).then(function(e){return y.count=e,u.query(d,{replacements:{subName:"%"+l+"%",parentName:"%"+f+"%"},model:o})}).then(function(e){e?(y.data=e,s.ResourceFound(t,y)):s.ResourceNotFound(t,{ID:all})}).catch(function(e){console.log("error",e),s.InternalServerError(t,e,{ID:all})})},e.exports=o},function(e,t,r){"use strict";t.__esModule=!0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r(146));t.default=function(e,t,r){return t in e?(0,n.default)(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},function(e,t,r){e.exports={default:r(147),__esModule:!0}},function(e,t,r){r(148);var n=r(2).Object;e.exports=function(e,t,r){return n.defineProperty(e,t,r)}},function(e,t,r){var n=r(10);n(n.S+n.F*!r(14),"Object",{defineProperty:r(16).f})},function(e,t,r){"use strict";var n=new(r(15))("SUP_APP_RoadInspectCaseDatabase2011_20110428-G","sa","ghjsj",{host:"61.136.61.40",dialect:"mssql",dialectOptions:{options:{tdsVersion:"7_3_A"}},pool:{max:5,min:0,acquire:3e4,idle:1e4}});e.exports=n},function(e,t,r){"use strict";var n=r(0),a=r(151),u=a.queryWaterFee,s=a.queryWaterFees,o=a.calculateWaterFee,c=a.saveWaterFee,i=a.MoveWaterFeePosition,p=a.statisticsWaterFees,l=a.waterFeeToExcel,f=a.deleteWaterFee,d=a.queryWaterFeesNum,y=a.prepareWaterFees,h=a.eraseZeroWaterFees,m=a.queryFeeParas,v=a.searchWaterFees,x=a.searchToExcel,w=n.Router();w.get("/fee/:num/:year/:month",function(e,t,r){var n=e.params,a=n.num,s=n.year,o=n.month;u(a,s,o,t)}),w.delete("/fee/:num/:year/:month",f),w.delete("/feezero/:year/:month",h),w.get("/fees/:year/:month/:type",function(e,t,r){var n=e.params,a=n.year,u=n.month,o=n.type;s(a,u,o,t)}),w.get("/feesstat/:year/:month/:type",p),w.get("/feesnum/:year/:month",d),w.get("/feeparas",m),w.get("/feestoexcel/:year/:month/:type",l),w.get("/feeprior/:num/:year/:month/:type",function(e,t){i(e,t,"prior")}),w.get("/feenext/:num/:year/:month/:type",function(e,t){i(e,t,"next")}),w.post("/calfee",o),w.post("/feesearch",v),w.post("/feesearchtoexcel",x),w.post("/feesprepare",y),w.put("/fee",c),e.exports=w},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t,r,n){p.default.all([O.query("\n    SELECT A.编号, A.户名, A.区号, F.单价, D.单位性质编号, D.单位性质, E.抄表形式编号,E.抄表形式,F.排污费单价 FROM 水费单位信息 A RIGHT OUTER JOIN 水费字典单位性质 D ON A.单位性质编号 = D.单位性质编号 RIGHT OUTER JOIN \n    水费字典抄表形式 E ON A.抄表形式编号 = E.抄表形式编号 RIGHT OUTER JOIN 水费字典费用标准 F ON A.区号 = F.区号 where A.编号= :no\n    ",{replacements:{no:e},type:O.QueryTypes.SELECT}),O.query("\n    SELECT 年,月,上月表底,本月表底,用水量,计划水量,计划水费,超额水量,超额水费,防火费,手续费\n    ,实收水费,排污费,其它,申请水量,年用水量,剩余水量,减免水量,减免单价,减免水费,减排污费\n    ,减其它,应收水费, 欠费标志 from 水费基本表 where (编号=:no) and (年=:y) and (月=:m)\n    ",{replacements:{no:e,y:t,m:r},type:O.QueryTypes.SELECT})]).then(function(t){var r=[(0,i.default)({},t[0][0],t[1][0])];t?U.ResourceFound(n,r):U.ResourceNotFound(n,{num:e})}).catch(function(t){U.InternalServerError(n,t,{num:e})})}function u(e,t,r,n,a,u){var s="起始"+t,o="终止"+t,c="s"+n,i="t"+n;e[s]&&e[s].length>0&&(u.push(" ("+r+">=:"+c+") "),a[c]=e[s]),e[o]&&e[o].length>0&&(u.push(" ("+r+"<=:"+i+") "),a[i]=e[o])}function s(e,t,r,n,a,u){e[t]&&e[t].length>=1&&(u.push(r),a[n]=e[t])}var o=n(r(5)),c=n(r(6)),i=n(r(64)),p=n(r(40)),l=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,f(n,"Select * from 水费报表查询 ");case 4:a=e.sent,U.ResourceFound(r,a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),U.InternalServerError(r,e.t0,n);case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),f=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a,c,i,p;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r,a={},c=[],t["户名"]&&t["户名"].length>1&&(t["户名"]="%"+t["户名"]+"%"),u(t,"年月","年+月","date",a,c),u(t,"编号","编号","num",a,c),s(t,"户名"," (户名 like :name) ","name",a,c),s(t,"费用标准"," (区号 = :chargestandard) ","chargestandard",a,c),s(t,"抄表形式"," (抄表形式编号 = :inputkind) ","inputkind",a,c),s(t,"用水形式"," (用水形式编号 = :usekind) ","usekind",a,c),s(t,"收费形式"," (收费形式编号 = :chargekind) ","chargekind",a,c),u(t,"上月表底","上月表底","lastmonth",a,c),u(t,"本月表底","本月表底","currentmonth",a,c),u(t,"用水量","用水量","usewater",a,c),u(t,"计划水量","计划水量","planwater",a,c),u(t,"计划水费","计划水费","plancharge",a,c),u(t,"应收水费","应收水费","accountcharge",a,c),u(t,"超额水量","超额水量","overwater",a,c),u(t,"超额水费","超额水费","overcharge",a,c),u(t,"排污费","排污费","pollute",a,c),u(t,"防火费","防火费","fire",a,c),u(t,"手续费","手续费","commission",a,c),u(t,"其它","其它","others",a,c),u(t,"申请水量","申请水量","applywater",a,c),u(t,"年用水量","年用水量","yearwater",a,c),u(t,"剩余水量","剩余水量","remainwater",a,c),u(t,"减免水费","减免水费","minuscharge",a,c),u(t,"减其它","减其它","minusothers",a,c),u(t,"实收水费","实收水费","truecharge",a,c),function(e,t,r,n){e[t]&&n.push(r)}(t,"欠费标志"," (欠费标志='2') ",c),i=c.join(" and "),n+=i.length>2?" where "+i:"",e.next=34,O.query(n,{replacements:a,type:O.QueryTypes.SELECT});case 34:return p=e.sent,e.abrupt("return",p);case 36:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),d=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a,u,s,c;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params,a=n.year,u=n.month,e.prev=1,s="\n        select 编号 from 水费基本表 where (年=:y) and (月=:m) \n        ",e.next=5,O.query(s,{replacements:{y:a,m:u},type:O.QueryTypes.SELECT});case 5:c=e.sent,U.ResourceFound(r,c),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),U.InternalServerError(r,e.t0,{year:a,month:u});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),y=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h();case 3:n=e.sent,U.ResourceFound(r,n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),U.InternalServerError(r,e.t0,{});case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(t,r){return e.apply(this,arguments)}}(),h=function(){var e=(0,c.default)(o.default.mark(function e(){var t,r,n,a,u,s,c,i,p;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={},r="\n    SELECT  区号,单位类别,单价 from 水费字典费用标准 Order By 区号 \n    ",e.next=4,O.query(r,{replacements:{},type:O.QueryTypes.SELECT});case 4:return n=e.sent,t.charges=n,a="\n    SELECT  * from 水费字典抄表形式 Order By 抄表形式编号 \n    ",e.next=9,O.query(a,{replacements:{},type:O.QueryTypes.SELECT});case 9:return u=e.sent,t.inputkinds=u,s="\n    SELECT  * from 水费字典用水形式 Order By 用水形式编号 \n    ",e.next=14,O.query(s,{replacements:{},type:O.QueryTypes.SELECT});case 14:return c=e.sent,t.usekinds=c,i="\n    SELECT  * from 水费字典收费形式 Order By 收费形式编号 \n    ",e.next=19,O.query(i,{replacements:{},type:O.QueryTypes.SELECT});case 19:return p=e.sent,t.chargekinds=p,t.dd=D(new Date,"yyyymm"),e.abrupt("return",t);case 23:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),m=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a,u,s,c;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params,a=n.year,u=n.month,e.prev=1,s="\n        delete from  水费基本表  where 实收水费=0 and (年=:y) and (月=:m) \n        ",e.next=5,O.query(s,{replacements:{y:a,m:u},type:O.QueryTypes.DELETE});case 5:c=e.sent,U.ResourceFound(r,c),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),U.InternalServerError(r,e.t0,{year:a,month:u});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),v=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,x(n);case 4:a=e.sent,U.ResourceFound(r,a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),U.InternalServerError(r,e.t0,n);case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),x=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n,a,u,s,c,i,p,l,f=t.year,d=t.month,y=t.commission,h=t.others,m=t.user;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,n=void 0,"01"===d?(r=(parseInt(f)-1).toString(),n="12"):(r=f,n=(n=parseInt(d)-1)<10?"0"+n.toString():n.toString()),a="\n    delete from 水费基本表  where (年=:y) and (月=:m) \n    ",e.next=5,O.query(a,{replacements:{y:f,m:d},type:O.QueryTypes.DELETE});case 5:return u="\n        Insert Into 水费基本表 (年,月,编号,户名,上月表底,本月表底,用水量,计划水量,计划水费,超额水量,超额水费,防火费,手续费,实收水费,排污费,其它,欠费标志,大写,操作员,操作时间,申请水量,年用水量,剩余水量) \n            select :year, :month,编号,户名,本月表底,本月表底,0,0,0,0,0,0,手续费,0,0,:others,'1','','','',申请水量,0,0 from 水费基本表      \n            where (年=:y) and (月=:m)\n        ",e.next=8,O.query(u,{replacements:{y:r,m:n,year:f,month:d,others:h},type:O.QueryTypes.INSERT});case 8:return s="\n    Insert Into 水费基本表 (年,月,编号,户名,上月表底,本月表底,用水量,计划水量,计划水费,超额水量,超额水费,防火费,手续费,实收水费,排污费,其它,大写,操作员,操作时间,申请水量,年用水量,剩余水量,欠费标志)\n        select :y, :m, 编号,户名,0,0,0,0,0,0,0,0, :commission, 0,0,0,'','','',申请水量,0,0, '1' from 水费单位信息\n        Where 编号 not in ( Select 编号 from 水费基本表 where (年=:y) and (月=:m))  and 节门状态='开'\n        ",e.next=11,O.query(s,{replacements:{y:f,m:d,commission:y},type:O.QueryTypes.INSERT});case 11:return c="\n    delete from  水费基本表\n        Where 编号 in ( Select 编号 from 水费单位信息 where 节门状态='闭') and 年=:y and 月=:m    \n    ",e.next=14,O.query(c,{replacements:{y:f,m:d},type:O.QueryTypes.DELETE});case 14:return i="\n    update 水费基本表 set 防火费=(SELECT B.防火费 FROM 水费字典防火标准 B INNER JOIN 水费单位信息 A ON B.防火标准编号 = A.防火标准编号 Where A.编号=水费基本表.编号)\n        where (年=:y) and (月=:m)\n    ",e.next=17,O.query(i,{replacements:{y:f,m:d},type:O.QueryTypes.UPDATE});case 17:return p="\n    update 水费基本表 set 操作员=:user,操作时间=:dd\n        where (年=:y) and (月=:m)\n    ",e.next=20,O.query(p,{replacements:{y:f,m:d,user:m,dd:D(new Date,"yyyy-mm-dd")},type:O.QueryTypes.UPDATE});case 20:return l="\n    update 水费基本表 set 实收水费=计划水费+超额水费+防火费+手续费+排污费+其它\n        where (年=:y) and (月=:m)\n    ",e.next=23,O.query(l,{replacements:{y:f,m:d},type:O.QueryTypes.UPDATE});case 23:return e.abrupt("return",{desc:"月水费自动创建完毕!"});case 24:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a,u,s,c;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params,a=n.year,u=n.month,s=n.type,e.prev=1,e.next=4,E(a,u,s);case 4:c=e.sent,U.ResourceFound(r,[c]),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),U.InternalServerError(r,e.t0,{year:a,month:u,type:s});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),E=function(){var e=(0,c.default)(o.default.mark(function e(t,r,n){var a,u,s,c;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="\n    select sum(用水量) as 水量,count(编号) as 户数,sum(应收水费) as 水费 from 水费修改计算 \n        where (年=:y) and (月=:m) and 编号<'2000' \n    ",e.next=3,O.query(a,{replacements:{y:t,m:r},type:O.QueryTypes.SELECT});case 3:return u=e.sent,s="\n    select sum(用水量) as 水量,count(编号) as 户数,sum(应收水费) as 水费 from 水费修改计算 \n        where (年=:y) and (月=:m) and 编号>='2000' \n    ",e.next=7,O.query(s,{replacements:{y:t,m:r},type:O.QueryTypes.SELECT});case 7:if(c=e.sent,1!==u.length||1!==c.length){e.next=14;break}return u=u[0],c=c[0],e.abrupt("return",{"临时户":u.户数,"临时户水量":u.水量?u.水量:0,"临时户水费":u.水费?u.水费:0,"正式户":c.户数,"正式户水量":c.水量?c.水量:0,"正式户水费":c.水费?c.水费:0,"总水量":c.水量&&u.水量?parseInt(u.水量)+parseInt(c.水量):0});case 14:return e.abrupt("return",{});case 15:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}(),b=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a,u,s,c;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params,a=n.year,u=n.month,s=n.type,e.prev=1,e.next=4,S(a,u,s);case 4:c=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(c,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),U.InternalServerError(r,e.t0,{year:a,month:u,type:s});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),S=function(){var e=(0,c.default)(o.default.mark(function e(t,r,n){var a,u,s,c,p,l,f,d;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="\n    Select * from 水费报表查询  where (年=:y) and (月=:m) Order by 编号\n    ",e.next=3,O.query(a,{replacements:{y:t,m:r},type:O.QueryTypes.SELECT});case 3:if(!((u=e.sent).length>0)){e.next=10;break}return s="\n        Select  count(*) as 户, sum(上月表底) as 上月表底, sum(本月表底) as 本月表底,\n        sum(实际用水量) as 实际用水量, sum(实际计划水费) as 实际计划水费, \n        sum(超额水量) as 超额水量, sum(超额水费) as 超额水费,   \n        sum(排污费) as 排污费, sum(防火费) as 防火费, \n        sum(手续费) as 手续费, sum(其它) as 其它,\n        sum(减水费) as 减水费, sum(实收水费) as 实收水费\n            from 水费报表查询\n            where (年=:y) and (月=:m)\n        ",e.next=8,O.query(s,{replacements:{y:t,m:r},type:O.QueryTypes.SELECT});case 8:c=e.sent,u.push((0,i.default)({"编号":"合计","户名":c[0].户+"户","装表地点":"","单价":"","超额水价":"","申请水量":"","使用期限":"","剩余水量":""},c[0]));case 10:return p=_.readFileSync(N.join("./","assets","excel","水费浏览.xlsx")),l=new Q(p),f="Sheet1",d={year:t,month:r,date:D(new Date,"yyyy-mm-dd"),fees:u},l.substitute(f,d),e.abrupt("return",l.generate({type:"base64"}));case 16:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}(),T=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,g(n);case 4:a=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(a,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),U.InternalServerError(r,e.t0,{});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),g=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n,a,u,s,c,p;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(t,"Select * from 水费报表查询 ");case 2:if(!((r=e.sent).length>0)){e.next=9;break}return n="\n        Select  count(*) as 户, sum(上月表底) as 上月表底, sum(本月表底) as 本月表底,\n        sum(实际用水量) as 实际用水量, sum(实际计划水费) as 实际计划水费, \n        sum(超额水量) as 超额水量, sum(超额水费) as 超额水费,   \n        sum(排污费) as 排污费, sum(防火费) as 防火费, \n        sum(手续费) as 手续费, sum(其它) as 其它,\n        sum(减水费) as 减水费, sum(实收水费) as 实收水费\n            from 水费报表查询\n        ",e.next=7,f(t,n);case 7:a=e.sent,r.push((0,i.default)({"编号":"","户名":"","装表地点":"","单价":"","年":"合计","月":a[0].户+"户","超额水价":"","申请水量":"","使用期限":"","剩余水量":""},a[0]));case 9:return u=_.readFileSync(N.join("./","assets","excel","水费查询.xlsx")),s=new Q(u),c="Sheet2",p={date:D(new Date,"yyyy-mm-dd"),fees:r},s.substitute(c,p),e.abrupt("return",s.generate({type:"base64"}));case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=(0,c.default)(o.default.mark(function e(t,r,n){var u,s,c,i,p,l,f;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u=t.params,s=u.num,c=u.year,i=u.month,p=u.type,l=void 0,l="prior"===n?"\n        Select 编号 from 水费用水量查询 where (编号<:no) and (年=:y) and (月=:m)\n        ":"\n        Select 编号 from 水费用水量查询 where (编号>:no) and (年=:y) and (月=:m)\n        ","1"===p?l+="and (抄表形式编号='1')":"2"===p&&(l+=" and (抄表形式编号='2')"),l+="prior"===n?" Order by 编号 desc":" Order by 编号",e.next=7,O.query(l,{replacements:{no:s,y:c,m:i},type:O.QueryTypes.SELECT});case 7:(f=e.sent).length>0?a(f[0].编号,c,i,r):U.ResourceNotFound(r,{},"没有发现记录");case 9:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}(),F=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,C(n);case 4:a=e.sent,U.ResourceFound(r,[a]),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),U.InternalServerError(r,e.t0,{num:n.编号});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),C=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n,a,u,s,c,i,p,l,f,d,y,h,m,v,x,w,E,b,S,T,g,k,F,C,q,I,L,A,R,Q,_,N,D,U,M,j,P,B,H,G,W,J,z,K;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.编号,n=t.年,a=t.月,u=t.本月表底,s=t.上月表底,c=t.手续费,i=t.其它,p=t.减免水量,l=t.减免单价,t.减排污费,f=t.减其它,d=void 0,y=void 0,h=void 0,m=void 0,v=void 0,x=void 0,w=void 0,E=0,b=0,S=0,T=0,g=parseFloat(p),k=parseFloat(l),F=parseFloat(f),C="\n    SELECT 编号,用水量,手续费,其它,原申请水量,用水日期,使用期限,定额,单价,防火费,超计划,排污费单价,排污费超额,扣水单位编号 \n        FROM 水费修改计算 where (编号=:no) and (年=:y) and (月=:m)\n    ",e.next=12,O.query(C,{replacements:{no:r,y:n,m:a},type:O.QueryTypes.SELECT});case 12:if(q=e.sent,!((I=Number(u-s))<0)){e.next=16;break}throw new Error("出现错误,请检查录入数据的准确性! 错误原因: 本月表底 < 上月表底");case 16:if(L=q[0],A=parseFloat(L.单价),y=parseFloat(L.超计划),R=parseFloat(L.排污费单价),Q=parseFloat(L.排污费超额),_=parseFloat(L.防火费),N=parseFloat(c),D=parseFloat(i),U=parseFloat(L.定额),M=parseFloat(L.原申请水量),j=L.使用期限,P=L.用水日期,!(M>0)){e.next=45;break}if(B=void 0,!(P<"20030101")){e.next=37;break}return H="Select sum(用水量) as sss from 水费用水量查询 where (年+月>='200301') and  (扣水单位编号=:no)",e.next=34,O.query(H,{replacements:{no:L.扣水单位编号},type:O.QueryTypes.SELECT});case 34:B=e.sent,e.next=41;break;case 37:return G="Select sum(用水量) as sss from 水费用水量查询 where (年+月>=:dd) and  (扣水单位编号=:no)",e.next=40,O.query(G,{replacements:{dd:P,no:L.扣水单位编号},type:O.QueryTypes.SELECT});case 40:B=e.sent;case 41:W=parseInt(B[0].sss),b=W-parseInt(L.用水量)+I,(E=M-b)<0?-E>=I?(S=I,T=0):(S=-E,T=I+E):(S=0,T=I);case 45:if(0!==M){e.next=55;break}return J="Select sum(用水量) as sss from 水费用水量查询 where (扣水单位编号=:no) and (年=:y) and (月=:m)",e.next=49,O.query(J,{replacements:{no:L.扣水单位编号,y:n,m:a},type:O.QueryTypes.SELECT});case 49:z=e.sent,K=parseInt(z[0].sss),M=30*U,b=K-parseInt(L.用水量)+I,E=30*U-b,n+a>j.slice(0,6)?(S=I,T=0):E<0?-E>=I?(S=I,T=0):(S=-E,T=I+E):(S=0,T=I);case 55:return d=I*A,y=S*(y-A)+S*(Q-R),h=I*R,m=d+y+_+N+h+D,v=g*k,x=g*R,w=m-v-x-F,q={"用水量":I,"计划水量":T,"计划水费":d,"超额水量":S,"超额水费":y,"防火费":_,"手续费":N,"排污费":parseFloat(h).toFixed(2),"应收水费":parseFloat(m).toFixed(2),"年用水量":b,"剩余水量":E,"申请水量":0===M?30*U:M,"减免水费":v,"减排污费":x,"实收水费":parseFloat(w).toFixed(2)},e.abrupt("return",q);case 64:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,I(n);case 4:"1"===e.sent?U.ResourceUpdated(r,"编号"+n.编号+"收费信息更新完成！"):U.ResourceCreated(r,"编号"+n.编号+"收费信息添加完成！"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),U.InternalServerError(r,e.t0,{num:n.编号});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),I=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n,a,u,s,c,i,p,l,f,d,y,h,m,v,x,w,E,b,S,T,g,k,F,C,q,I,L,A,Q,_,N,U;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.编号,n=t.年,a=t.月,u=t.户名,s=t.上月表底,c=t.本月表底,i=t.用水量,p=t.计划水量,l=t.计划水费,f=t.超额水量,d=t.超额水费,y=t.防火费,h=t.手续费,m=t.实收水费,v=t.排污费,x=t.其它,w=t.欠费标志,E=t.操作员,b=t.申请水量,S=t.年用水量,T=t.剩余水量,g=t.减免水量,k=t.减免单价,F=t.减免水费,C=t.减其它,q=t.减排污费,I=t.应收水费,L="\n    select 编号 from 水费基本表 where (编号=:no) and (年=:y) and (月=:m)           \n    ",A={a1:n,a2:a,a3:r,a4:u,a5:parseInt(s),a6:parseInt(c),a7:parseInt(i),a8:parseFloat(p).toFixed(2),a9:parseFloat(l).toFixed(2),a10:parseFloat(f).toFixed(2),a11:parseFloat(d).toFixed(2),a12:parseFloat(y).toFixed(2),a13:parseFloat(h).toFixed(2),a14:parseFloat(m).toFixed(2),a15:parseFloat(v).toFixed(2),a16:parseFloat(x).toFixed(2),a17:w?"2":"1",a18:R.toMoney(parseFloat(m).toFixed(2)),a19:function(e){var t=void 0;try{t=(100*e).toString().split("")}catch(e){throw new Error("钱数不是合法的浮点数,请检查!")}return"￥"+t.join(" ")}(parseFloat(m).toFixed(2)),a20:E,a21:D(new Date,"yyyy-mm-dd"),a22:parseFloat(b).toFixed(2),a23:parseFloat(S).toFixed(2),a24:parseFloat(T).toFixed(2),a25:parseFloat(g).toFixed(2),a26:parseFloat(k).toFixed(2),a27:parseFloat(F).toFixed(2),a28:parseFloat(C).toFixed(2),a29:parseFloat(I).toFixed(2),a30:parseFloat(q).toFixed(2)},e.next=5,O.query(L,{replacements:{no:r,y:n,m:a},type:O.QueryTypes.SELECT});case 5:if(Q=e.sent,_=void 0,!(Q.length>0)){e.next=14;break}return N="\n        update 水费基本表 set  户名=:a4,上月表底=:a5,本月表底=:a6,用水量=:a7,计划水量=:a8,计划水费=:a9,超额水量=:a10,超额水费=:a11,防火费=:a12,手续费=:a13,实收水费=:a14,排污费=:a15,其它=:a16, \n        欠费标志=:a17,大写=:a18,小写=:a19,操作员=:a20,操作时间=:a21,申请水量=:a22,年用水量=:a23,剩余水量=:a24,减免水量=:a25,减免单价=:a26,减免水费=:a27,减其它=:a28,应收水费=:a29,减排污费=:a30\n            where (年=:a1) and (月=:a2) and (编号 =:a3)\n        ",e.next=11,O.query(N,{replacements:A,type:O.QueryTypes.UPDATE});case 11:_="1",e.next=18;break;case 14:return U="\n        Insert Into 水费基本表 (年,月,编号,户名,上月表底,本月表底,用水量,计划水量,计划水费,超额水量,超额水费,防火费,手续费,实收水费,排污费,其它,欠费标志,大写,小写,操作员,操作时间,申请水量,年用水量,剩余水量,\n            减免水量,减免单价,减免水费,减其它,应收水费,减排污费 )\n            Values (:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8,:a9,:a10,:a11,:a12,:a13,:a14,:a15,:a16,:a17,:a18,:a19,:a20,:a21,:a22,:a23,:a24,:a25,:a26,:a27,:a28,:a29,:a30 )                \n        ",e.next=17,O.query(U,{replacements:A,type:O.QueryTypes.INSERT});case 17:_="1";case 18:return e.abrupt("return",_);case 19:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a,u,s,c;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params,a=n.num,u=n.year,s=n.month,e.prev=1,e.next=4,A(a,u,s);case 4:c=e.sent,U.ResourceFound(r,[c]),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),U.InternalServerError(r,e.t0,{num:a,year:u,month:s});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),A=function(){var e=(0,c.default)(o.default.mark(function e(t,r,n){var a,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="\n    delete from 水费基本表\n        where (年=:y) and (月=:m) and (编号=:no) \n    ",e.next=3,O.query(a,{replacements:{no:t,y:r,m:n},type:O.QueryTypes.SELECT});case 3:return u=e.sent,e.abrupt("return",u);case 5:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}(),R=(r(15),r(157)),Q=r(38),_=r(28),N=r(9),D=r(12),U=r(1),O=r(7);e.exports.queryWaterFee=a,e.exports.queryWaterFees=function(e,t,r,n){var a="\n    Select * from 水费修改计算  where (年=:y) and (月=:m) \n    ";"1"===r?a+="and (抄表形式编号='1')":"2"===r&&(a+=" and (抄表形式编号='2')"),O.query(a,{replacements:{y:e,m:t},type:O.QueryTypes.SELECT}).then(function(r){r.length>0?U.ResourceFound(n,r):U.ResourceNotFound(n,{y:e,m:t})}).catch(function(r){U.InternalServerError(n,r,{y:e,m:t})})},e.exports.searchWaterFees=l,e.exports.queryWaterFeesNum=d,e.exports.queryFeeParas=y,e.exports.eraseZeroWaterFees=m,e.exports.prepareWaterFees=v,e.exports.statisticsWaterFees=w,e.exports.waterFeeToExcel=b,e.exports.searchToExcel=T,e.exports.MoveWaterFeePosition=k,e.exports.calculateWaterFee=F,e.exports.saveWaterFee=q,e.exports.deleteWaterFee=L},function(e,t,r){e.exports={default:r(153),__esModule:!0}},function(e,t,r){r(154),e.exports=r(2).Object.assign},function(e,t,r){var n=r(10);n(n.S+n.F,"Object",{assign:r(155)})},function(e,t,r){"use strict";var n=r(24),a=r(156),u=r(65),s=r(35),o=r(44),c=Object.assign;e.exports=!c||r(22)(function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(e){t[e]=e}),7!=c({},e)[r]||Object.keys(c({},t)).join("")!=n})?function(e,t){for(var r=s(e),c=arguments.length,i=1,p=a.f,l=u.f;c>i;)for(var f,d=o(arguments[i++]),y=p?n(d).concat(p(d)):n(d),h=y.length,m=0;h>m;)l.call(d,f=y[m++])&&(r[f]=d[f]);return r}:c},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,r){var n=r(158),a={s:r(160),b:r(161)};e.exports=n(a.s,a.b)},function(e,t,r){var n=r(159),a=r(66);e.exports=function(e,t){return{encodeS:function(t,r){return r=a.extend({ww:!0,tenMin:!0},r),n.CL.call(e,t,r)},encodeB:function(e,r){return r=a.extend({ww:!0},r),n.CL.call(t,e,r)},decodeS:function(){return n.unCL.apply(e,arguments)},decodeB:function(){return n.unCL.apply(t,arguments)},toMoney:function(e,r){return r=a.extend({ww:!0},r),n.toMoney.call(t,e,r)}}}},function(e,t,r){function n(e,t){var r=a.getNumbResult(e);if(!r)return e;t=t||{};var n=this.ch,u=this.ch_u,s=this.ch_f||"",o=this.ch_d||"",c=n.charAt(0),i=r.int,p=r.decimal,l="",f="",d=r.minus?s:"";if(p){p=a.clearZero(p,"0","$");for(var y=0;y<p.length;y++)f+=n.charAt(+p.charAt(y));f=f?o+f:""}if(l=function e(r,s,o){r=a.getNumbResult(r).int;var i="",p=arguments.length>1?arguments[1]:t.tenMin,l=r.length;if(1==l)return n.charAt(+r);if(l<=4)for(var f=0,d=l;d--;){var y=+r.charAt(f);i+=p&&2==l&&0==f&&1==y?"":n.charAt(y),i+=y&&d?u.charAt(d):"",f++}else{for(var h=r.length/4>>0,m=r.length%4;0==m||!u.charAt(3+h);)m+=4,h--;i=e(r.substr(0,m),p)+u.charAt(3+h)+(~r.substr(m-1,2).indexOf("0")?c:"")+e(r.substr(m),p)}return i=a.clearZero(i,c)}(i),t.ww&&u.length>5){var h=u.charAt(4),m=u.charAt(5),v=l.lastIndexOf(m);~v&&(l=l.substring(0,v).replace(new RegExp(m,"g"),h+h)+l.substring(v))}return d+l+f}var a=r(66);e.exports={CL:n,unCL:function(e){for(var t=(e=e.toString()).split(this.ch_d),r=t[0].replace(this.ch_f,""),n=t[1],u=!!~t[0].indexOf(this.ch_f),s=this.ch_u.charAt(1),o=this.ch_u.charAt(4),c=this.ch_u.charAt(5),i=(r=r.replace(new RegExp(o+"{2}","g"),c)).split(""),p=0,l=0,f=[],d=[],y=[],h=0;h<i.length;h++){var m=i[h],v=0,x=0;if(~(v=this.ch.indexOf(m)))v>0&&y.unshift(v);else if(~(x=this.ch_u.indexOf(m))){var w=a.getDigit(x);p>x?(a.unshiftZero(y,w),a.centerArray(d,y)):x>=l?(0==h&&(y=[1]),a.centerArray(f,d,y),f.length>0&&a.unshiftZero(f,w),l=x):(0==y.length&&s==m&&(y=[1]),a.centerArray(d,y),a.unshiftZero(d,a.getDigit(x)),p=x)}}a.centerArray(f,d,y).reverse(),0==f.length&&f.push(0);var E=0;if(n){for(f.push("."),E="0.",h=0;h<n.length;h++)E+=this.ch.indexOf(n.charAt(h)),f.push(this.ch.indexOf(n.charAt(h)));E=+E}return u&&f.unshift("-"),parseFloat(f.join(""))},toMoney:function(e,t){var r=a.getNumbResult(e),u=this.ch.charAt(0);if(t="object"==typeof t?t:{},!r)return e;t=a.extend({ww:!0,complete:!1,outSymbol:!0},t);var s=r.num,o=r.decimal||"",c=t.outSymbol?this.m_t:"",i=o?"":this.m_z,p="";if(t.complete){for(var l=1;l<this.m_u.length;l++)p+=n.call(this,o.charAt(l-1)||"0")+this.m_u.charAt(l);i=n.call(this,s,t)+this.m_u.charAt(0)}else{if(o=a.clearZero(o,"0","$")){var f;for(l=0;l<this.m_u.length-1;l++)o.charAt(l)&&"0"!=o.charAt(l)&&(p+=n.call(this,o.charAt(l))+this.m_u.charAt(l+1),f=!1),"0"!==o.charAt(l)||f||(0==l&&"0"==s||(p+=u),f=!0)}"0"==s&&!i&&p||(i=n.call(this,s,t)+this.m_u.charAt(0)+i)}return c+i+p}}},function(e,t){e.exports={ch:"零一二三四五六七八九",ch_u:"个十百千万亿",ch_f:"负",ch_d:"点"}},function(e,t){e.exports={ch:"零壹贰叁肆伍陆柒捌玖",ch_u:"个拾佰仟万亿",ch_f:"负",ch_d:"点",m_t:"人民币",m_z:"整",m_u:"元角分"}},function(e,t,r){"use strict";var n=r(0),a=r(163),u=a.queryUnitsByPinYin,s=a.queryUnitByNum,o=a.queryUnitParas,c=(a.queryBankByName,a.saveUnit),i=a.createUnitNum,p=a.MoveUnitPosition,l=a.searchUnits,f=a.unitsToExcel,d=a.queryAllowanceByNum,y=a.saveAllowance,h=a.MoveAllowancePosition,m=a.saveCollection,v=a.MoveCollectionPosition,x=a.queryUnitChangeName,w=a.createChangeNameNum,E=a.saveUnitChange,b=a.searchUnitChange,S=a.changeToExcel,T=a.checkError,g=a.checkErrorToExcel,k=a.changeIdCheck,F=a.saveUnitChangeId,C=n.Router();C.get("/unitsabbr/:pinyin",u),C.get("/units/:num",s),C.get("/allowance/:num",d),C.get("/unitparas",o),C.get("/unitnum/:usekind",i),C.put("/unit",c),C.put("/collection",m),C.get("/prior/:num",function(e,t){p(e,t,"prior")}),C.get("/next/:num",function(e,t){p(e,t,"next")}),C.post("/unitsearch",l),C.post("/unitstoexcel",f),C.put("/allowance",y),C.get("/allowance/prior/:num",function(e,t){h(e,t,"prior")}),C.get("/allowance/next/:num",function(e,t){h(e,t,"next")}),C.get("/collection/prior/:num/:cb",function(e,t){v(e,t,"prior")}),C.get("/collection/next/:num/:cb",function(e,t){v(e,t,"next")}),C.get("/change/:num/:year/:month",x),C.get("/changecreate/:num/:usekind",w),C.put("/change",E),C.get("/change/:start/:end",b),C.get("/changetoexcel/:start/:end",S),C.post("/errorcheck",T),C.get("/error/excel/:date",g),C.get("/changeid/check/:num",k),C.post("/changeid",F),e.exports=C},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){e[t]&&e[t].length>0&&(e[t]="%"+e[t]+"%")}function u(e,t,r,n,a,u){e[t]&&e[t].length>=1&&(u.push(r),n&&(a[n]=e[t]))}var s=n(r(64)),o=n(r(5)),c=n(r(6)),i=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.pinyin,e.prev=1,a="\n        Select * from 水费单位基本信息查询 where 用户拼音 like :py \n        ",e.next=5,ee.query(a,{replacements:{py:"%"+n+"%"},type:ee.QueryTypes.SELECT});case 5:u=e.sent,X.ResourceFound(r,u),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),X.InternalServerError(r,e.t0,n);case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),p=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.num,e.prev=1,e.next=4,l(n);case 4:a=e.sent,X.ResourceFound(r,a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0,n);case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),l=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="\n    Select 编号, 户名, 开户行行名 , 开户行行号, 银行代码, 帐号 , \n    帐户地址 ,组织代码,协议书号,业务种类,托收联系人 ,\n    托收电话,联系人,电话,区号,用水日期,装表日期,使用期限,\n    水贴费状态,水贴费,管径,申请水量,定额,装表费,节门状态,\n    现场负责,装表地点,退续用手续,拆表日期,表损日期,换表日期,\n    单位性质编号,用水形式编号,收费形式编号,抄表形式编号,\n    防火标准编号,扣水单位编号,用户简称,用户拼音 \n        from 水费单位信息 where 编号=:num\n    ",e.next=3,ee.query(r,{replacements:{num:t},type:ee.QueryTypes.SELECT});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d();case 3:n=e.sent,X.ResourceFound(r,n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),X.InternalServerError(r,e.t0,{});case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(t,r){return e.apply(this,arguments)}}(),d=function(){var e=(0,c.default)(o.default.mark(function e(){var t,r,n,a,u,s,c,i,p,l,f,d,y,h,m,v,x;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={},r="\n    SELECT  * from 水费字典银行代码 order by 使用次数 desc \n    ",e.next=4,ee.query(r,{replacements:{},type:ee.QueryTypes.SELECT});case 4:return n=e.sent,t.banks=n,a="\n    SELECT  distinct 管径 from 水费单位信息 \n    ",e.next=9,ee.query(a,{replacements:{},type:ee.QueryTypes.SELECT});case 9:return u=e.sent,t.pipes=u,s="\n    SELECT 区号,单价 from 水费字典费用标准\n    ",e.next=14,ee.query(s,{replacements:{},type:ee.QueryTypes.SELECT});case 14:return c=e.sent,t.chargestandard=c,i="\n    SELECT * from 水费字典单位性质 \n    ",e.next=19,ee.query(i,{replacements:{},type:ee.QueryTypes.SELECT});case 19:return p=e.sent,t.unitkinds=p,l="\n    SELECT * from 水费字典用水形式 \n    ",e.next=24,ee.query(l,{replacements:{},type:ee.QueryTypes.SELECT});case 24:return f=e.sent,t.usekinds=f,d="\n    SELECT * from 水费字典抄表形式 \n    ",e.next=29,ee.query(d,{replacements:{},type:ee.QueryTypes.SELECT});case 29:return y=e.sent,t.inputkinds=y,h="\n    SELECT * from 水费字典收费形式 \n    ",e.next=34,ee.query(h,{replacements:{},type:ee.QueryTypes.SELECT});case 34:return m=e.sent,t.chargekinds=m,v="\n    SELECT 防火标准编号,管径,防火费 from 水费字典防火标准\n    ",e.next=39,ee.query(v,{replacements:{},type:ee.QueryTypes.SELECT});case 39:return x=e.sent,t.firestandard=x,e.abrupt("return",t);case 42:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),y=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.name,e.prev=1,a="\n        Select 开户行行号,银行代码,帐号位数,帐号相同位数,帐号相同代码,\n        是否验证,业务种类 from 水费字典银行代码 \n            where 开户行行名=:name\n        ",e.next=5,ee.query(a,{replacements:{name:n},type:ee.QueryTypes.SELECT});case 5:u=e.sent,X.ResourceFound(r,u),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),X.InternalServerError(r,e.t0,n);case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),h=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,m(n);case 4:"1"===e.sent?X.ResourceUpdated(r,"编号"+n.编号+"用水企业信息更新完成！"):X.ResourceCreated(r,"编号"+n.编号+"用水企业信息添加完成！"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0,{num:n.编号});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),m=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n,a,u,s,c,i,p,l,f,d,y,h,m,v,x,w,E,b,S,T,g,k,F,C,q,I,L,A,R,Q,_,N,D,U,O,M,j,P,B,H,G,W,J,z,K;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.编号,n=t.户名,a=t.开户行行名,u=t.帐号,s=t.联系人,c=t.电话,i=t.用水日期,p=t.装表日期,l=t.使用期限,f=t.水贴费状态,d=t.水贴费,y=t.管径,h=t.定额,m=t.申请水量,v=t.装表费,x=t.节门状态,w=t.现场负责,E=t.装表地点,b=t.退续用手续,S=t.拆表日期,T=t.表损日期,g=t.换表日期,k=t.区号,F=t.单位性质编号,C=t.用水形式编号,q=t.收费形式编号,I=t.抄表形式编号,L=t.防火标准编号,A=t.扣水单位编号,R=t.用户简称,Q=t.用户拼音,_=t.组织代码,N=t.帐户地址,D=t.开户行行号,U=t.托收联系人,O=t.托收电话,M=t.协议书号,j=t.银行代码,P=t.业务种类,B="\n    select 编号 from 水费单位信息 where 编号 =:num          \n    ",H={a1:r||"",a2:n||"",a3:a||"",a4:u||"",a5:s||"",a6:c||"",a7:i||"",a8:p||"",a9:l||"",a18:E||"",a16:x||"",a12:y?parseInt(y):"0",a13:h?parseFloat(h).toFixed(2):"0",a14:m?parseFloat(m).toFixed(2):"0",a10:f||"",a11:parseFloat(d).toFixed(2),a15:parseFloat(v).toFixed(2),a17:w||"",a19:b||"",a20:S||"",a21:T||"",a22:g||"",a23:k,a24:F&&F.length>0?F:k,a25:C,a26:q,a27:I,a29:A||"",a30:R||"",a31:Q||"",a32:_||"",a33:N||"",a34:D||"",a35:U||"",a36:O||"",a37:M||"",a38:j||"",a39:P||"",a28:L||""},e.next=5,ee.query(B,{replacements:{num:r},type:ee.QueryTypes.SELECT});case 5:if(G=e.sent,W=void 0,!(G.length>0)){e.next=14;break}return J="\n        update 水费单位信息 set  户名=:a2,开户行行名=:a3,帐号=:a4,联系人=:a5,电话=:a6,用水日期=:a7,装表日期=:a8,使用期限=:a9,水贴费状态=:a10,水贴费=:a11,管径=:a12,定额=:a13,申请水量=:a14, \n        装表费=:a15,节门状态=:a16,现场负责=:a17,装表地点=:a18,退续用手续=:a19,拆表日期=:a20,表损日期=:a21,换表日期=:a22,\n        区号=:a23,单位性质编号=:a24,用水形式编号=:a25,收费形式编号=:a26,抄表形式编号=:a27,防火标准编号=:a28,扣水单位编号=:a29,\n        用户简称=:a30,用户拼音=:a31,组织代码=:a32,帐户地址=:a33,开户行行号=:a34,托收联系人=:a35,托收电话=:a36,协议书号=:a37,银行代码=:a38,业务种类=:a39    \n            where 编号 =:a1 \n        ",e.next=11,ee.query(J,{replacements:H,type:ee.QueryTypes.UPDATE});case 11:W="1",e.next=18;break;case 14:return z="\n        Insert Into 水费单位信息 (编号,户名,开户行行名,帐号,联系人,电话,用水日期,装表日期,使用期限,水贴费状态,水贴费,管径,定额,申请水量,\n            装表费,节门状态,现场负责,装表地点,退续用手续,拆表日期,表损日期,换表日期,区号,单位性质编号,用水形式编号,收费形式编号,抄表形式编号,防火标准编号,扣水单位编号,\n            用户简称,用户拼音,组织代码,帐户地址,开户行行号,托收联系人,托收电话,协议书号,银行代码,业务种类 )\n            Values (:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8,:a9,     :a10,  :a11, :a12,:a13,    :a14,\n                :a15,    :a16,    :a17,    :a18,      :a19,     :a20,   :a21,   :a22,  :a23,       :a24,       :a25,          :a26,        :a27,        :a28,        :a29,    \n                :a30,       :a31,   :a32,    :a33,    :a34,        :a35,     :a36,   :a37,     :a38,  :a39 )      \n        ",e.next=17,ee.query(z,{replacements:H,type:ee.QueryTypes.INSERT});case 17:W="1";case 18:if(!(D&&D.length>0)){e.next=27;break}return K="\n        Select 开户行行号 from 水费字典银行代码 where 开户行行号=:code\n        ",e.next=22,ee.query(K,{replacements:{code:D},type:ee.QueryTypes.SELECT});case 22:if(0!==e.sent.length){e.next=27;break}return"\n            insert into 水费字典银行代码 \n                (开户行行号,开户行行名,银行代码,使用次数,业务种类,\n                帐号位数,帐号相同位数,是否验证,帐号相同代码) \n                values (:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8,:a9)\n            ",e.next=27,ee.query(K,{replacements:{"开户行行号":D,"开户行行名":a,"银行代码":j,"使用次数":1,"业务种类":P,"帐号位数":u.length,"帐号相同位数":0,"是否验证":"Y","帐号相同代码":u},type:ee.QueryTypes.INSERT});case 27:return e.abrupt("return",W);case 28:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.usekind,e.prev=1,e.next=4,x(n);case 4:a=e.sent,X.ResourceFound(r,a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0,n);case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),x=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n,a,u,s;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return{},r="\n        Select max(编号) as num from 水费单位信息 where            \n        ",r+="0"===t?" 编号<'2000'":" 编号>'2000'",e.next=5,ee.query(r,{replacements:{},type:ee.QueryTypes.SELECT});case 5:return n=e.sent,a=parseInt(n[0].num)+1,3===(u=a.toString()).length&&(u="0"+u),s=void 0,s=u>"2000"?"2":"0",e.abrupt("return",{"编号":u,"用水形式编号":s});case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=(0,c.default)(o.default.mark(function e(t,r,n){var a,u,s,c;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.params.num,u=void 0,e.prev=2,u="prior"===n?"\n            Select 编号 from 水费单位信息 where (编号<:no) \n            ":"\n            Select 编号 from 水费单位信息 where (编号>:no) \n            ",u+="prior"===n?" Order by 编号 desc":" Order by 编号",e.next=7,ee.query(u,{replacements:{no:a},type:ee.QueryTypes.SELECT});case 7:if(!((s=e.sent).length>0)){e.next=15;break}return e.next=11,l(s[0].编号);case 11:c=e.sent,X.ResourceFound(r,c),e.next=16;break;case 15:X.ResourceNotFound(r,{},"没有发现记录");case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(2),X.InternalServerError(r,e.t0,a);case 21:case"end":return e.stop()}},e,this,[[2,18]])}));return function(t,r,n){return e.apply(this,arguments)}}(),E=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,b(n);case 4:a=e.sent,X.ResourceFound(r,a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0,n);case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),b=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n,s,c,i;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="\n    SELECT A.编号,A.户名,A.装表地点,A.开户行行名,A.帐号,A.联系人,A.电话,A.用水日期,A.使用期限,A.装表日期,A.水贴费状态,A.水贴费,A.管径,D.单位性质,\n        B.用水形式, E.抄表形式, A.区号, F.单价, C.收费形式, A.申请水量, A.定额, A.节门状态,A.扣水单位编号,A.装表费\n        FROM 水费字典用水形式 B INNER JOIN 水费单位信息 A ON B.用水形式编号 = A.用水形式编号 INNER JOIN\n        水费字典收费形式 C ON A.收费形式编号 = C.收费形式编号 INNER JOIN 水费字典单位性质 D ON A.单位性质编号 = D.单位性质编号 INNER JOIN 水费字典抄表形式 E ON A.抄表形式编号 = E.抄表形式编号 INNER JOIN\n        水费字典费用标准 F ON A.区号 = F.区号  \n    ",n={},s=[],a(t,"编号"),a(t,"户名"),u(t,"编号"," (A.编号 like :num) ","num",n,s),u(t,"户名"," (A.编号 like :name) ","name",n,s),u(t,"用水形式编号"," (A.用水形式编号= :usekind) ","usekind",n,s),u(t,"抄表形式编号"," (A.抄表形式编号= :inputkind) ","inputkind",n,s),u(t,"单位性质编号"," (A.单位性质编号= :unitkind) ","unitkind",n,s),u(t,"区号"," (A.区号= :chargestandard) ","chargestandard",n,s),u(t,"开户行行名"," (A.开户行行名= :bankname) ","bankname",n,s),u(t,"收费形式编号"," (A.收费形式编号= :chargekind) ","chargekind",n,s),u(t,"用水日期"," (substring(A.用水日期,1,6)= :usedd) ","usedd",n,s),u(t,"装表日期"," (substring(A.装表日期,1,6)= :setupdd) ","setupdd",n,s),u(t,"续用水"," (substring(A.装表日期,1,6)<>substring(A.用水日期,1,6)) ",null,n,s),u(t,"签合同单位"," (A.编号=A.扣水单位编号) ",null,n,s),c=s.join(" and "),r+=c.length>2?" where "+c:"",e.next=21,ee.query(r,{replacements:n,type:ee.QueryTypes.SELECT});case 21:return i=e.sent,e.abrupt("return",i);case 23:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,T(n);case 4:a=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(a,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),X.InternalServerError(r,e.t0,{});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),T=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n,a,u,s;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b(t);case 2:return r=e.sent,n=Y.readFileSync($.join("./","assets","excel","单位.xlsx")),a=new Z(n),u="Sheet1",s={units:r},a.substitute(u,s),e.abrupt("return",a.generate({type:"base64"}));case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.num,e.prev=1,e.next=4,k(n);case 4:a=e.sent,X.ConvertNullToZeroString(a),X.ResourceFound(r,a),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),X.InternalServerError(r,e.t0,n);case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),k=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n,a,u,c;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="\n    Select 编号,户名,装表地点 from 水费单位信息 where 编号=:num\n    ",n={},e.next=4,ee.query(r,{replacements:{num:t},type:ee.QueryTypes.SELECT});case 4:if(!((a=e.sent)&&a.length>0)){e.next=11;break}return u="\n        Select * from 水费贴费表 where 编号=:num\n        ",e.next=9,ee.query(u,{replacements:{num:t},type:ee.QueryTypes.SELECT});case 9:c=e.sent,n=c&&c.length>0?(0,s.default)({},a[0],c[0]):a[0];case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,C(n);case 4:"1"===e.sent?X.ResourceUpdated(r,"编号"+n.编号+"用水企业信息更新完成！"):X.ResourceCreated(r,"编号"+n.编号+"用水企业信息添加完成！"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0,{num:n.编号});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),C=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n,a,u,s,c,i,p,l,f,d,y,h,m,v,x,w,E,b,S,T,g,k,F,C,q,I,L,A,R,Q,_,N,D,U;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.编号,n=t.交费日期,a=t.水贴费,u=t.贴费状态,s=t.增容日期1,c=t.增容费1,i=t.增容日期2,p=t.增容费2,l=t.增容日期3,f=t.增容费3,d=t.增容日期4,y=t.增容费4,h=t.增容日期5,m=t.增容费5,v=t.合计,x=t.申请容量,w=t.增加容量1,E=t.增加容量2,b=t.增加容量3,S=t.增加容量4,T=t.增加容量5,g=t.容量合计,k=t.贴费备注,F=t.备注1,C=t.备注2,q=t.备注3,I=t.备注4,L=t.备注5,A="\n    Select * from 水费贴费表 where 编号=:num          \n    ",R={a1:r||"",a2:n||"",a3:parseFloat(a).toFixed(2),a4:u||"",a5:s||"",a6:parseFloat(c).toFixed(2),a7:i||"",a8:parseFloat(p).toFixed(2),a9:l||"",a10:parseFloat(f).toFixed(2),a11:d||"",a12:parseFloat(y).toFixed(2),a13:h||"",a14:parseFloat(m).toFixed(2),a15:parseFloat(v).toFixed(2),a16:parseFloat(x).toFixed(2),a17:parseFloat(w).toFixed(2),a18:parseFloat(E).toFixed(2),a19:parseFloat(b).toFixed(2),a20:parseFloat(S).toFixed(2),a21:parseFloat(T).toFixed(2),a22:parseFloat(g).toFixed(2),a23:k||"",a24:F||"",a25:C||"",a26:q||"",a27:I||"",a28:L||""},e.next=5,ee.query(A,{replacements:{num:r},type:ee.QueryTypes.SELECT});case 5:if(Q=e.sent,_=void 0,!(Q.length>0)){e.next=14;break}return N="\n        Update 水费贴费表 set 交费日期=:a2,水贴费=:a3,贴费状态=:a4,  \n        增容日期1=:a5,增容费1=:a6,增容日期2=:a7,增容费2=:a8,增容日期3=:a9,增容费3=:a10,\n        增容日期4=:a11,增容费4=:a12,增容日期5=:a13,增容费5=:a14,合计=:a15,\n        申请容量=:a16,增加容量1=:a17,增加容量2=:a18,增加容量3=:a19,增加容量4=:a20,增加容量5=:a21,容量合计=:a22,    \n        贴费备注=:a23,备注1=:a24,备注2=:a25,备注3=:a26,备注4=:a27,备注5=:a28\n        where 编号 =:a1 \n        ",e.next=11,ee.query(N,{replacements:R,type:ee.QueryTypes.UPDATE});case 11:_="1",e.next=18;break;case 14:return D="\n        Insert into 水费贴费表 (编号,交费日期,水贴费,贴费状态,增容日期1,增容费1,增容日期2,增容费2,增容日期3,增容费3,增容日期4,增容费4,增容日期5,增容费5,合计, \n            申请容量,增加容量1,增加容量2,增加容量3,增加容量4,增加容量5,容量合计,\n            贴费备注,备注1,备注2,备注3,备注4,备注5 )\n            values (:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8,:a9,:a10,:a11,:a12,:a13,:a14,:a15,:a16,:a17,:a18,:a19,:a20,:a21,:a22,:a23,:a24,:a25,:a26,:a27,:a28)   \n        ",e.next=17,ee.query(D,{replacements:R,type:ee.QueryTypes.INSERT});case 17:_="1";case 18:return U="\n    Update 水费单位信息 set 拆表日期=:dd,水贴费=:allowance,水贴费状态=:status where 编号=:num\n    ",e.next=21,ee.query(U,{replacements:{dd:n,allowance:a,status:u,num:r},type:ee.QueryTypes.INSERT});case 21:return e.abrupt("return",_);case 22:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=(0,c.default)(o.default.mark(function e(t,r,n){var a,u,s,c;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.params.num,u=void 0,e.prev=2,u="prior"===n?"\n            Select top 1 编号 from 水费单位信息 where (编号<:no) \n            ":"\n            Select top 1 编号 from 水费单位信息 where (编号>:no) \n            ",u+="prior"===n?" Order by 编号 desc":" Order by 编号",e.next=7,ee.query(u,{replacements:{no:a},type:ee.QueryTypes.SELECT});case 7:if(!((s=e.sent).length>0)){e.next=16;break}return e.next=11,k(s[0].编号);case 11:c=e.sent,X.ConvertNullToZeroString(c),X.ResourceFound(r,c),e.next=17;break;case 16:X.ResourceNotFound(r,{},"没有发现记录");case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(2),X.InternalServerError(r,e.t0,a);case 22:case"end":return e.stop()}},e,this,[[2,19]])}));return function(t,r,n){return e.apply(this,arguments)}}(),I=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,L(n);case 4:"1"===e.sent?X.ResourceUpdated(r,"编号"+n.编号+"用水企业托收信息更新完成！"):X.ResourceCreated(r,"编号"+n.编号+"用水企业托收信息添加完成！"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0,{num:n.编号});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),L=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n,a,u,s,c,i,p,l,f,d,y,h,m,v,x,w,E,b,S,T,g,k,F,C;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.编号,n=t.户名,a=t.开户行行名,u=t.帐号,s=t.联系人,c=t.电话,i=t.单位性质编号,p=t.扣水单位编号,l=t.用户简称,f=t.用户拼音,d=t.组织代码,y=t.帐户地址,h=t.开户行行号,m=t.托收联系人,v=t.托收电话,x=t.协议书号,w=t.银行代码,E=t.业务种类,b="\n    select 编号 from 水费单位信息 where 编号 =:num          \n    ",S={a1:r||"",a2:n||"",a3:a||"",a4:u||"",a5:s||"",a6:c||"",a24:i&&i.length>0?i:"",a29:p||"",a30:l||"",a31:f||"",a32:d||"",a33:y||"",a34:h||"",a35:m||"",a36:v||"",a37:x||"",a38:w||"",a39:E||""},e.next=5,ee.query(b,{replacements:{num:r},type:ee.QueryTypes.SELECT});case 5:if(T=e.sent,g=void 0,!(T.length>0)){e.next=14;break}return k="\n        update 水费单位信息 set  户名=:a2,开户行行名=:a3,帐号=:a4,联系人=:a5,电话=:a6,\n        单位性质编号=:a24, \n        用户简称=:a30,用户拼音=:a31,组织代码=:a32,帐户地址=:a33,开户行行号=:a34,托收联系人=:a35,托收电话=:a36,协议书号=:a37,银行代码=:a38,业务种类=:a39   \n            where 扣水单位编号 =:a1 \n        ",e.next=11,ee.query(k,{replacements:S,type:ee.QueryTypes.UPDATE});case 11:g="1",e.next=18;break;case 14:return F="\n        Insert Into 水费单位信息 (编号,户名,开户行行名,帐号,联系人,电话,用水日期,装表日期,使用期限,水贴费状态,水贴费,管径,定额,申请水量,\n            装表费,节门状态,现场负责,装表地点,退续用手续,拆表日期,表损日期,换表日期,区号,单位性质编号,用水形式编号,收费形式编号,抄表形式编号,防火标准编号,扣水单位编号,\n            用户简称,用户拼音,组织代码,帐户地址,开户行行号,托收联系人,托收电话,协议书号,银行代码,业务种类 )\n            Values (:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8,:a9,     :a10,  :a11, :a12,:a13,    :a14,\n                :a15,    :a16,    :a17,    :a18,      :a19,     :a20,   :a21,   :a22,  :a23,       :a24,       :a25,          :a26,        :a27,        :a28,        :a29,    \n                :a30,       :a31,   :a32,    :a33,    :a34,        :a35,     :a36,   :a37,     :a38,  :a39 )      \n        ",e.next=17,ee.query(F,{replacements:S,type:ee.QueryTypes.INSERT});case 17:g="1";case 18:if(!(h&&h.length>0)){e.next=30;break}return C="\n        Select 开户行行号 from 水费字典银行代码 where 开户行行号=:code\n        ",e.next=22,ee.query(C,{replacements:{code:h},type:ee.QueryTypes.SELECT});case 22:if(0!==e.sent.length){e.next=27;break}return"\n            insert into 水费字典银行代码 \n                (开户行行号,开户行行名,银行代码,使用次数,业务种类,\n                帐号位数,帐号相同位数,是否验证,帐号相同代码) \n                values (:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8,:a9)\n            ",e.next=27,ee.query(C,{replacements:{"开户行行号":h,"开户行行名":a,"银行代码":w,"使用次数":1,"业务种类":E,"帐号位数":u.length,"帐号相同位数":0,"是否验证":"Y","帐号相同代码":u},type:ee.QueryTypes.INSERT});case 27:return"\n        update 水费字典银行代码 set 使用次数=使用次数+1 where 开户行行号=:code\n            ",e.next=30,ee.query(C,{replacements:{code:h},type:ee.QueryTypes.UPDATE});case 30:return e.abrupt("return",g);case 31:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=(0,c.default)(o.default.mark(function e(t,r,n){var a,u,s,c,i,p;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.params,u=a.num,s=a.cb,c=void 0,e.prev=2,c="prior"===n?"\n            Select top 1 编号 from 水费单位信息 where (编号<:no) and 扣水单位编号=编号\n            ":"\n            Select top 1 编号 from 水费单位信息 where (编号>:no)  and 扣水单位编号=编号\n            ","true"===s&&(c+=" and 收费形式编号='1' "),c+="prior"===n?" Order by 编号 desc":" Order by 编号",e.next=8,ee.query(c,{replacements:{no:u},type:ee.QueryTypes.SELECT});case 8:if(!((i=e.sent).length>0)){e.next=16;break}return e.next=12,l(i[0].编号);case 12:p=e.sent,X.ResourceFound(r,p),e.next=17;break;case 16:X.ResourceNotFound(r,{},"没有发现记录");case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(2),X.InternalServerError(r,e.t0,u);case 22:case"end":return e.stop()}},e,this,[[2,19]])}));return function(t,r,n){return e.apply(this,arguments)}}(),R=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a,u,s,c;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params,a=n.num,u=n.year,s=n.month,e.prev=1,e.next=4,Q(a,u,s);case 4:c=e.sent,X.ResourceFound(r,c),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0,a);case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),Q=function(){var e=(0,c.default)(o.default.mark(function e(t,r,n){var a,u,c,i,p;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="\n    Select 编号, 户名, 开户行行名 ,帐号 , 用水形式编号,\n    联系人,电话,用水日期,装表日期,使用期限,\n    装表地点, 管径,申请水量,定额,扣水单位编号,节门状态\n        from 水费单位信息 where 编号=:num\n    ",e.next=3,ee.query(a,{replacements:{num:t},type:ee.QueryTypes.SELECT});case 3:return u=e.sent,c="\n    Select 本月表底 from 水费基本表 where \n        编号=:num and 年=:year and 月=:month\n    ",e.next=7,ee.query(c,{replacements:{num:t,year:r,month:n},type:ee.QueryTypes.SELECT});case 7:if(0!==(i=e.sent).length){e.next=13;break}return c="\n        Select 本月表底 from 水费基本表 where \n            编号=:num and 年+月<:dd\n            order by 年,月 desc\n        ",e.next=12,ee.query(c,{replacements:{num:t,dd:r+n},type:ee.QueryTypes.SELECT});case 12:i=e.sent;case 13:return p={},u.length>0&&i.length>0&&(p=(0,s.default)({},u[0],i[0])),e.abrupt("return",p);case 16:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}(),_=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a,u,s;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params,a=n.num,u=n.usekind,e.prev=1,e.next=4,N(a,u);case 4:s=e.sent,X.ResourceFound(r,s),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0,a);case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),N=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={},a="\n    Select 过户编号 from 水费过户表 where 老户编号 =:num\n    ",e.next=4,ee.query(a,{replacements:{num:t},type:ee.QueryTypes.SELECT});case 4:if(!(e.sent.length>0)){e.next=9;break}n.desc="该单位已经过户，不能重复过户！",e.next=12;break;case 9:return e.next=11,x(r);case 11:n=e.sent;case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),D=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,U(n);case 4:a=e.sent,X.ResourceUpdated(r,a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0,{num:n.编号});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),U=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n,a,u,s,c,i,p,l,f,d,y,h,m,v,x,w,E,b,S,T,g,k,F,C,q,I,L,A,R,Q,_;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.过户日期,n=t.编号,a=t.编号n,u=t.过户理由,s=t.沿用原指标,c=t.备注,i=t.户名n,p=t.开户行行名n,l=t.帐号n,f=t.电话n,d=t.联系人n,y=t.用水日期n,h=t.装表日期n,m=t.使用期限n,v=t.管径n,x=t.定额n,w=t.申请水量n,E=t.节门状态n,b=t.装表地点n,S=t.扣水单位编号n,T=t.本月表底n,g=void 0,k="\n    Select 过户编号 from 水费过户表 where 过户日期 =:dd order by 过户编号 desc\n    ",e.next=5,ee.query(k,{replacements:{dd:r},type:ee.QueryTypes.SELECT});case 5:return F=e.sent,C=void 0,C=0===F.length?r+"01":(parseInt(F[0].过户编号)+1).toString(),q={a1:C,a2:r,a3:n,a4:a,a5:u||"",a6:"true"===s?"T":"F",a7:c},I="\n    Insert Into 水费过户表 (过户编号,过户日期,老户编号,新户编号,过户理由,沿用原指标,备注) \n    Values (:a1,:a2,:a3,:a4,:a5,:a6,:a7)\n    ",e.next=12,ee.query(I,{replacements:q,type:ee.QueryTypes.INSERT});case 12:return L="update 水费单位信息 set 节门状态='闭' where 编号 =:no",e.next=15,ee.query(L,{replacements:{no:n},type:ee.QueryTypes.UPDATE});case 15:return A="\n    Insert Into 水费单位信息 (编号,户名,开户行行名,帐号,联系人,电话,用水日期,装表日期,使用期限,水贴费状态,水贴费,管径,定额,申请水量,\n        装表费,节门状态,现场负责,装表地点,退续用手续,拆表日期,表损日期,换表日期,区号,单位性质编号,用水形式编号,收费形式编号,抄表形式编号,防火标准编号,扣水单位编号 )\n        Values (:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8,:a9,:a10,:a11,:a12,:a13,:a14,:a15,:a16,:a17,:a18,:a19,:a20,:a21,:a22,:a23,:a24,:a25,:a26,:a27,:a28,:a29 )\n    ",R={a1:a,a2:i,a3:p||"",a4:l||"",a5:d||"",a6:f||"",a7:y,a8:h,a9:m,a10:"",a11:0,a12:v,a13:x,a14:w,a15:0,a16:E,a17:"",a18:b,a19:"",a20:"",a21:"",a22:"",a23:"1",a24:"1",a25:"1",a26:"1",a27:"1",a28:"1",a29:S},e.next=19,ee.query(A,{replacements:R,type:ee.QueryTypes.INSERT});case 19:return Q="\n    Insert Into 水费基本表 (年,月,编号,户名,上月表底,本月表底,用水量,实收水费,欠费标志,大写,小写,操作员,操作时间,应收水费) \n    Values (:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8,:a9,:a10,:a11,:a12,:a13,:a14 )\n    ",_={a1:r.slice(0,4),a2:r.slice(4),a3:a,a4:i,a5:parseInt(T),a6:parseInt(T),a7:0,a8:0,a9:"1",a10:"零元",a11:"￥0 0 0",a12:"管理员",a13:r,a14:0},e.next=23,ee.query(Q,{replacements:_,type:ee.QueryTypes.INSERT});case 23:return g="过户保存成功！",e.abrupt("return",g);case 25:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a,u,s;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params,a=n.start,u=n.end,e.prev=1,e.next=4,M(a,u);case 4:s=e.sent,X.ResourceFound(r,s),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0,{start:a,end:u});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),M=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="\n    SELECT * from 水费过户查询\n        where 过户日期>=:start and 过户日期<=:end\n        Order by  老户编号 \n    ",e.next=3,ee.query(n,{replacements:{start:t,end:r},type:ee.QueryTypes.SELECT});case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),j=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a,u,s;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params,a=n.start,u=n.end,e.prev=1,e.next=4,P(a,u);case 4:s=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(s,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),X.InternalServerError(r,e.t0,{});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),P=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a,u,s,c;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M(t,r);case 2:return n=e.sent,a=Y.readFileSync($.join("./","assets","excel","过户.xlsx")),u=new Z(a),s="sheet1",c={change:n},u.substitute(s,c),e.abrupt("return",u.generate({type:"base64"}));case 9:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),B=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,H(n);case 4:a=e.sent,X.ResourceUpdated(r,a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0,n);case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),H=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n,a,u,s,c,i,p,l,f,d,y,h,m,v,x,w,E,b,S,T,g,k,F,C,q;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.date,n=r.slice(0,4),a=r.slice(4),u="",s="",c=t.date1,i="",p="",l=t.date2,c&&c.length>0&&(u=c.slice(0,4),s=c.slice(4)),l&&l.length>0&&(i=l.slice(0,4),p=l.slice(4)),f="\n    Delete from 水费误差分析 where 年=:year and 月=:month \n    ",e.next=14,ee.query(f,{replacements:{year:n,month:a},type:ee.QueryTypes.DELETE});case 14:return d="\n    Select 编号 from 水费基本表 where 年=:year and 月=:month order by 编号\n    ",e.next=17,ee.query(d,{replacements:{year:n,month:a},type:ee.QueryTypes.SELECT});case 17:y=e.sent,h=0;case 19:if(!(h<y.length)){e.next=48;break}if(m=y[h],!t.para1){e.next=33;break}return v="\n            Select 用水量 from 水费基本表 where ((年=:year and 月=:month) or ( 年=:year1 and 月=:month1)) and (编号=:no) \n            ",e.next=25,ee.query(v,{replacements:{year:n,month:a,year1:u,month1:s,no:m.编号},type:ee.QueryTypes.SELECT});case 25:if(x=e.sent,w=0,E=0,2===x.length&&(w=parseInt(x[0].用水量),E=parseInt(x[1].用水量)),!(E>w*(1+parseFloat(t.proportion1))&&0!=w)){e.next=33;break}return b="\n                Insert into  水费误差分析 values (:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8,:a9,:a10 ) \n                ",e.next=33,ee.query(b,{replacements:{a1:n,a2:a,a3:(h+1).toString(),a4:m.编号,a5:E,a6:u,a7:s,a8:"超过比例 "+t.proportion1,a9:w,a10:""},type:ee.QueryTypes.INSERT});case 33:if(!t.para2){e.next=45;break}return S="\n            Select 用水量 from 水费基本表 where ((年=:year and 月=:month) or ( 年=:year1 and 月=:month1)) and (编号=:no) \n            ",e.next=37,ee.query(S,{replacements:{year:n,month:a,year1:i,month1:p,no:m.编号},type:ee.QueryTypes.SELECT});case 37:if(T=e.sent,g=0,k=0,2===T.length&&(g=parseInt(T[0].用水量),k=parseInt(T[1].用水量)),!(k<g*(1-parseFloat(t.proportion2))&&0!=g)){e.next=45;break}return F="\n                Insert into  水费误差分析 values (:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8,:a9,:a10 ) \n                ",e.next=45,ee.query(F,{replacements:{a1:n,a2:a,a3:(h+1).toString(),a4:m.编号,a5:k,a6:u,a7:s,a8:"小于比例 "+t.proportion1,a9:g,a10:""},type:ee.QueryTypes.INSERT});case 45:h++,e.next=19;break;case 48:return C="\n    SELECT A.年,A.月,A.编号,B.户名,B.装表地点,A.用水量,A.对比年,A.对比月,A.对比内容,A.对比水量 FROM 水费误差分析 A INNER JOIN 水费单位信息 B ON A.编号 = B.编号\n        where A.年=:year and 月=:month\n        ",e.next=51,ee.query(C,{replacements:{year:n,month:a},type:ee.QueryTypes.SELECT});case 51:return q=e.sent,e.abrupt("return",q);case 53:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.date,e.prev=1,e.next=4,W(n);case 4:a=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(a,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),X.InternalServerError(r,e.t0,e.t0);case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),W=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n,a,u,s,c,i,p;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.slice(0,4),n=t.slice(4),a="\n    SELECT A.年,A.月,A.编号,B.户名,B.装表地点,A.用水量,A.对比年,A.对比月,A.对比内容,A.对比水量 FROM 水费误差分析 A INNER JOIN 水费单位信息 B ON A.编号 = B.编号\n        where A.年=:year and 月=:month\n        ",e.next=5,ee.query(a,{replacements:{year:r,month:n},type:ee.QueryTypes.SELECT});case 5:return u=e.sent,s=Y.readFileSync($.join("./","assets","excel","Error.xlsx")),c=new Z(s),i="Sheet1",p={errors:u},c.substitute(i,p),e.abrupt("return",c.generate({type:"base64"}));case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.num,e.prev=1,e.next=4,z(n);case 4:a=e.sent,X.ResourceFound(r,a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0,{num:n});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),z=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="\n    Select 编号 from 水费单位信息 where 编号 =:num\n        ",e.next=3,ee.query(r,{replacements:{num:t},type:ee.QueryTypes.SELECT});case 3:return n=e.sent,e.abrupt("return",0===n.length);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=(0,c.default)(o.default.mark(function e(t,r){var n,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,V(n);case 4:a=e.sent,X.ResourceUpdated(r,a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0,{num:n.编号});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),V=function(){var e=(0,c.default)(o.default.mark(function e(t){var r,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="\n    update 水费单位信息 set 编号=:n1, 扣水单位编号=:n2 where 编号=:n3 \n    ",e.next=3,ee.query(r,{replacements:{n1:t.编号n,n2:t.扣水单位编号n,n3:t.编号},type:ee.QueryTypes.UPDATE});case 3:return n="\n    update 水费基本表 set 编号=:n1 where 编号=:n2 \n    ",e.next=6,ee.query(n,{replacements:{n1:t.编号n,n2:t.编号},type:ee.QueryTypes.UPDATE});case 6:return e.abrupt("return",!0);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),Z=(r(15),r(38)),Y=r(28),$=r(9),X=(r(12),r(1)),ee=r(7);e.exports.queryUnitsByPinYin=i,e.exports.queryUnitByNum=p,e.exports.queryUnitParas=f,e.exports.queryBankByName=y,e.exports.saveUnit=h,e.exports.createUnitNum=v,e.exports.MoveUnitPosition=w,e.exports.searchUnits=E,e.exports.unitsToExcel=S,e.exports.queryAllowanceByNum=g,e.exports.saveAllowance=F,e.exports.MoveAllowancePosition=q,e.exports.saveCollection=I,e.exports.MoveCollectionPosition=A,e.exports.queryUnitChangeName=R,e.exports.createChangeNameNum=_,e.exports.saveUnitChange=D,e.exports.searchUnitChange=O,e.exports.changeToExcel=j,e.exports.checkError=B,e.exports.checkErrorToExcel=G,e.exports.changeIdCheck=J,e.exports.saveUnitChangeId=K},function(e,t,r){"use strict";var n=r(0).Router(),a=r(165),u=a.queryStatTollStatus,s=a.handleStatToll,o=a.JingYingToExcel,c=a.StandardToExcel,i=a.DetailToExcel,p=a.JianBaoToExcel,l=a.QingDanToExcel,f=a.GongYeToExcel,d=a.ShuiSunToExcel,y=a.ShiZhengToExcel,h=a.handleLackUnit,m=a.deleteLackUnit;n.get("/toll/:date",u),n.post("/toll",s),n.post("/excel/jingying",o),n.post("/excel/standard",c),n.post("/excel/detail",i),n.post("/excel/jianbao",p),n.post("/excel/qingdan",l),n.post("/excel/gongye",f),n.post("/excel/shuisun",d),n.post("/excel/shizheng",y),n.post("/lackunit",h),n.delete("/lackunit/:num/:date",m),e.exports=n},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=n(r(5)),u=n(r(6)),s=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.date,e.prev=1,e.next=4,o(n);case 4:u=e.sent,A.ConvertNullToZeroString(u),A.ResourceFound(r,u),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),A.InternalServerError(r,e.t0,n);case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),o=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n,u,s;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.slice(0,4),n=t.slice(4),u="\n    SELECT 购水日期1, 购水量1, 购水单价1, 购水费1, 购水日期2, 购水量2, 购水单价2, 购水费2,统计标志  from 水费统计总表\n        where 年=:year and 月=:month\n    ",e.next=5,R.query(u,{replacements:{year:r,month:n},type:R.QueryTypes.SELECT});case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,i(n);case 4:return e.next=6,o(n.用水日期);case 6:u=e.sent,A.ConvertNullToZeroString(u),A.ResourceFound(r,u),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),A.InternalServerError(r,e.t0,n);case 14:case"end":return e.stop()}},e,this,[[1,11]])}));return function(t,r){return e.apply(this,arguments)}}(),i=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n,u,s,o,c,i,p,l,f,d,y;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.用水日期,n=r.slice(0,4),u=r.slice(4),s=Array.apply(null,Array(31)).map(function(){return""}),o=Array.apply(null,Array(61)).map(function(){return 0}),c=Array.apply(null,Array(11)).map(function(){return 0}),i="\n    Delete from 水费统计总表 where 年=:year and 月=:month\n    ",e.next=9,R.query(i,{replacements:{year:n,month:u},type:R.QueryTypes.DELETE});case 9:return p="\n    insert into 水费统计总表 (年,月) values (:a1,:a2)\n    ",e.next=12,R.query(p,{replacements:{a1:n,a2:u},type:R.QueryTypes.INSERT});case 12:return l="\n    update 水费统计总表 set 购水日期1=:a3,购水量1=:a4,购水单价1=:a5,购水费1=:a6,购水日期2=:a7,购水量2=:a8,购水单价2=:a9,购水费2=:a10 \n        where 年=:a1 and 月=:a2 \n    ",e.next=15,R.query(l,{replacements:{a1:n,a2:u,a3:t.购水日期1,a4:t.购水量1,a5:t.购水单价1,a6:t.购水费1,a7:t.购水日期2,a8:t.购水量2,a9:t.购水单价2,a10:t.购水费2},type:R.QueryTypes.UPDATE});case 15:return o[1]=parseFloat(t.购水量1)+parseFloat(t.购水量2),o[2]=parseFloat(t.购水费1)+parseFloat(t.购水费2),i="\n    Delete from 水费统计水费标准 where 年=:year and 月=:month\n    ",e.next=20,R.query(i,{replacements:{year:n,month:u},type:R.QueryTypes.DELETE});case 20:return p="\n    Insert into 水费统计水费标准 (年,月,区号,单位类型,水费标准,用水量,计划水费,超额水费,防火费,手续费,其它,水费收入,排污费,备注) \n        SELECT :year,:month,区号,单位类别,单价,sum(用水量-减免水量) as 用水量,sum(计划水费-减免水费) as 计划水费,sum(超额水费) ,sum(防火费),sum(手续费),\n        sum(其它),sum(实收水费),sum(排污费-减排污费) as 排污费,'' FROM 水费统计查询\n        where (年=:year) and (月=:month)  \n        group by 区号,单位类别,单价\n    ",e.next=23,R.query(p,{replacements:{year:n,month:u},type:R.QueryTypes.INSERT});case 23:return f="\n    Select sum(用水量) as a1,sum(水费收入) as a2 from  水费统计水费标准\n        where (年=:year) and (月=:month)\n    ",e.next=26,R.query(f,{replacements:{year:n,month:u},type:R.QueryTypes.SELECT});case 26:return d=e.sent,s[1]=d[0].a1,s[2]=d[0].a2,l="\n    update  水费统计水费标准  \n        set 总水量百分比=用水量*100/"+s[1]+",总水费百分比=水费收入*100/"+s[2]+" \n        where (年=:year) and (月=:month)\n    ",e.next=32,R.query(l,{replacements:{year:n,month:u},type:R.QueryTypes.UPDATE});case 32:return f="\n    Select count(distinct 编号) as 用户数,sum(用水量-减免水量) as 供水量,sum(计划水量-减免水量) as 计划水量,sum(计划水费-减免水费) as 计划水费,sum(超额水量) as 超额水量,\n        sum(超额水费) as 超额水费,sum(排污费-减排污费) as 排污费,sum(防火费) as 防火费,sum(手续费) as 手续费,sum(其它-减其它) as 其它,sum(实收水费) as 水费\n        from 水费统计查询\n        where (年=:year) and (月=:month)\n    ",e.next=35,R.query(f,{replacements:{year:n,month:u},type:R.QueryTypes.SELECT});case 35:return d=e.sent,c[1]=parseInt(d[0]["用户数"]),o[3]=parseFloat(d[0]["供水量"]),o[4]=parseFloat(d[0]["计划水量"]),o[5]=parseFloat(d[0]["计划水费"]),o[6]=parseFloat(d[0]["超额水量"]),o[7]=parseFloat(d[0]["超额水费"]),o[8]=parseFloat(d[0]["排污费"]),o[9]=parseFloat(d[0]["防火费"]),o[10]=parseFloat(d[0]["手续费"]),o[11]=parseFloat(d[0]["其它"]),o[12]=parseFloat(d[0]["水费"]),o[13]=o[1]-o[3],0!=o[1]?o[14]=o[13]/o[1]:o[14]=0,f="\n    Select count(distinct 编号) as 正式用户数\n        from 水费统计查询\n        where (年=:year) and (月=:month) and  用水形式编号='2'\n    ",e.next=52,R.query(f,{replacements:{year:n,month:u},type:R.QueryTypes.SELECT});case 52:return d=e.sent,c[2]=parseInt(d[0]["正式用户数"]),f="\n    Select count(distinct 编号) as 临时用户数\n        from 水费统计查询\n        where (年=:year) and (月=:month) and  用水形式编号='0'\n    ",e.next=57,R.query(f,{replacements:{year:n,month:u},type:R.QueryTypes.SELECT});case 57:if(d=e.sent,c[3]=parseInt(d[0]["临时用户数"]),c[1]==c[2]+c[3]){e.next=61;break}throw new Error("用户数计算错误");case 61:return l="\n    update 水费统计总表 set 用户个数=:a3,正式个数=:a4,临时个数=:a5,供水量=:a6,水费=:a7,计划水量=:a8,计划水费=:a9,超额水量=:a10,超额水费=:a11,排污费=:a12,防火费=:a13,\n        手续费=:a14,其它=:a15,与供水差值=:a16,水损率=:a17\n        where 年=:a1 and 月=:a2\n    ",e.next=64,R.query(l,{replacements:{a1:n,a2:u,a3:c[1],a4:c[2],a5:c[3],a6:o[3],a7:o[12],a8:o[4],a9:o[5],a10:o[6],a11:o[7],a12:o[8],a13:o[9],a14:o[10],a15:o[11],a16:o[13],a17:o[14]},type:R.QueryTypes.UPDATE});case 64:return i="\n    Delete from 水费统计市政公司 where 年=:year and 月=:month\n    ",e.next=67,R.query(i,{replacements:{year:n,month:u},type:R.QueryTypes.DELETE});case 67:return p="\n    insert into 水费统计市政公司\n        Select distinct :year,:month,REPLACE(SUBSTRING(户名, 10, 30), '）', ''),SUM(用水量),SUM(实收水费),''\n        From 水费报表查询 where (年=:year) and (月=:month) and 户名 like '%天保市政%'\n        Group by REPLACE(SUBSTRING(户名, 10, 30), '）', '')\n    ",e.next=70,R.query(p,{replacements:{year:n,month:u},type:R.QueryTypes.INSERT});case 70:return y=1,f="\n    select sum(实收水费) as a1 from 水费统计查询 where (年=:year) and (月=:month)\n        group by 收费形式编号\n    ",e.next=74,R.query(f,{replacements:{year:n,month:u},type:R.QueryTypes.SELECT});case 74:return d=e.sent,y=1,d.forEach(function(e){o[y+14]=parseFloat(e.a1),y+=1}),f="\n    select sum(实收水费) as a1 from 水费统计查询 where (年=:year) and (月=:month)\n        group by 用水形式编号\n    ",e.next=80,R.query(f,{replacements:{year:n,month:u},type:R.QueryTypes.SELECT});case 80:return d=e.sent,y=1,d.forEach(function(e){o[y+17]=parseFloat(e.a1),y+=1}),l="\n    update 水费统计总表 set 托收水费=:a3,支票水费=:a4,内结水费=:a5,临时水费=:a6,正式水费=:a7\n        where 年=:a1 and 月=:a2\n    ",e.next=86,R.query(l,{replacements:{a1:n,a2:u,a3:o[15],a4:o[16],a5:o[17],a6:o[18],a7:o[19]},type:R.QueryTypes.UPDATE});case 86:return l="\n        update 水费统计总表 set 统计标志=:a18\n            where 年=:a1 and 月=:a2\n        ",e.next=89,R.query(l,{replacements:{a1:n,a2:u,a18:8},type:R.QueryTypes.UPDATE});case 89:if(!t.简报){e.next=125;break}return i="\n        delete from  水费统计简报 where 年=:year and 月=:month\n        ",e.next=93,R.query(i,{replacements:{year:n,month:u},type:R.QueryTypes.DELETE});case 93:return f="\n        Select top 12 编号,用水量 from 水费基本表 \n            where 年=:year and 月=:month\n            and  编号 not in (Select distinct 编号 from 水费基本表 where  年=:year1 and 月=:month) \n            order by 用水量 desc\n        ",e.next=96,R.query(f,{replacements:{year:n,month:u,year1:(parseInt(n)-1).toString()},type:R.QueryTypes.SELECT});case 96:return d=e.sent,y=1,d.forEach(function(e){s[y]=e.编号,o[y+20]=parseFloat(e.用水量),y+=1}),i="\n        delete from 水费统计用水增长_中转 \n        ",e.next=102,R.query(i,{replacements:{year:n,month:u},type:R.QueryTypes.DELETE});case 102:return p="\n        insert into 水费统计用水增长_中转 (编号,本月用水) \n            Select 编号,用水量 from 水费基本表 \n            where (年=:year) and (月=:month)  \n            order by 用水量 desc \n        ",e.next=105,R.query(p,{replacements:{year:n,month:u},type:R.QueryTypes.INSERT});case 105:return l="\n        update 水费统计用水增长_中转 set 去年用水= \n            (Select top 1 用水量 from 水费基本表\n            where 年=:year and 月=:month    \n            and  编号=水费统计用水增长_中转.编号  order by  用水量 desc)\n        ",e.next=108,R.query(l,{replacements:{year:(parseInt(n)-1).toString(),month:u},type:R.QueryTypes.UPDATE});case 108:return f="\n        Select top 12 编号,本月用水,去年用水   from 水费统计用水增长_中转 \n            order by 本月用水-去年用水 desc\n        ",e.next=111,R.query(f,{replacements:{},type:R.QueryTypes.SELECT});case 111:d=e.sent,y=1,d.forEach(function(e){s[y+12]=e.编号,o[y+32]=parseFloat(e.本月用水),o[y+44]=parseFloat(e.去年用水),y+=1}),y=1;case 115:if(!(y<=12)){e.next=122;break}return p="\n            insert into  水费统计简报 (年,月,内部序号,新用户编号,新用户用水量,老用户编号,老用户本月水量,老用户去年水量) \n                values (:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8)\n            ",e.next=119,R.query(p,{replacements:{a1:n,a2:u,a3:y,a4:s[y],a5:o[y+20],a6:s[y+12],a7:o[y+32],a8:o[y+44]},type:R.QueryTypes.INSERT});case 119:y++,e.next=115;break;case 122:return l="\n        update 水费统计总表 set 统计标志=:a18\n            where 年=:a1 and 月=:a2\n        ",e.next=125,R.query(l,{replacements:{a1:n,a2:u,a18:9},type:R.QueryTypes.UPDATE});case 125:return e.abrupt("return",!0);case 126:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,l(n.用水日期,n.user);case 4:u=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(u,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),A.InternalServerError(r,e.t0,{});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),l=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u,s,o,c,i;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.slice(0,4),u=t.slice(4),s={date:n+"年"+u+"月"},o="\n    Select * from 水费统计总表 where (年=:year) and (月=:month)\n    ",e.next=6,R.query(o,{replacements:{year:n,month:u},type:R.QueryTypes.SELECT});case 6:return c=e.sent,i=c[0],s.D4=(parseFloat(i["购水量1"])+parseFloat(i["购水量2"])).toString(),s.D5=(parseFloat(i["购水费1"])+parseFloat(i["购水费2"])).toString(),s.D6=i["供水量"],s.D8=i["计划水费"],s.D9=i["超额水费"],s.D10=i["防火费"],s.D11=i["手续费"],s.D12=i["其它"],s.D13=i["排污费"],s.D15=i["托收水费"],s.D16=i["支票水费"],s.D17=i["内结水费"],s.D19=i["临时水费"],s.D20=i["正式水费"],s.D21=i["用户个数"],s.D22=i["临时个数"],s.D23=i["正式个数"],s.D24=(100*parseFloat(i["水损率"])).toString()+"%",o="\n    Select sum(购水量1+购水量2) as 购水量   ,  sum(购水费1+购水费2) as 购水费 , sum(供水量) as 供水量 , \n        sum(计划水费) as 计划水费 , sum(超额水费) as 超额水费  , sum(防火费) as 防火费   , sum(手续费) as 手续费   , sum(其它) as 其它     , sum(排污费) as 排污费,  \n        sum(托收水费) as 托收水费 , sum(支票水费) as 支票水费  , sum(内结水费) as 内结水费 , sum(临时水费) as 临时水费 , sum(正式水费) as 正式水费     , sum(用户个数) as 用户个数, \n        sum(临时个数) as 临时个数 , sum(正式个数) as 正式个数\n        from 水费统计总表 \n        where (年=:year) and (月=:month)\n    ",e.next=29,R.query(o,{replacements:{year:n,month:u},type:R.QueryTypes.SELECT});case 29:return c=e.sent,i=c[0],s.E4=i["购水量"],s.E5=i["购水费"],s.E6=i["供水量"],s.E8=i["计划水费"],s.E9=i["超额水费"],s.E10=i["防火费"],s.E11=i["手续费"],s.E12=i["其它"],s.E13=i["排污费"],s.E15=i["托收水费"],s.E16=i["支票水费"],s.E17=i["内结水费"],s.E19=i["临时水费"],s.E20=i["正式水费"],s.E21=Math.round(parseFloat(i["用户个数"])/parseFloat(u)),s.E22=Math.round(parseFloat(i["临时个数"])/parseFloat(u)),s.E23=Math.round(parseFloat(i["正式个数"])/parseFloat(u)),0===parseFloat(i["购水量"])?s.E24="0%":s.E24=((parseFloat(i["购水量"])-parseFloat(i["供水量"]))/parseFloat(i["购水量"])*100).toString()+"%",s.E25=r,s.E27=L(new Date,"yyyy-mm-dd"),e.abrupt("return",Q("JingYing","Sheet1",s));case 52:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),f=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,d(n.用水日期,n.user);case 4:u=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(u,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),A.InternalServerError(r,e.t0,{});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),d=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u,s,o,c;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.slice(0,4),u=t.slice(4),s={date:n+"年"+u+"月"},o="\n    Select * from 水费统计水费标准 where (年=:year) and (月=:month) order by 区号\n    ",e.next=6,R.query(o,{replacements:{year:n,month:u},type:R.QueryTypes.SELECT});case 6:return(c=e.sent).forEach(function(e){e.总水量百分比/=100,e.总水费百分比/=100}),s.items=c,s.D13=r,s.G13=L(new Date,"yyyy-mm-dd"),e.abrupt("return",Q("standard","Sheet1",s));case 12:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),y=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,h(n.用水日期,n.user);case 4:u=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(u,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),A.InternalServerError(r,e.t0,{});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),h=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u,s,o,c,i;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.slice(0,4),u=t.slice(4),s={date:L(new Date,"yyyy-mm-dd"),year:n,month:u},o="\n    Select * from 水费统计明细查询  where (年=:year) and (月=:month) \n    ",e.next=6,R.query(o,{replacements:{year:n,month:u},type:R.QueryTypes.SELECT});case 6:return c=e.sent,i=c.length,c.push({"编号":"合计","户名":i+"户","实际用水量":"=SUM(C4:C"+(3+i)+")","实际计划水费":"=SUM(D4:D"+(3+i)+")","超额水费":"=SUM(E4:E"+(3+i)+")","排污费":"=SUM(F4:F"+(3+i)+")","防火费":"=SUM(G4:G"+(3+i)+")","手续费":"=SUM(H4:H"+(3+i)+")","其它":"=SUM(I4:I"+(3+i)+")","减水费":"=SUM(J4:J"+(3+i)+")","实收水费":"=SUM(K4:K"+(3+i)+")"}),s.items=c,s.D13=r,s.G13=L(new Date,"yyyy-mm-dd"),e.abrupt("return",Q("Detail","Sheet1",s));case 13:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),m=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,v(n.用水日期,n.user);case 4:u=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(u,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),A.InternalServerError(r,e.t0,{});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),v=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u,s,o,c,i,p,l;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0,u=void 0,s=t.slice(0,4),o=t.slice(4),c=Array.apply(null,Array(11)).map(function(){return 0}),i={A2:s+"年"+o+"月",G24:L(new Date,"yyyy-mm-dd"),E24:r},p="\n    SELECT 供水量,水损率 from  水费统计总表  where (年=:year) and (月=:month) \n    ",e.next=8,R.query(p,{replacements:{year:s,month:o},type:R.QueryTypes.SELECT});case 8:return n=e.sent,u=n[0],c[1]=(parseFloat(u.供水量)/1e4).toFixed(2),c[2]=100*parseFloat(u.水损率),p="\n    SELECT 供水量 from  水费统计总表  where (年=:year) and (月=:month) \n    ",e.next=15,R.query(p,{replacements:{year:(parseInt(s)-1).toString(),month:o},type:R.QueryTypes.SELECT});case 15:return(n=e.sent).length>0?(u=n[0],c[3]=(parseFloat(u.供水量)/1e4).toFixed(2)):c[3]=20,p="\n    SELECT  sum(供水量) as 供水量 from  水费统计总表 where (年=:year) \n    ",e.next=20,R.query(p,{replacements:{year:s},type:R.QueryTypes.SELECT});case 20:return n=e.sent,u=n[0],c[4]=(parseFloat(u.供水量)/1e4).toFixed(2),c[5]=Math.round((c[1]-c[3])/c[3]*100),i.A3="一、"+o.toString()+"月份供水量"+parseFloat(c[1])+"万吨，本年累计完成"+parseFloat(c[4])+"万吨。",i.A4="    去年同期供水量"+parseFloat(c[3])+"万吨，比去年同期增长"+parseFloat(c[5])+"%  。",i.A20="二、本月水损率"+parseFloat(c[2])+"%，符合行业规定指标损耗范围。",p="\n    Select top 6 * from 水费统计简报查询 where 年=:year and 月=:month and 新用户名称 is not null order by 新用户用水量 desc\n    ",e.next=30,R.query(p,{replacements:{year:s,month:o},type:R.QueryTypes.SELECT});case 30:return n=e.sent,l=7,n.forEach(function(e){i["B"+l.toString()]=(l-6).toString()+". "+e["新用户名称"]+":本月"+e["新用户用水量"]+"吨。",l+=1}),p="\n    Select top 6  * from 水费统计简报查询 where 年=:year and 月=:month and 老用户名称 is not null  order by 老用户本月水量 desc\n    ",e.next=36,R.query(p,{replacements:{year:s,month:o},type:R.QueryTypes.SELECT});case 36:return n=e.sent,l=14,n.forEach(function(e){i["B"+l.toString()]=(l-13).toString()+". "+e["老用户名称"]+":本月"+e["老用户本月水量"]+"吨，去年同期"+e["老用户去年水量"]+"吨。",l+=1}),e.abrupt("return",Q("JianBao","Sheet1",i));case 40:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),x=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,w(n.用水日期,n.user);case 4:u=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(u,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),A.InternalServerError(r,e.t0,{});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),w=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u,s,o,c,i,p;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0,u=void 0,s=t.slice(0,4),o=t.slice(4),Array.apply(null,Array(11)).map(function(){return 0}),c={A1:s+"年"+o+"月",E30:L(new Date,"yyyy-mm-dd"),E28:r},i="\n    Select * from 水费统计总表   where (年=:year) and (月=:month) \n    ",e.next=8,R.query(i,{replacements:{year:s,month:o},type:R.QueryTypes.SELECT});case 8:return n=e.sent,u=n[0],c.D5=u["购水量1"],c.D6=u["购水量2"],c.D8=u["购水费1"],c.D9=u["购水费2"],c.D10=u["供水量"],c.D11=u["超额水量"],c.D13=u["计划水费"],c.D14=u["超额水费"],c.D15=u["防火费"],c.D16=u["手续费"],c.D17=u["其它"],c.D18=u["排污费"],i="\n    Select sum(购水量1) as 购水量1   , sum(购水量2) as 购水量2    , sum(购水费1) as 购水费1 , sum(购水费2) as 购水费2 , sum(供水量) as 供水量 , sum(超额水量) as 超额水量,\n        sum(计划水费) as 计划水费 , sum(超额水费) as 超额水费  , sum(防火费) as 防火费   , sum(手续费) as 手续费   , sum(其它) as 其它     , sum(排污费) as 排污费 \n        from 水费统计总表 where (年=:year) and (月<=:month) \n    ",e.next=25,R.query(i,{replacements:{year:s,month:o},type:R.QueryTypes.SELECT});case 25:return n=e.sent,u=n[0],c.E5=u["购水量1"],c.E6=u["购水量2"],c.E8=u["购水费1"],c.E9=u["购水费2"],c.E10=u["供水量"],c.E11=u["超额水量"],c.E13=u["计划水费"],c.E14=u["超额水费"],c.E15=u["防火费"],c.E16=u["手续费"],c.E17=u["其它"],c.E18=u["排污费"],i="\n    Select * from 水费统计市政公司 where (年=:year) and (月<=:month) order by 部门 \n    ",e.next=42,R.query(i,{replacements:{year:s,month:o},type:R.QueryTypes.SELECT});case 42:return n=e.sent,p=20,n.forEach(function(e){c["B"+p.toString()]=e["部门"],c["D"+p.toString()]=e["金额"],p+=1}),i="\n    Select 部门,sum(金额) as 金额 from 水费统计市政公司 where (年=:year)  group by 部门 \n    ",e.next=48,R.query(i,{replacements:{year:s},type:R.QueryTypes.SELECT});case 48:return n=e.sent,p=20,n.forEach(function(e){c["E"+p.toString()]=e["金额"],p+=1}),e.abrupt("return",Q("qingdan","Sheet1",c));case 52:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),E=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,b(n.用水日期,n.user);case 4:u=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(u,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),A.InternalServerError(r,e.t0,{});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),b=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u,s,o,c,i;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0,void 0,u=t.slice(0,4),s=t.slice(4),o={date:u+"年"+s+"月"},c="\n    Select * from 水费统计查询 where (年=:year) and (月=:month) and (区号='2' or 区号='7') order by 编号\n    ",e.next=7,R.query(c,{replacements:{year:u,month:s},type:R.QueryTypes.SELECT});case 7:return n=e.sent,i=1,n.forEach(function(e){e.序号=i,e.年=u,e.月=s,i+=1}),n.push({"序号":"合计","用水量":"=SUM(F3:F"+(n.length+2)+")"}),o.items=n,e.abrupt("return",Q("GongYe","Sheet1",o));case 13:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),S=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,T(n.用水日期,n.user);case 4:u=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(u,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),A.InternalServerError(r,e.t0,{});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),T=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u,s,o,c,i;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0,void 0,u=t.slice(0,4),t.slice(4),s=Array.apply(null,Array(31)).map(function(){return 0}),o={B2:u+"年"},c="\n    Select * from 水费统计总表 where (年=:year) order by 月\n    ",e.next=8,R.query(c,{replacements:{year:u},type:R.QueryTypes.SELECT});case 8:return n=e.sent,i=1,n.forEach(function(e){s[i]=(parseFloat(e["购水量1"])+parseFloat(e["购水量2"]))/1e4,s[i+12]=parseFloat(e["供水量"])/1e4,i+=1}),o.B4=parseFloat(s[1]),o.C4=parseFloat(s[2]),o.D4=parseFloat(s[3]),o.E4=parseFloat(s[4]),o.F4=parseFloat(s[5]),o.G4=parseFloat(s[6]),o.H4=parseFloat(s[7]),o.I4=parseFloat(s[8]),o.J4=parseFloat(s[9]),o.K4=parseFloat(s[10]),o.L4=parseFloat(s[11]),o.M4=parseFloat(s[12]),o.B5=parseFloat(s[13]),o.C5=parseFloat(s[14]),o.D5=parseFloat(s[15]),o.E5=parseFloat(s[16]),o.F5=parseFloat(s[17]),o.G5=parseFloat(s[18]),o.H5=parseFloat(s[19]),o.I5=parseFloat(s[20]),o.J5=parseFloat(s[21]),o.K5=parseFloat(s[22]),o.L5=parseFloat(s[23]),o.M5=parseFloat(s[24]),e.abrupt("return",Q("ShuiSun","sheet1",o));case 36:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),g=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,k(n.用水日期,n.user);case 4:u=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(u,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),A.InternalServerError(r,e.t0,{});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),k=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u,s,o,c,i;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0,void 0,u=t.slice(0,4),s=t.slice(4),Array.apply(null,Array(31)).map(function(){return 0}),o={date:u+"年"+s+"月"},c="\n    Select * from 水费统计市政公司  where (年=:year) and (月=:month) \n    ",e.next=8,R.query(c,{replacements:{year:u,month:s},type:R.QueryTypes.SELECT});case 8:return n=e.sent,i=n.length,n.push({"部门":"合计","实际用水":"=SUM(B4:B"+(i+3)+")","金额":"=SUM(C4:C"+(i+3)+")"}),o.items=n,e.abrupt("return",Q("shizheng","Sheet1",o));case 13:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),F=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,C(n);case 4:u=e.sent,A.ConvertNullToZeroString(u),A.ResourceFound(r,u),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),A.InternalServerError(r,e.t0,n);case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),C=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n,u,s,o,c,i,p,l,f,d,y,h;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=void 0,void 0,n=t.月份,u=t.统计选项,s=n.slice(0,4),o=n.slice(4),c=void 0,i=void 0,p=void 0,l=void 0,f=void 0,d=void 0,"01"===o?(c=(parseInt(s)-1).toString(),i="12"):(c=s,i=(i=(parseInt(o)-1).toString()).length<2?"0"+i:i),!u.includes("1")){e.next=39;break}return p="\n        Delete from  水费统计欠费 where 年=:year and 月=:month\n        ",e.next=12,R.query(p,{replacements:{year:s,month:o},type:R.QueryTypes.DELETE});case 12:return l="\n        Insert into 水费统计欠费 (年,月,编号,户名,往年欠费,本月欠费,前几月累计,小计,备注)\n        ",l+="01"===o?"\n            SELECT :year,:month,编号,户名,往年欠费+本月欠费+前几月累计,0,0,0,备注 FROM 水费统计欠费 \n            ":"\n            SELECT :year,:month,编号,户名,往年欠费,0,本月欠费+前几月累计,0,备注 FROM 水费统计欠费 \n            ",l+="\n        where  年=:TempYear and 月=:TempMonth\n            ",e.next=17,R.query(l,{replacements:{year:s,month:o,TempYear:c,TempMonth:i},type:R.QueryTypes.INSERT});case 17:return l="\n        Insert into 水费统计欠费 (年,月,编号,户名,往年欠费,本月欠费,前几月累计,小计,备注)\n            SELECT :year, :month, 编号,户名,0,实收水费,0,0,'自动计算' FROM 水费基本表\n            Where 编号 not in (Select 编号 from 水费统计欠费 where 年=:year and 月=:month) and 欠费标志='2' and 年=:month and 月=:month\n        ",e.next=20,R.query(l,{replacements:{year:s,month:o},type:R.QueryTypes.INSERT});case 20:return f="\n        update 水费统计欠费 set 往年欠费=(Select Sum (实收水费) FROM 水费基本表 where 欠费标志='2' and 年<:year and 编号=水费统计欠费.编号)\n            where 年=:year and 月=:month and 备注='自动计算'\n        ",e.next=23,R.query(f,{replacements:{year:s,month:o},type:R.QueryTypes.UPDATE});case 23:return f="\n        update 水费统计欠费 set 本月欠费=(Select Sum (实收水费) FROM 水费基本表 where 欠费标志='2' and 年=:year and 编号=水费统计欠费.编号 and 月=:month) \n            where 年=:year and 月=:month \n        ",e.next=26,R.query(f,{replacements:{year:s,month:o},type:R.QueryTypes.UPDATE});case 26:return f="01"===o?"\n            update 水费统计欠费 set 前几月欠费=0 \n            ":"\n            update 水费统计欠费 set 前几月累计=(Select Sum (实收水费) FROM 水费基本表 where 欠费标志='2' and 年=:year and 编号=水费统计欠费.编号 and 月<:month)\n            ",f+="\n        where 年=:year and 月=:month and 备注='自动计算'\n            ",e.next=30,R.query(f,{replacements:{year:s,month:o},type:R.QueryTypes.UPDATE});case 30:y=["往年欠费","本月欠费","前几月累计","小计"],h=0;case 32:if(!(h<y.length)){e.next=39;break}return f="\n                update 水费统计欠费 set "+y[h]+"=0 where "+y[h]+" is null \n                ",e.next=36,R.query(f,{replacements:{},type:R.QueryTypes.UPDATE});case 36:h++,e.next=32;break;case 39:if(!u.includes("2")){e.next=43;break}return f="\n        Update 水费统计欠费\n            Set 小计=往年欠费+本月欠费+前几月累计\n            where 年=:year and 月=:month\n            ",e.next=43,R.query(f,{replacements:{year:s,month:o},type:R.QueryTypes.UPDATE});case 43:return d="\n    Select * from  水费统计欠费\n        where  年=:year and 月=:month\n            ",e.next=46,R.query(d,{replacements:{year:s,month:o},type:R.QueryTypes.SELECT});case 46:return r=e.sent,e.abrupt("return",r);case 48:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u,s,o;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params,u=n.date,s=n.num,e.prev=1,e.next=4,I(u,s);case 4:o=e.sent,A.ResourceFound(r,o),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),A.InternalServerError(r,e.t0,{date:u,num:s});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),I=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u,s,o;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.slice(0,4),u=t.slice(4),void 0,void 0,s=void 0,s="\n    Delete from 水费统计欠费 where 年=:year and 月=:month and 编号=:num\n    ",e.next=7,R.query(s,{replacements:{year:n,month:u,num:r},type:R.QueryTypes.DELETE});case 7:return o=e.sent,e.abrupt("return",o);case 9:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),L=r(12),A=r(1),R=r(7),Q=r(29).toExcel;e.exports.queryStatTollStatus=s,e.exports.handleStatToll=c,e.exports.JingYingToExcel=p,e.exports.StandardToExcel=f,e.exports.DetailToExcel=y,e.exports.JianBaoToExcel=m,e.exports.QingDanToExcel=x,e.exports.GongYeToExcel=E,e.exports.ShuiSunToExcel=S,e.exports.ShiZhengToExcel=g,e.exports.handleLackUnit=F,e.exports.deleteLackUnit=q},function(e,t,r){"use strict";var n=r(0).Router(),a=r(167),u=a.queryCommission,s=a.queryDetail,o=a.ChargeMonthToExcel,c=a.ChargeYearToExcel,i=a.queryAllowance,p=a.AllowanceToExcel;n.get("/commission/:date",u),n.get("/detail/:date/:kind",s),n.post("/chargemonth/excel",o),n.post("/chargeyear/excel",c),n.get("/allowance",i),n.get("/allowance/excel/:lister",p),e.exports=n},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=n(r(5)),u=n(r(6)),s=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.date,e.prev=1,e.next=4,o(n);case 4:u=e.sent,w.ResourceFound(r,u),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),w.InternalServerError(r,e.t0,n);case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),o=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n,u,s;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.slice(0,4),n=t.slice(4),u="\n    Select * from 水费报表查询 \n        where 年=:year and 月=:month\n        and 收费形式编号='1' order by 编号\n    ",e.next=5,E.query(u,{replacements:{year:r,month:n},type:E.QueryTypes.SELECT});case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u,s,o;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params,u=n.date,s=n.kind,e.prev=1,e.next=4,i(u,s);case 4:o=e.sent,w.ResourceFound(r,o),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),w.InternalServerError(r,e.t0,u);case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),i=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u,s,o;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.slice(0,4),u=t.slice(4),s=void 0,s=r&&"5"!==r?"\n        Select * from 水费报表查询 \n            where 年=:year and 月=:month\n            and 收费形式编号=:kind order by 编号\n        ":"\n        Select * from 水费报表查询 \n            where 年=:year and 月=:month\n            order by 编号\n        ",e.next=6,E.query(s,{replacements:{year:n,month:u,kind:r},type:E.QueryTypes.SELECT});case 6:return o=e.sent,e.abrupt("return",o);case 8:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),p=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,l(n);case 4:u=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(u,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),w.InternalServerError(r,e.t0,{});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),l=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n,u,s,o,c,i;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,void 0,n=t.月份,u=n.slice(0,4),s=n.slice(4),o={date:x(new Date,"yyyy-mm-dd"),year:u,month:s},c="\n    SELECT * FROM 水费报表查询  where (年=:year) and (月=:month) \n        and (编号>=:num1)  and  (编号<=:num2) \n        "+("1"===t.kind?"and (区号<>'8')":"and (区号='8')")+"\n        Order by 编号\n    ",e.next=8,E.query(c,{replacements:{year:u,month:s,num1:t.num1,num2:t.num2},type:E.QueryTypes.SELECT});case 8:return r=e.sent,(i=r.length)>0&&r.push({"编号":"合计","户名":i+"户","装表地点":"","上月表底":"=SUM(D4:D"+(i+3)+")","本月表底":"=SUM(E4:E"+(i+3)+")","实际用水量":"=SUM(F4:F"+(i+3)+")","实际计划水费":"=SUM(H4:H"+(i+3)+")","超额水量":"=SUM(I4:I"+(i+3)+")","超额水费":"=SUM(K4:K"+(i+3)+")","排污费":"=SUM(L4:L"+(i+3)+")","防火费":"=SUM(M4:M"+(i+3)+")","手续费":"=SUM(N4:N"+(i+3)+")","其它":"=SUM(O4:O"+(i+3)+")","减水费":"=SUM(P4:P"+(i+3)+")","实收水费":"=SUM(Q4:Q"+(i+3)+")"}),o.items=r,e.abrupt("return",b("charge","Sheet1",o));case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,d(n);case 4:u=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(u,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),w.InternalServerError(r,e.t0,{});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),d=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n,u,s;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,void 0,n={date:x(new Date,"yyyy-mm-dd")},u="\n    Select 年,编号,户名,装表地点,sum(上月表底)as 上月表底,sum(本月表底)as 本月表底,sum(实际用水量) as 实际用水量,sum(实际计划水费) as 实际计划水费,sum(超额水量) as 超额水量,sum(超额水费) as 超额水费,sum(防火费) as 防火费,sum(手续费) as 手续费,\n        sum(减水费) as 减水费,sum(实收水费) as 实收水费,sum(排污费) as 排污费,sum(其它) as 其它 from 水费报表查询\n        where (年+月>=:date1) and (年+月<=:date2)\n        and (编号>=:num1)  and  (编号<=:num2)\n        group by 年,编号,户名,装表地点 order by 编号\n    ",e.next=5,E.query(u,{replacements:{date1:t.date1,date2:t.date2,num1:t.num1,num2:t.num2},type:E.QueryTypes.SELECT});case 5:return r=e.sent,(s=r.length)>0&&r.push({"年":"合计","月":s+"户","上月表底":"=SUM(F4:F"+(s+3)+")","本月表底":"=SUM(G4:G"+(s+3)+")","实际用水量":"=SUM(H4:H"+(s+3)+")","实际计划水费":"=SUM(J4:J"+(s+3)+")","超额水量":"=SUM(K4:K"+(s+3)+")","超额水费":"=SUM(M4:M"+(s+3)+")","排污费":"=SUM(N4:N"+(s+3)+")","防火费":"=SUM(O4:O"+(s+3)+")","手续费":"=SUM(P4:P"+(s+3)+")","其它":"=SUM(Q4:Q"+(s+3)+")","减水费":"=SUM(R4:R"+(s+3)+")","实收水费":"=SUM(S4:S"+(s+3)+")"}),n.items=r,e.abrupt("return",b("chargeyear","Sheet2",n));case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h();case 3:n=e.sent,w.ResourceFound(r,n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),w.InternalServerError(r,e.t0,{});case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(t,r){return e.apply(this,arguments)}}(),h=function(){var e=(0,u.default)(a.default.mark(function e(){var t,r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0,t="\n    SELECT * FROM  水费贴费查询\n        ",e.next=4,E.query(t,{replacements:{},type:E.QueryTypes.SELECT});case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),m=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.lister,e.prev=1,e.next=4,v(n);case 4:u=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(u,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),w.InternalServerError(r,e.t0,{});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),v=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,void 0,n={date:x(new Date,"yyyy-mm-dd"),lister:t},u="\n    Select * from 水费贴费查询\n    ",e.next=5,E.query(u,{replacements:{},type:E.QueryTypes.SELECT});case 5:return r=e.sent,n.items=r,e.abrupt("return",b("allowance1","Sheet1",n));case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),x=r(12),w=r(1),E=r(7),b=r(29).toExcel;e.exports.queryCommission=s,e.exports.queryDetail=c,e.exports.ChargeMonthToExcel=p,e.exports.ChargeYearToExcel=f,e.exports.queryAllowance=y,e.exports.AllowanceToExcel=m},function(e,t,r){"use strict";var n=r(0).Router(),a=r(169),u=a.AllowanceToExcel,s=a.queryAllowance,o=a.queryFixWatch,c=a.queryRation,i=a.queryContract,p=a.queryCountShiZheng,l=a.CountShiZhengToExcel,f=a.queryCountAll,d=a.CountAllToExcel;n.post("/allowance/excel",u),n.post("/allowance",s),n.post("/fixwatch",o),n.post("/ration",c),n.post("/contract",i),n.post("/countshizheng",p),n.post("/countshizheng/excel",l),n.post("/countall",f),n.post("/countall/excel",d),e.exports=n},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=n(r(5)),u=n(r(6)),s=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,o(n);case 4:u=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(u,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),k.InternalServerError(r,e.t0,{});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),o=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,void 0,n={date:g(new Date,"yyyy-mm-dd"),user:t.user,kind:q[t.kind]},e.next=4,i(t);case 4:return r=e.sent,(u=r.length)>0&&r.push({"户名":"合计","装表地点":"","水贴费":"=SUM(E4:E"+(u+3)+")","增容费1":"=SUM(H4:H"+(u+3)+")","增容费2":"=SUM(J4:J"+(u+3)+")","增容费3":"=SUM(L4:L"+(u+3)+")","增容费4":"=SUM(N4:N"+(u+3)+")","增容费5":"=SUM(P4:P"+(u+3)+")","合计":"=SUM(Q4:Q"+(u+3)+")"}),n.items=r,e.abrupt("return",C("allowance","Sheet1",n));case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,i(n);case 4:u=e.sent,k.ResourceFound(r,u),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),k.InternalServerError(r,e.t0,n);case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),i=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="\n    SELECT A.编号,B.户名,B.装表地点,A.交费日期,A.水贴费,A.贴费状态,A.增容日期1,A.增容费1,A.增容日期2,A.增容费2,A.增容日期3,A.增容费3,A.增容日期4,A.增容费4,A.增容日期5,A.增容费5, \n        A.合计 FROM 水费贴费表 A INNER JOIN 水费单位信息 B ON A.编号=B.编号\n        where (substring(交费日期,1,6)>=:date1)\n        and   (substring(交费日期,1,6)<=:date2)\n        and (A.编号>=:num1)  and  (A.编号<=:num2)\n    ",t.kind&&"无"!==t.kind&&(r+=" and (贴费状态=:kind) "),r+=" Order by A.编号 ",e.next=5,F.query(r,{replacements:{date1:t.date1,date2:t.date2,num1:t.num1,num2:t.num2,kind:t.kind},type:F.QueryTypes.SELECT});case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,l(n);case 4:u=e.sent,k.ResourceFound(r,u),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),k.InternalServerError(r,e.t0,n);case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),l=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="\n    Select 编号,户名,装表地点,装表费,用水日期,装表日期 from 水费单位信息        \n        where (substring(用水日期,1,6)>=:date1)\n        and   (substring(用水日期,1,6)<=:date2)\n        and (编号>=:num1)  and  (编号<=:num2)\n        Order by 编号\n    ",e.next=3,F.query(r,{replacements:{date1:t.date1,date2:t.date2,num1:t.num1,num2:t.num2},type:F.QueryTypes.SELECT});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,d(n);case 4:u=e.sent,k.ResourceFound(r,u),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),k.InternalServerError(r,e.t0,n);case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),d=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="\n    Select 编号,户名,装表地点,申请水量,定额,substring(用水日期,1,4)+'.'+substring(用水日期,5,2)+' - '+substring(使用期限,1,4)+'.'+substring(使用期限,5,2) as 起止日期 from 水费单位信息        \n        where (扣水单位编号=编号) and 节门状态='开'\n        and (编号>=:num1)  and  (编号<=:num2)\n        "+("1"===t.kind?" and (申请水量>0)":" and (定额>0)")+"\n        Order by 编号\n    ",e.next=3,F.query(r,{replacements:{date1:t.date1,date2:t.date2,num1:t.num1,num2:t.num2},type:F.QueryTypes.SELECT});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,h(n);case 4:u=e.sent,k.ResourceFound(r,u),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),k.InternalServerError(r,e.t0,n);case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),h=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="\n    Select 编号,户名,联系人,电话 from 水费单位信息\n        where (扣水单位编号=编号) and 节门状态='开'\n        and (编号>=:num1)  and  (编号<=:num2)\n        Order by 编号\n    ",e.next=3,F.query(r,{replacements:{num1:t.num1,num2:t.num2},type:F.QueryTypes.SELECT});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,v(n);case 4:u=e.sent,k.ResourceFound(r,u),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),k.InternalServerError(r,e.t0,n);case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),v=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n,u,s,o,c;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=void 0,n=void 0,void 0,u=void 0,s=t.date.slice(0,4),o=t.date.slice(4),!t.recount){e.next=10;break}return u="\n            Delete from 水费统计市政公司 where (年=:year) and (月=:month)\n        ",e.next=7,F.query(u,{replacements:{year:s,month:o},type:F.QueryTypes.DELETE});case 7:return n="\n            Insert into 水费统计市政公司\n            SELECT :year, :month,装表地点,用水量,应收水费,0,0,0,'' FROM 水费修改计算 \n            where (年=:year) and (月=:month) and 户名 like '%市政%'\n        ",e.next=10,F.query(n,{replacements:{year:s,month:o},type:F.QueryTypes.INSERT});case 10:return r="\n    SELECT * FROM  水费统计市政公司 \n        where (年=:year) and (月=:month) \n    ",e.next=13,F.query(r,{replacements:{year:s,month:o},type:F.QueryTypes.SELECT});case 13:return c=e.sent,e.abrupt("return",c);case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,w(n);case 4:u=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(u,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),k.InternalServerError(r,e.t0,{});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),w=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n,u,s;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,n=t.date.slice(0,4),u=t.date.slice(4),t.recount=!1,s={year:n,month:u,date:g(new Date,"yyyy-mm-dd"),user:t.user},e.next=7,v(t);case 7:return r=e.sent,s.items=r,e.abrupt("return",C("shizheng1","Sheet1",s));case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,b(n);case 4:u=e.sent,k.ResourceFound(r,u),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),k.InternalServerError(r,e.t0,n);case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),b=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n,u,s,o,c,i;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=void 0,n=void 0,u=void 0,s=void 0,o=t.date.slice(0,4),c=t.date.slice(4),!t.recount){e.next=19;break}return s="\n            Delete from 水费统计清单  where (年=:year) and (月=:month)\n        ",e.next=7,F.query(s,{replacements:{year:o,month:c},type:F.QueryTypes.DELETE});case 7:return n="\n        Insert into 水费统计清单 (年,月,收入水量,排污费,水费收入,超额水量,超额水费)\n            SELECT :year, :month,sum(用水量),sum(排污费),sum(应收水费),sum(超额水量),sum(超额水费) FROM 水费修改计算 \n            where (年=:year) and (月=:month)'\n        ",e.next=10,F.query(n,{replacements:{year:o,month:c},type:F.QueryTypes.INSERT});case 10:return u="\n        Update 水费统计清单 Set 年累计收入量= \n        (SELECT sum(收入水量)  FROM 水费统计清单 where (年=:year) and (月<=:month))\n            where (年=:year) and (月=:month)       \n        ",e.next=13,F.query(u,{replacements:{year:o,month:c},type:F.QueryTypes.UPDATE});case 13:return u="\n        Update 水费统计清单 Set 年水费累计收入= \n        (SELECT sum(水费收入)  FROM 水费统计清单 where (年=:year) and (月<=:month))\n            where (年=:year) and (月=:month)       \n        ",e.next=16,F.query(u,{replacements:{year:o,month:c},type:F.QueryTypes.UPDATE});case 16:return u="\n        Update 水费统计清单 Set 市政公司水费= \n        (SELECT sum(金额)  FROM 水费统计市政公司 (年=:year) and (月=:month))\n            where (年=:year) and (月=:month)       \n        ",e.next=19,F.query(u,{replacements:{year:o,month:c},type:F.QueryTypes.UPDATE});case 19:return r="\n    SELECT * FROM  水费统计清单\n        where (年=:year) and (月=:month) \n    ",e.next=22,F.query(r,{replacements:{year:o,month:c},type:F.QueryTypes.SELECT});case 22:return i=e.sent,e.abrupt("return",i);case 24:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,T(n);case 4:u=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(u,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),k.InternalServerError(r,e.t0,{});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),T=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n,u,s,o;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,n=void 0,u=t.date.slice(0,4),s=t.date.slice(4),t.recount=!1,o={year:u,month:s,date:g(new Date,"yyyy-mm-dd"),user:t.user},e.next=7,b(t);case 7:return(r=e.sent).length>0&&(n=r[0],o.C3=n["收入水量"],o.C4=n["年累计收入量"],o.C5=n["排污费"],o.C6=n["水费收入"],o.C7=n["年水费累计收入"],o.C8=n["超额水量"],o.C9=n["超额水费"],o.C10=n["市政公司水费"]),o.D4="1-"+s+"月份",o.D7="1-"+s+"月份",o.D16=t.user,o.D21=o.date,o.items=r,e.abrupt("return",C("qingdan1","Sheet1",o));case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),g=r(12),k=r(1),F=r(7),C=r(29).toExcel;e.exports.AllowanceToExcel=s;var q={"无":"全部单位","收":"已收水贴费单位","免":"免水贴费单位","欠":"欠水贴费单位","管":"交管委会单位"};e.exports.queryAllowance=c,e.exports.queryFixWatch=p,e.exports.queryRation=f,e.exports.queryContract=y,e.exports.queryCountShiZheng=m,e.exports.CountShiZhengToExcel=x,e.exports.queryCountAll=E,e.exports.CountAllToExcel=S},function(e,t,r){"use strict";var n=r(0).Router(),a=r(171),u=a.queryAllBank,s=a.queryCollection,o=a.queryCollectionTable,c=a.createCollection,i=a.CollectionToExcel,p=a.SaveToBankOfferTxt,l=a.queryUser,f=a.SaveToUserOfferTxt,d=a.queryBatch,y=a.XinFengHuiZongToExcel,h=a.XinFengToExcel,m=a.inputDisk,v=a.OutputDetailToExcel,x=a.queryCollectionCount,w=a.createCollectionCount,E=a.OutputCountToExcel,b=a.queryBank,S=a.createBank,T=a.deleteBank,g=a.updateBank;n.get("/bank",u),n.post("/collection",s),n.post("/collectiontable",o),n.put("/collection",c),n.post("/collection/excel",i),n.post("/collection/txt",p),n.post("/user",l),n.post("/user/txt",f),n.get("/batch/:date",d),n.post("/xinfenghuizong/excel",y),n.post("/xinfeng/excel",h),n.post("/detail/excel",v),n.get("/count/:date",x),n.put("/count",w),n.post("/count/excel",E),n.put("/disk",m),n.get("/banks",b),n.put("/banks",S),n.delete("/banks/:num",T),n.post("/banks",g),e.exports=n},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=n(r(172)),u=n(r(37)),s=n(r(5)),o=n(r(6)),c=function(){var e=(0,o.default)(s.default.mark(function e(t,r){var n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i();case 3:n=e.sent,X.ResourceFound(r,n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),X.InternalServerError(r,e.t0,{});case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(t,r){return e.apply(this,arguments)}}(),i=function(){var e=(0,o.default)(s.default.mark(function e(){var t,r;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="\n    SELECT  distinct 银行代码,银行名称 from 水费字典银行查询 order by 银行代码\n    ",e.next=3,ee.query(t,{replacements:{},type:ee.QueryTypes.SELECT});case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),p=function(){var e=(0,o.default)(s.default.mark(function e(t,r){var n,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,l(n);case 4:a=e.sent,X.ResourceFound(r,a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0,{});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),l=function(){var e=(0,o.default)(s.default.mark(function e(t){var r,n,a,u;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.date.slice(0,4),n=t.date.slice(4),a="\n    SELECT  * from 水费托收查询 where 年=:year and 月=:month "+(t.recount?"and 托收批次<1":"")+"\n    ",e.next=5,ee.query(a,{replacements:{year:r,month:n},type:ee.QueryTypes.SELECT});case 5:return u=e.sent,e.abrupt("return",u);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=(0,o.default)(s.default.mark(function e(t,r){var n,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,d(n);case 4:a=e.sent,X.ResourceFound(r,a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0,{});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),d=function(){var e=(0,o.default)(s.default.mark(function e(t){var r,n,a,u;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.date.slice(0,4),n=t.date.slice(4),a="\n    SELECT  * from 水费托收表 where 年=:year and 月=:month "+(t.recount?"and 托收批次<1":"")+"\n    ",e.next=5,ee.query(a,{replacements:{year:r,month:n},type:ee.QueryTypes.SELECT});case 5:return u=e.sent,e.abrupt("return",u);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=(0,o.default)(s.default.mark(function e(t,r){var n,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,h(n);case 4:a=e.sent,X.ResourceFound(r,a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0,{});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),h=function(){var e=(0,o.default)(s.default.mark(function e(t){var r,n,a,u,o,c,i,p,f,d;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.date.slice(0,4),n=t.date.slice(4),a=void 0,u=void 0,o=void 0,c=void 0,i=void 0,void 0,void 0,p=void 0,u="\n    delete from 水费托收表 where 年=:year and 月=:month\n    ",e.next=7,ee.query(u,{replacements:{year:r,month:n},type:ee.QueryTypes.DELETE});case 7:return c="\n    Insert into 水费托收表 (年,月,编号,应收水费)\n        SELECT A.年,A.月,B.扣水单位编号,sum(A.应收水费) FROM  水费单位信息 B INNER JOIN  水费基本表 A ON B.编号 = A.编号 where A.年=:year and A.月=:month AND B.收费形式编号='1'\n        group by  A.年,A.月,B.扣水单位编号     \n    ",e.next=10,ee.query(c,{replacements:{year:r,month:n},type:ee.QueryTypes.INSERT});case 10:return a="\n    SELECT  编号 from 水费托收表 where 年=:year and 月=:month order by 编号\n    ",e.next=13,ee.query(a,{replacements:{year:r,month:n},type:ee.QueryTypes.SELECT});case 13:i=e.sent,f=0;case 15:if(!(f<i.length)){e.next=30;break}return d=i[f],p=t.date+" 编号 ",a="\n        select 编号,本月表底,用水量,实收水费 From 水费报表查询 where 收费形式编号='1' and 扣水单位编号=:num and 年=:year and 月=:month\n        ",e.next=21,ee.query(a,{replacements:{num:d.编号,year:r,month:n},type:ee.QueryTypes.SELECT});case 21:return e.sent.forEach(function(e){p=p+e.编号+" "}),p.length>60&&(p=p.slice(0,55)+" 水费"),o="\n        update 水费托收表 set 备注=:temp where 编号=:num and 年=:year and 月=:month \n        ",e.next=27,ee.query(o,{replacements:{num:d.编号,temp:p,year:r,month:n},type:ee.QueryTypes.UPDATE});case 27:f++,e.next=15;break;case 30:return e.next=32,l(t);case 32:return e.abrupt("return",e.sent);case 33:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=(0,o.default)(s.default.mark(function e(t,r){var n,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,v(n);case 4:a=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(a,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),X.InternalServerError(r,e.t0,{});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),v=function(){var e=(0,o.default)(s.default.mark(function e(t){var r,n,a,u,o;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,void 0,n=t.date.slice(0,4),a=t.date.slice(4),t.recount=!1,u={year:n,month:a,date:$(new Date,"yyyy-mm-dd"),user:t.user},e.next=7,l(t);case 7:return r=e.sent,(o=r.length)>0&&r.push({"编号":"合计","户名":o+"户","应收水费":"=SUM(D4:D"+(o+3)+")"}),u.items=r,e.abrupt("return",re("TuoShou","Sheet1",u));case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=(0,o.default)(s.default.mark(function e(t,r){var n,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,w(n);case 4:a=e.sent,r.setHeader("Content-type","application/octet-stream"),r.setHeader("Content-disposition","attachment; filename="+a.name),r.charset="UTF-8",r.send(a.data),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),X.InternalServerError(r,e.t0.message,{});case 14:case"end":return e.stop()}},e,this,[[1,11]])}));return function(t,r){return e.apply(this,arguments)}}(),w=function(){var e=(0,o.default)(s.default.mark(function e(t){var r,n,a,u,o,c,i,p,l,f,d,y,h,m,v;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,n=void 0,a=void 0,u=void 0,o=void 0,c=void 0,i=void 0,p=void 0,l=t.date.slice(0,4),f=t.date.slice(4),d=void 0,void 0,y=void 0,void 0,p=t.banks.map(function(e){return"'"+e+"'"}).join(","),d="\n    SELECT  编号  from 水费托收查询 where 年=:year and 月=:month\n        and   托收批次<1  and 银行代码 IN ("+p+")\n    ",e.next=9,ee.query(d,{replacements:{year:l,month:f,bank:p},type:ee.QueryTypes.SELECT});case 9:return a=e.sent,i="",a.forEach(function(e){i=i+"'"+e.编号+"',"}),i=ue(i,2,se(i)-3),d="\n    SELECT max(托收批次) as a from 水费托收查询 where 年=:year and 月=:month\n    ",e.next=16,ee.query(d,{replacements:{year:l,month:f},type:ee.QueryTypes.SELECT});case 16:return a=e.sent,n=parseInt(a[0].a)+1,d="\n    SELECT  编号,业务种类,银行代码,开户行行号,开户行行名,帐号,户名,帐户地址,应收水费,组织代码,协议书号,备注  from 水费托收查询 where 年=:year and 月=:month\n        and   托收批次<1  and 银行代码 IN ("+p+")\n        order by 编号        \n    ",e.next=21,ee.query(d,{replacements:{year:l,month:f,bank:p},type:ee.QueryTypes.SELECT});case 21:if(0!==(a=e.sent).length){e.next=24;break}throw new Error("当月水费已经全部托收，请重新检查");case 24:return r=1,o="",a.forEach(function(e){o=(o=(o=(o=(o=(o=(o=o+"2"+ue("0000000",1,8-se(oe(r)))+oe(r)+"00114")+e["业务种类"].toString()+ue("            ",1,12-se(e["业务种类"].toString())))+e["银行代码"].toString()+e["开户行行号"].toString()+e["开户行行号"].toString())+e["开户行行名"].toString()+ue("                                                            ",1,60-se(e["开户行行名"].toString())))+e["帐号"].toString()+ue("                                ",1,32-se(e["帐号"].toString())))+e["户名"].toString()+ue("                                                            ",1,60-se(e["户名"].toString())))+e["帐户地址"].toString()+ue("                                                            ",1,60-se(e["帐户地址"].toString())),o+="00000001",c=parseFloat(e["应收水费"]).toFixed(2),o=(o=(o=o+ue("000000000000000",1,15-se(c))+c)+e["组织代码"].toString()+ue("          ",1,10-se(e["组织代码"].toString())))+e["编号"].toString()+ue("        ",1,8-se(e["编号"].toString())),""===e["协议书号"].toString()?o+="000000":o=o+e["协议书号"].toString()+ue("                                                            ",1,60-se(e["协议书号"].toString())),o=o+e["备注"].toString()+ue("                                                            ",1,60-se(e["备注"].toString())),o+="        00000000000000000000000000",o+="\r\n",r+=1}),h=o,d="\n    SELECT  Count(应收水费) as a ,sum(应收水费) as b   from 水费托收查询 where 年=:year and 月=:month\n        and   托收批次<1  and 银行代码 IN ("+p+")\n    ",e.next=31,ee.query(d,{replacements:{year:l,month:f,bank:p},type:ee.QueryTypes.SELECT});case 31:return a=e.sent,c=a[0].a.toString(),o=ue("00000000",1,8-se(c))+c,c=parseFloat(a[0].b).toFixed(2),o=o+ue("000000000000000",1,15-se(c))+c,c=o,d="\n    SELECT  银行代码,业务种类,开户行行号,开户行行名,帐号,户名,帐户地址,组织代码,协议书号  from 水费单位信息 where 编号='0000'\n    ",e.next=40,ee.query(d,{replacements:{year:l,month:f,bank:p},type:ee.QueryTypes.SELECT});case 40:return a=e.sent,u=a[0],o="10000000000114",o=o+(u["业务种类"]?u["业务种类"]:"")+ue("            ",1,12-se(u["业务种类"])),o=o+u["银行代码"].toString()+u["开户行行号"].toString()+u["开户行行号"].toString(),o=o+u["开户行行名"].toString()+ue("                                                            ",1,60-se(u["开户行行名"].toString())),o=o+u["帐号"].toString()+ue("                                ",1,32-se(u["帐号"].toString())),o=o+u["户名"].toString()+ue("                                                            ",1,60-se(u["户名"].toString())),o=o+u["帐户地址"].toString()+ue("                                                            ",1,60-se(u["帐户地址"].toString())),o+=c,o=o+u["组织代码"].toString()+ue("          ",1,10-se(u["组织代码"].toString())),o+=ue("        ",1,8),o+="                                                            ",o+="                                                            ",o+="        00000000000000000000000000",y="\n    update  水费托收表 Set 托收批次="+oe(n)+",托收日期=:date\n        where 年=:year and 月=:month\n        and   托收批次<1  and 编号 IN ('"+i+"') \n    ",e.next=58,ee.query(y,{replacements:{year:l,month:f,date:$(new Date,"yyyy-mm-dd")},type:ee.QueryTypes.UPDATE});case 58:return m=$(new Date,"yyyy-mm-dd"),v=ue(m,1,4)+ue(m,6,2)+ue(m,9,2),v="SBJJDR92"+v+ue("000",1,3-se(oe(n)))+oe(n)+".txt",e.abrupt("return",{data:h+o,name:v});case 62:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=(0,o.default)(s.default.mark(function e(t,r){var n,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,b(n);case 4:a=e.sent,X.ResourceFound(r,a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0,{});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),b=function(){var e=(0,o.default)(s.default.mark(function e(t){var r,n,a,u;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.date.slice(0,4),n=t.date.slice(4),a="\n    SELECT  编号,户名 from 水费托收查询 where 年=:year and 月=:month "+(t.recount?"and 托收批次<1":"")+"\n    ",e.next=5,ee.query(a,{replacements:{year:r,month:n},type:ee.QueryTypes.SELECT});case 5:return u=e.sent,e.abrupt("return",u);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=(0,o.default)(s.default.mark(function e(t,r){var n,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,T(n);case 4:a=e.sent,r.setHeader("Content-type","application/octet-stream"),r.setHeader("Content-disposition","attachment; filename="+a.name),r.charset="UTF-8",r.send(a.data),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),X.InternalServerError(r,e.t0.message,{});case 14:case"end":return e.stop()}},e,this,[[1,11]])}));return function(t,r){return e.apply(this,arguments)}}(),T=function(){var e=(0,o.default)(s.default.mark(function e(t){var r,n,a,u,o,c,i,p,l,f,d,y,h,m,v;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,n=void 0,a=void 0,u=void 0,o=void 0,c=void 0,i=void 0,p=void 0,l=t.date.slice(0,4),f=t.date.slice(4),d=void 0,void 0,y=void 0,void 0,i=t.users.map(function(e){return"'"+e+"'"}).join(","),d="\n    SELECT max(托收批次) as a from 水费托收查询 where 年=:year and 月=:month\n    ",e.next=9,ee.query(d,{replacements:{year:l,month:f},type:ee.QueryTypes.SELECT});case 9:return a=e.sent,n=parseInt(a[0].a)+1,d="\n    SELECT  编号,业务种类,银行代码,开户行行号,开户行行名,帐号,户名,帐户地址,应收水费,组织代码,协议书号,备注  from 水费托收查询 where 年=:year and 月=:month\n        and   托收批次<1  and 编号 IN ("+i+")\n        order by 编号        \n    ",e.next=14,ee.query(d,{replacements:{year:l,month:f},type:ee.QueryTypes.SELECT});case 14:if(0!==(a=e.sent).length){e.next=17;break}throw new Error("当月水费已经全部托收，请重新检查");case 17:return p="",r=1,o="",a.forEach(function(e){o=o+"2"+ue("0000000",1,8-se(oe(r)))+oe(r)+"00114",""===e["协议书号"].toString()?o+="00600       ":o=o+e["业务种类"].toString()+ue("            ",1,12-se(e["业务种类"].toString())),o=(o=(o=(o=(o=o+e["银行代码"].toString()+e["开户行行号"].toString()+e["开户行行号"].toString())+e["开户行行名"].toString()+ue("                                                            ",1,60-se(e["开户行行名"].toString())))+e["帐号"].toString()+ue("                                ",1,32-se(e["帐号"].toString())))+e["户名"].toString()+ue("                                                            ",1,60-se(e["户名"].toString())))+e["帐户地址"].toString()+ue("                                                            ",1,60-se(e["帐户地址"].toString())),o+="00000001",c=parseFloat(e["应收水费"]).toFixed(2),o=(o=(o=o+ue("000000000000000",1,15-se(c))+c)+e["组织代码"].toString()+ue("          ",1,10-se(e["组织代码"].toString())))+e["编号"].toString()+ue("        ",1,8-se(e["编号"].toString())),""===e["协议书号"].toString()?o+="000000":o=o+e["协议书号"].toString()+ue("                                                            ",1,60-se(e["协议书号"].toString())),o=o+e["备注"].toString()+ue("                                                            ",1,60-se(e["备注"].toString())),o+="        00000000000000000000000000",o+="\r\n",r+=1,p=p+"'"+e["编号"]+"',"}),p=ue(p,2,se(p)-3),h=o,d="\n    SELECT  Count(应收水费) as a ,sum(应收水费) as b   from 水费托收查询 where 年=:year and 月=:month\n        and   托收批次<1  and 编号 IN ("+i+")\n    ",e.next=26,ee.query(d,{replacements:{year:l,month:f},type:ee.QueryTypes.SELECT});case 26:return a=e.sent,c=a[0].a.toString(),o=ue("00000000",1,8-se(c))+c,c=parseFloat(a[0].b).toFixed(2),o=o+ue("000000000000000",1,15-se(c))+c,c=o,d="\n    SELECT  银行代码,业务种类,开户行行号,开户行行名,帐号,户名,帐户地址,组织代码,协议书号  from 水费单位信息 where 编号='0000'\n    ",e.next=35,ee.query(d,{replacements:{year:l,month:f},type:ee.QueryTypes.SELECT});case 35:return a=e.sent,u=a[0],o="10000000000114",o=o+(u["业务种类"]?u["业务种类"]:"")+ue("            ",1,12-se(u["业务种类"])),o=o+u["银行代码"].toString()+u["开户行行号"].toString()+u["开户行行号"].toString(),o=o+u["开户行行名"].toString()+ue("                                                            ",1,60-se(u["开户行行名"].toString())),o=o+u["帐号"].toString()+ue("                                ",1,32-se(u["帐号"].toString())),o=o+u["户名"].toString()+ue("                                                            ",1,60-se(u["户名"].toString())),o=o+u["帐户地址"].toString()+ue("                                                            ",1,60-se(u["帐户地址"].toString())),o+=c,o=o+u["组织代码"].toString()+ue("          ",1,10-se(u["组织代码"].toString())),o+=ue("        ",1,8),o+="                                                            ",o+="                                                            ",o+="        00000000000000000000000000",y="\n    update  水费托收表 Set 托收批次="+oe(n)+",托收日期=:date\n        where 年=:year and 月=:month\n        and   托收批次<1  and 编号 IN ('"+p+"') \n    ",e.next=53,ee.query(y,{replacements:{year:l,month:f,date:$(new Date,"yyyy-mm-dd")},type:ee.QueryTypes.UPDATE});case 53:return m=$(new Date,"yyyy-mm-dd"),v=ue(m,1,4)+ue(m,6,2)+ue(m,9,2),v="SBJJDR92"+v+ue("000",1,3-se(oe(n)))+oe(n)+".txt",e.abrupt("return",{data:h+o,name:v});case 57:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=(0,o.default)(s.default.mark(function e(t,r){var n,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.date,e.prev=1,e.next=4,k(n);case 4:a=e.sent,X.ResourceFound(r,a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0,{});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),k=function(){var e=(0,o.default)(s.default.mark(function e(t){var r,n,a,u;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.slice(0,4),n=t.slice(4),a="\n    SELECT  distinct 托收批次 from 水费托收查询 where 年=:year and 月=:month and 托收批次>=0\n    ",e.next=5,ee.query(a,{replacements:{year:r,month:n},type:ee.QueryTypes.SELECT});case 5:return u=e.sent,e.abrupt("return",u);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=(0,o.default)(s.default.mark(function e(t,r){var n,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,C(n);case 4:a=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(a,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),X.InternalServerError(r,e.t0.message,{});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),C=function(){var e=(0,o.default)(s.default.mark(function e(t){var r,n,a,u,o,c,i;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,void 0,n=void 0,a=void 0,u=t.date.slice(0,4),o=t.date.slice(4),t.recount=!1,c={},i="\n    SELECT  count(应收水费) as 信件数量 from 水费托收查询  where 年=:year and 月=:month "+(t.batch.length>0?"and 托收批次="+t.batch:"")+"\n    ",e.next=8,ee.query(i,{replacements:{year:u,month:o},type:ee.QueryTypes.SELECT});case 8:return r=e.sent,a=parseInt(r[0].信件数量),i="\n    SELECT  开户行行名,count(应收水费) as 信件数量 from 水费托收查询\n        where 年=:year and 月=:month "+(t.batch.length>0?"and 托收批次="+t.batch:"")+"\n        group by  开户行行名\n    ",e.next=13,ee.query(i,{replacements:{year:u,month:o},type:ee.QueryTypes.SELECT});case 13:if(0!==(r=e.sent).length){e.next=16;break}throw new Error("该月托收水费不存在,请重新选择!");case 16:return c.A2="    提出行：中国工商银行天保支行        "+$(new Date,"yyyy-mm-dd")+"          提出场次：  "+t.batch,c.D22=a.toString(),n=4,r.forEach(function(e){n<23?(c["A"+oe(n)]=e["开户行行名"],c["B"+oe(n)]=e["信件数量"],n+=1):(c["C"+oe(n-19)]=e["开户行行名"],c["D"+oe(n-19)]=e["信件数量"],n+=1)}),e.abrupt("return",re("XinFengHuiZong","Sheet1",c));case 21:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=(0,o.default)(s.default.mark(function e(t,r){var n,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,I(n);case 4:a=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(a,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),X.InternalServerError(r,e.t0.message,{});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),I=function(){var e=(0,o.default)(s.default.mark(function e(t){var r,n,o,c,i,p,l,f;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=function(){for(var e={},t=0;t<20;t++)e["Sheet"+(t+1)]={B2:"",E5:"",B16:"",E19:""};return e}(),n=void 0,void 0,o=void 0,void 0,c=t.date.slice(0,4),i=t.date.slice(4),t.recount=!1,{},p="\n    SELECT  count(distinct 开户行行名) as 银行个数 from  水费托收查询  where 年=:year and 月=:month "+(t.batch.length>0?"and 托收批次="+t.batch:"")+"\n    ",e.next=9,ee.query(p,{replacements:{year:c,month:i},type:ee.QueryTypes.SELECT});case 9:return n=e.sent,parseInt(n[0].银行个数),p="\n    SELECT  开户行行名,count(应收水费) as 信件数量 from 水费托收查询\n        where 年=:year and 月=:month "+(t.batch.length>0?"and 托收批次="+t.batch:"")+"\n        group by  开户行行名\n    ",e.next=14,ee.query(p,{replacements:{year:c,month:i},type:ee.QueryTypes.SELECT});case 14:if(0!==(n=e.sent).length){e.next=17;break}throw new Error("该月托收水费不存在,请重新选择!");case 17:for(o=2,l=0;l<n.length;)f="Sheet"+Math.floor(o/2),r[f].B2=n[l].开户行行名,r[f].E5=n[l].信件数量,o+=1,(l+=1)<n.length&&(r[f].B16=n[l].开户行行名,r[f].E19=n[l].信件数量,o+=1,l+=1);return e.abrupt("return",ne("XinFeng",(0,u.default)(r),(0,a.default)(r)));case 21:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=(0,o.default)(s.default.mark(function e(t,r){var n,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,A(n);case 4:a=e.sent,X.ResourceFound(r,a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0.message,{});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),A=function(){var e=(0,o.default)(s.default.mark(function e(t){var r,n,a,u,o,c,i,p,l,f,d,y;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.date.slice(0,4),n=t.date.slice(4),void 0,void 0,a=void 0,void 0,e.next=5,le(Z.join("./","uploadfiles",t.name));case 5:u=e.sent,o=Y.decode(u,"gbk"),o.toString().split("\n"),c=void 0,i=void 0,p=void 0,l=void 0,f=void 0,d=[],y=0;case 11:if(!(y<u.length-1)){e.next=35;break}if(10===u[y]){e.next=16;break}d.push(u[y]),e.next=32;break;case 16:if(c=ue(d,427,8),c=Y.decode(c,"gbk"),c=""!==ce(c)?ue(c,1,4)+"-"+ue(c,5,2)+"-"+ue(c,7,2):"",i=ue(d,435,8),i=ce(Y.decode(i,"gbk")),p=ue(d,443,15),p=ce(Y.decode(p,"gbk")),l=ue(d,458,3),l=ce(Y.decode(l,"gbk")),f=ue(d,299,4),!((f=ce(Y.decode(f,"gbk"))).length>0)){e.next=31;break}return a="\n                update 水费托收表 set 托收批次=:a1,回盘日期=:a2,回盘金额=:a3,处理标识代码=:a4 where 编号=:a5 and (年=:year) and (月=:month)\n                ",e.next=31,ee.query(a,{replacements:{a1:"001"!==l?0-ie(t.batch):ie(t.batch),a2:""!==ce(c)?c:"",a3:pe(p),a4:l,a5:f,year:r,month:n},type:ee.QueryTypes.UPDATE});case 31:d=[];case 32:y++,e.next=11;break;case 35:return e.abrupt("return",{});case 36:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=(0,o.default)(s.default.mark(function e(t,r){var n,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,Q(n);case 4:a=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(a,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),X.InternalServerError(r,e.t0.message,{});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),Q=function(){var e=(0,o.default)(s.default.mark(function e(t){var r,n,a,u,o,c,i;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,n=void 0,a=t.date.slice(0,4),u=t.date.slice(4),o={year:a,month:u},c="\n    SELECT  * from 水费托收查询 where 年=:year and 月=:month \n        "+(t.bank.length>0?" and 银行代码="+ue(t.bank,1,3)+" ":"")+"\n        "+(t.batch.length>0?" and ABS(托收批次)="+t.batch+" ":"")+"\n        "+("2"===t.kind?" and 托收批次 >0 ":"")+"\n        "+("3"===t.kind?" and  托收批次 <0 ":"")+"\n        order by  托收批次,开户行行号,帐号\n    ",e.next=7,ee.query(c,{replacements:{year:a,month:u},type:ee.QueryTypes.SELECT});case 7:return r=e.sent,n="",t.bank.length>0&&(n=t.bank+" - "),t.batch.length>0&&(n=n+"第"+t.batch+"批次 - "),"1"===t.kind&&(n+="全部"),"2"===t.kind&&(n+="托收成功"),"3"===t.kind&&(n+="托收失败"),o.B2=n,(i=r.length)>0&&r.push({"托收批次":"合计","户名":i+"个用户","应收水费":"=SUM(G4:G"+(i+3)+")"}),o.items=r,e.abrupt("return",re("TuoShouMingXi","Sheet1",o));case 19:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=(0,o.default)(s.default.mark(function e(t,r){var n,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.date,e.prev=1,e.next=4,N(n);case 4:a=e.sent,X.ResourceFound(r,a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0,{});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),N=function(){var e=(0,o.default)(s.default.mark(function e(t){var r,n,a,u;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.slice(0,4),n=t.slice(4),a="\n    SELECT  * from 水费托收统计 where 年=:year and 月=:month\n    ",e.next=5,ee.query(a,{replacements:{year:r,month:n},type:ee.QueryTypes.SELECT});case 5:return u=e.sent,e.abrupt("return",u);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=(0,o.default)(s.default.mark(function e(t,r){var n,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,U(n);case 4:a=e.sent,X.ResourceFound(r,a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0,{});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),U=function(){var e=(0,o.default)(s.default.mark(function e(t){var r,n,a,u,o,c,i,p,l,f,d,y;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.date.slice(0,4),n=t.date.slice(4),a=void 0,u=void 0,o=void 0,c=void 0,i=void 0,p=void 0,void 0,void 0,l=void 0,f=void 0,u="\n    delete from 水费托收统计 where 年=:year and 月=:month\n    ",e.next=7,ee.query(u,{replacements:{year:r,month:n},type:ee.QueryTypes.DELETE});case 7:return c="\n    Insert into 水费托收统计 (年,月,托收批次,托收笔数,托收金额)\n        SELECT 年,月,ABS(托收批次),COUNT(应收水费), SUM(应收水费) FROM 水费托收表 \n        WHERE (年 =:year) AND (月 = :month)  \n        GROUP BY 年,月,ABS(托收批次)     \n    ",e.next=10,ee.query(c,{replacements:{year:r,month:n},type:ee.QueryTypes.INSERT});case 10:return a="\n    SELECT  托收批次 from 水费托收统计 where 年=:year and 月=:month and 托收批次>0  order by 托收批次\n    ",e.next=13,ee.query(a,{replacements:{year:r,month:n},type:ee.QueryTypes.SELECT});case 13:i=e.sent,d=0;case 15:if(!(d<i.length)){e.next=31;break}return y=i[d],a="\n        select COUNT(应收水费) as a1, SUM(应收水费) as a2 FROM 水费托收表 WHERE (年 =:year) AND (月 = :month) \n            And 托收批次=:batch  \n        ",e.next=20,ee.query(a,{replacements:{year:r,month:n,batch:y.托收批次},type:ee.QueryTypes.SELECT});case 20:return(p=e.sent).length>0?(l=p[0].a1,f=p[0].a2):(l="0",f="0"),o="\n        update 水费托收统计 set 成功笔数="+l+",成功金额="+f+"\n            where  年=:year and 月=:month\n            and 托收批次='"+y.托收批次+"'\n        ",e.next=25,ee.query(o,{replacements:{year:r,month:n},type:ee.QueryTypes.UPDATE});case 25:return o="\n        update 水费托收统计 set 失败笔数=托收笔数-成功笔数,失败金额=托收金额-成功金额\n            where  年=:year and 月=:month\n            and 托收批次='"+y.托收批次+"'\n        ",e.next=28,ee.query(o,{replacements:{year:r,month:n},type:ee.QueryTypes.UPDATE});case 28:d++,e.next=15;break;case 31:return e.next=33,N(t.date);case 33:return e.abrupt("return",e.sent);case 34:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=(0,o.default)(s.default.mark(function e(t,r){var n,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,M(n);case 4:a=e.sent,r.writeHead(200,[["Content-Type","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]]),r.end(new Buffer(a,"base64")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),X.InternalServerError(r,e.t0.message,{});case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,r){return e.apply(this,arguments)}}(),M=function(){var e=(0,o.default)(s.default.mark(function e(t){var r,n,a,u,o;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,n=t.date.slice(0,4),a=t.date.slice(4),u={year:n,month:a,date:$(new Date,"yyyy-mm-dd")},e.next=6,N(t.date);case 6:return r=e.sent,(o=r.length)>0&&r.push({"托收批次":"合计","托收笔数":"=SUM(B4:B"+(o+3)+")","托收金额":"=SUM(C4:C"+(o+3)+")","成功笔数":"=SUM(D4:D"+(o+3)+")","成功金额":"=SUM(E4:E"+(o+3)+")","失败笔数":"=SUM(F4:F"+(o+3)+")","失败金额":"=SUM(G4:G"+(o+3)+")"}),u.items=r,e.abrupt("return",re("TuoShouTongJi","Sheet1",u));case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=(0,o.default)(s.default.mark(function e(t,r){var n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P();case 3:n=e.sent,X.ResourceFound(r,n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),X.InternalServerError(r,e.t0,{});case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(t,r){return e.apply(this,arguments)}}(),P=function(){var e=(0,o.default)(s.default.mark(function e(){var t,r;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="\n    Select *  from 水费字典银行查询 order by 开户行行号\n    ",e.next=3,ee.query(t,{replacements:{},type:ee.QueryTypes.SELECT});case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),B=function(){var e=(0,o.default)(s.default.mark(function e(t,r){var n,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,H(n);case 4:a=e.sent,X.ResourceFound(r,a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0,{});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),H=function(){var e=(0,o.default)(s.default.mark(function e(t){var r,n,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="\n    insert into 水费字典银行代码 (开户行行号,开户行行名,银行代码,使用次数,是否验证,帐号位数,帐号相同位数,帐号相同代码,帐号相同代码1,业务种类 ) \n        values( :a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8,:a9,:a10)\n    ",n={a1:t.开户行行号,a2:t.开户行行名,a3:ue(t.开户行行号,1,3),a4:0},t.验证?(n.a5="Y",n.a6=t.帐号位数,n.a7=t.帐号相同位数):(n.a5="N",n.a6=0,n.a7=0),n.a8=t.账号相同代码,n.a9=t.账号相同代码1,n.a10=t.业务种类,e.next=8,ee.query(r,{replacements:n,type:ee.QueryTypes.INSERT});case 8:return a=e.sent,e.abrupt("return",a);case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=(0,o.default)(s.default.mark(function e(t,r){var n,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.num,e.prev=1,e.next=4,W(n);case 4:a=e.sent,X.ResourceFound(r,a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0,{});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),W=function(){var e=(0,o.default)(s.default.mark(function e(t){var r,n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="\n    delete from 水费字典银行代码 where 开户行行号=:num\n    ",e.next=3,ee.query(r,{replacements:{num:t},type:ee.QueryTypes.DELETE});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=(0,o.default)(s.default.mark(function e(t,r){var n,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,z(n);case 4:a=e.sent,X.ResourceFound(r,a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),X.InternalServerError(r,e.t0,{});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),z=function(){var e=(0,o.default)(s.default.mark(function e(t){var r,n,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="\n    Update 水费字典银行代码 set 开户行行名=:a2,银行代码=:a3,是否验证=:a5,帐号位数=:a6,帐号相同位数=:a7,帐号相同代码=:a8,帐号相同代码1=:a9,业务种类=:a10 where 开户行行号=:a1\n    ",n={a1:t.开户行行号,a2:t.开户行行名,a3:ue(t.开户行行号,1,3)},t.验证?(n.a5="Y",n.a6=t.帐号位数,n.a7=t.帐号相同位数):(n.a5="N",n.a6=0,n.a7=0),n.a8=t.帐号相同代码,n.a9=t.帐号相同代码1,n.a10=t.业务种类,e.next=8,ee.query(r,{replacements:n,type:ee.QueryTypes.UPDATE});case 8:return a=e.sent,e.abrupt("return",a);case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),K=(r(176),r(28)),V=r(177),Z=r(9),Y=r(178),$=r(12),X=r(1),ee=r(7),te=r(29),re=te.toExcel,ne=te.toExcelMultiSheets,ae=r(179),ue=ae.copy,se=ae.length,oe=ae.inttostr,ce=ae.trim,ie=ae.strtoint,pe=ae.strtoFloat,le=V.promisify(K.readFile);e.exports.queryAllBank=c,e.exports.queryCollection=p,e.exports.queryCollectionTable=f,e.exports.createCollection=y,e.exports.CollectionToExcel=m,e.exports.SaveToBankOfferTxt=x,e.exports.queryUser=E,e.exports.SaveToUserOfferTxt=S,e.exports.queryBatch=g,e.exports.XinFengHuiZongToExcel=F,e.exports.XinFengToExcel=q,e.exports.inputDisk=L,e.exports.OutputDetailToExcel=R,e.exports.queryCollectionCount=_,e.exports.createCollectionCount=D,e.exports.OutputCountToExcel=O,e.exports.queryBank=j,e.exports.createBank=B,e.exports.deleteBank=G,e.exports.updateBank=J},function(e,t,r){e.exports={default:r(173),__esModule:!0}},function(e,t,r){r(174),e.exports=r(2).Object.values},function(e,t,r){var n=r(10),a=r(175)(!1);n(n.S,"Object",{values:function(e){return a(e)}})},function(e,t,r){var n=r(24),a=r(25),u=r(65).f;e.exports=function(e){return function(t){for(var r,s=a(t),o=n(s),c=o.length,i=0,p=[];c>i;)u.call(s,r=o[i++])&&p.push(e?[r,s[r]]:s[r]);return p}}},function(e,t){e.exports=require("os")},function(e,t){e.exports=require("util")},function(e,t){e.exports=require("iconv-lite")},function(e,t,r){"use strict";e.exports.copy=function(e,t,r){return e.slice(t-1,t+r-1)};e.exports.length=function(e){return e?function(e){for(var t=0,r=e.length,n=-1,a=0;a<r;a++)t+=(n=e.charCodeAt(a))>=0&&n<=128?1:2;return t}(e):0},e.exports.inttostr=function(e){return e.toString()},e.exports.strtoint=function(e){return parseInt(e)},e.exports.strtoFloat=function(e){return isNaN(e)?"0":parseFloat(e)},e.exports.trim=function(e){return e.trim()}},function(e,t,r){"use strict";var n=r(0).Router(),a=r(9),u=r(181),s=r(1);n.post("/",function(e,t,r){var n=new u.IncomingForm;n.uploadDir=a.join("./","uploadfiles"),n.keepExtensions=!0,n.parse(e,function(e,n,a){e&&r(e);var u=a.file.path.split("\\")[1];s.ResourceFound(t,{name:u})})}),e.exports=n},function(e,t){e.exports=require("formidable")},function(e,t,r){"use strict";var n=r(0).Router(),a=r(183),u=a.queryUseKind,s=a.createUpdateUseKind,o=a.deleteUseKind,c=a.queryChargeKind,i=a.createUpdateChargeKind,p=a.deleteChargeKind,l=a.queryInputKind,f=a.createUpdateInputKind,d=a.deleteInputKind,y=a.queryChargeStandard,h=a.createUpdateChargeStandard,m=a.deleteChargeStandard,v=a.queryFireStandard,x=a.createUpdateFireStandard,w=a.deleteFireStandard;n.get("/usekind",u),n.put("/usekind",s),n.delete("/usekind/:num",o),n.post("/usekind",s),n.get("/chargekind",c),n.put("/chargekind",i),n.delete("/chargekind/:num",p),n.post("/chargekind",i),n.get("/inputkind",l),n.put("/inputkind",f),n.delete("/inputkind/:num",d),n.post("/inputkind",f),n.get("/chargestandard",y),n.put("/chargestandard",h),n.delete("/chargestandard/:num",m),n.post("/chargestandard",h),n.get("/firestandard",v),n.put("/firestandard",x),n.delete("/firestandard/:num",w),n.post("/firestandard",x),e.exports=n},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=n(r(5)),u=n(r(6)),s=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o();case 3:n=e.sent,D.ResourceFound(r,n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),D.InternalServerError(r,e.t0,{});case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(t,r){return e.apply(this,arguments)}}(),o=function(){var e=(0,u.default)(a.default.mark(function e(){var t,r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="\n    Select * from 水费字典用水形式 order by 用水形式编号\n    ",e.next=3,U.query(t,{replacements:{},type:U.QueryTypes.SELECT});case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),c=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,i(n);case 4:u=e.sent,D.ResourceFound(r,u),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),D.InternalServerError(r,e.t0,{});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),i=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n,u,s,o,c;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,n=void 0,u="\n    Select *  from 水费字典用水形式   where 用水形式编号 =:num\n    ",e.next=4,U.query(u,{replacements:{num:t.用水形式编号},type:U.QueryTypes.SELECT});case 4:if(r=e.sent,s={a1:t.用水形式编号,a2:t.用水形式},0!==r.length){e.next=13;break}return o="\n        insert into 水费字典用水形式 (用水形式编号,用水形式) values(:a1,:a2)\n        ",e.next=10,U.query(o,{replacements:s,type:U.QueryTypes.INSERT});case 10:n=e.sent,e.next=17;break;case 13:return c="\n        Update 水费字典用水形式 set 用水形式=:a2 where 用水形式编号=:a1 \n        ",e.next=16,U.query(c,{replacements:s,type:U.QueryTypes.UPDATE});case 16:n=e.sent;case 17:return e.abrupt("return",n);case 18:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.num,e.prev=1,e.next=4,l(n);case 4:u=e.sent,D.ResourceFound(r,u),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),D.InternalServerError(r,e.t0,{});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),l=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="\n    delete from 水费字典用水形式 where 用水形式编号=:num\n    ",e.next=3,U.query(r,{replacements:{num:t},type:U.QueryTypes.DELETE});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d();case 3:n=e.sent,D.ResourceFound(r,n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),D.InternalServerError(r,e.t0,{});case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(t,r){return e.apply(this,arguments)}}(),d=function(){var e=(0,u.default)(a.default.mark(function e(){var t,r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="\n    Select * from 水费字典收费形式 order by 收费形式编号\n    ",e.next=3,U.query(t,{replacements:{},type:U.QueryTypes.SELECT});case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),y=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,h(n);case 4:u=e.sent,D.ResourceFound(r,u),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),D.InternalServerError(r,e.t0,{});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),h=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n,u,s,o,c;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,n=void 0,u="\n    Select *  from 水费字典收费形式   where 收费形式编号 =:num\n    ",e.next=4,U.query(u,{replacements:{num:t.收费形式编号},type:U.QueryTypes.SELECT});case 4:if(r=e.sent,s={a1:t.收费形式编号,a2:t.收费形式},0!==r.length){e.next=13;break}return o="\n        insert into 水费字典收费形式 (收费形式编号,收费形式) values(:a1,:a2)\n        ",e.next=10,U.query(o,{replacements:s,type:U.QueryTypes.INSERT});case 10:n=e.sent,e.next=17;break;case 13:return c="\n        Update 水费字典收费形式 set 收费形式=:a2 where 收费形式编号=:a1\n        ",e.next=16,U.query(c,{replacements:s,type:U.QueryTypes.UPDATE});case 16:n=e.sent;case 17:return e.abrupt("return",n);case 18:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.num,e.prev=1,e.next=4,v(n);case 4:u=e.sent,D.ResourceFound(r,u),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),D.InternalServerError(r,e.t0,{});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),v=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="\n    delete from 水费字典收费形式 where 收费形式编号=:num\n    ",e.next=3,U.query(r,{replacements:{num:t},type:U.QueryTypes.DELETE});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w();case 3:n=e.sent,D.ResourceFound(r,n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),D.InternalServerError(r,e.t0,{});case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(t,r){return e.apply(this,arguments)}}(),w=function(){var e=(0,u.default)(a.default.mark(function e(){var t,r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="\n    Select * from 水费字典抄表形式 order by 抄表形式编号\n    ",e.next=3,U.query(t,{replacements:{},type:U.QueryTypes.SELECT});case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),E=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,b(n);case 4:u=e.sent,D.ResourceFound(r,u),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),D.InternalServerError(r,e.t0,{});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),b=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n,u,s,o,c;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,n=void 0,u="\n    Select *  from 水费字典抄表形式   where 抄表形式编号  =:num\n    ",e.next=4,U.query(u,{replacements:{num:t.抄表形式编号},type:U.QueryTypes.SELECT});case 4:if(r=e.sent,s={a1:t.抄表形式编号,a2:t.抄表形式},0!==r.length){e.next=13;break}return o="\n        insert into 水费字典抄表形式 (抄表形式编号,抄表形式) values(:a1,:a2)\n        ",e.next=10,U.query(o,{replacements:s,type:U.QueryTypes.INSERT});case 10:n=e.sent,e.next=17;break;case 13:return c="\n        Update 水费字典抄表形式 set 抄表形式=:a2 where 抄表形式编号=:a1 \n        ",e.next=16,U.query(c,{replacements:s,type:U.QueryTypes.UPDATE});case 16:n=e.sent;case 17:return e.abrupt("return",n);case 18:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.num,e.prev=1,e.next=4,T(n);case 4:u=e.sent,D.ResourceFound(r,u),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),D.InternalServerError(r,e.t0,{});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),T=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="\n    delete from 水费字典抄表形式 where 抄表形式编号=:num\n    ",e.next=3,U.query(r,{replacements:{num:t},type:U.QueryTypes.DELETE});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k();case 3:n=e.sent,D.ResourceFound(r,n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),D.InternalServerError(r,e.t0,{});case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(t,r){return e.apply(this,arguments)}}(),k=function(){var e=(0,u.default)(a.default.mark(function e(){var t,r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="\n    Select * from 水费字典费用标准 order by 区号\n    ",e.next=3,U.query(t,{replacements:{},type:U.QueryTypes.SELECT});case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),F=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,C(n);case 4:u=e.sent,D.ResourceFound(r,u),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),D.InternalServerError(r,e.t0,{});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),C=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n,u,s,o,c;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,n=void 0,u="\n    Select *  from 水费字典费用标准   where 区号 =:num\n    ",e.next=4,U.query(u,{replacements:{num:t.区号},type:U.QueryTypes.SELECT});case 4:if(r=e.sent,s={a1:t.区号,a2:t.单位类别,a3:t.单价,a4:t.超计划,a5:t.排污费单价,a6:t.排污费超额},0!==r.length){e.next=13;break}return o="\n        insert into 水费字典费用标准 (区号,单位类别,单价,超计划,排污费单价,排污费超额) values(:a1,:a2,:a3,:a4,:a5,:a6)\n        ",e.next=10,U.query(o,{replacements:s,type:U.QueryTypes.INSERT});case 10:n=e.sent,e.next=17;break;case 13:return c="\n        Update 水费字典费用标准 set 单位类别=:a2,单价=:a3,超计划=:a4,排污费单价=:a5,排污费超额=:a6 where 区号=:a1 \n        ",e.next=16,U.query(c,{replacements:s,type:U.QueryTypes.UPDATE});case 16:n=e.sent;case 17:return e.abrupt("return",n);case 18:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.num,e.prev=1,e.next=4,I(n);case 4:u=e.sent,D.ResourceFound(r,u),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),D.InternalServerError(r,e.t0,{});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),I=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="\n    delete from 水费字典费用标准 where 区号=:num\n    ",e.next=3,U.query(r,{replacements:{num:t},type:U.QueryTypes.DELETE});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A();case 3:n=e.sent,D.ResourceFound(r,n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),D.InternalServerError(r,e.t0,{});case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(t,r){return e.apply(this,arguments)}}(),A=function(){var e=(0,u.default)(a.default.mark(function e(){var t,r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="\n    Select * from 水费字典防火标准 order by 防火标准编号\n    ",e.next=3,U.query(t,{replacements:{},type:U.QueryTypes.SELECT});case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),R=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body||{},e.prev=1,e.next=4,Q(n);case 4:u=e.sent,D.ResourceFound(r,u),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),D.InternalServerError(r,e.t0,{});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),Q=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n,u,s,o,c;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,n=void 0,u="\n    Select *  from 水费字典防火标准   where 防火标准编号 =:num\n    ",e.next=4,U.query(u,{replacements:{num:t.防火标准编号},type:U.QueryTypes.SELECT});case 4:if(r=e.sent,s={a1:t.防火标准编号,a2:t.管径,a3:t.防火费},0!==r.length){e.next=13;break}return o="\n        insert into 水费字典防火标准 (防火标准编号,管径,防火费) values(:a1,:a2,:a3)\n        ",e.next=10,U.query(o,{replacements:s,type:U.QueryTypes.INSERT});case 10:n=e.sent,e.next=17;break;case 13:return c="\n        Update 水费字典防火标准 set 管径=:a2,防火费=:a3 where 防火标准编号=:a1\n        ",e.next=16,U.query(c,{replacements:s,type:U.QueryTypes.UPDATE});case 16:n=e.sent;case 17:return e.abrupt("return",n);case 18:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=(0,u.default)(a.default.mark(function e(t,r){var n,u;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.num,e.prev=1,e.next=4,N(n);case 4:u=e.sent,D.ResourceFound(r,u),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),D.InternalServerError(r,e.t0,{});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,r){return e.apply(this,arguments)}}(),N=function(){var e=(0,u.default)(a.default.mark(function e(t){var r,n;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="\n    delete from 水费字典防火标准 where 防火标准编号=:num\n    ",e.next=3,U.query(r,{replacements:{num:t},type:U.QueryTypes.DELETE});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),D=(r(12),r(1)),U=r(7);e.exports.queryUseKind=s,e.exports.createUpdateUseKind=c,e.exports.deleteUseKind=p,e.exports.queryChargeKind=f,e.exports.createUpdateChargeKind=y,e.exports.deleteChargeKind=m,e.exports.queryInputKind=x,e.exports.createUpdateInputKind=E,e.exports.deleteInputKind=S,e.exports.queryChargeStandard=g,e.exports.createUpdateChargeStandard=F,e.exports.deleteChargeStandard=q,e.exports.queryFireStandard=L,e.exports.createUpdateFireStandard=R,e.exports.deleteFireStandard=_}]);