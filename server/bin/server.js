!function(e){function t(r){if(n[r])return n[r].exports;var s=n[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=17)}([function(e,t){e.exports=require("webpack")},function(e,t){e.exports=require("express")},function(e,t,n){"use strict";e.exports.InternalServerError=function(e,t,n){var r={error:{code:"bf-500",message:t,context:n}};e.status(500),e.setHeader("Content-Type","application/json"),e.send(r)},e.exports.BadRequest=function(e,t,n){var r={error:{code:"bf-400",message:t,context:n}};e.status(400),e.setHeader("Content-Type","application/json"),e.send(r)},e.exports.ResourceNotFound=function(e,t,n){var r={error:{code:"bf-404",message:n||"Not Found",context:t}};e.status(404),e.setHeader("Content-Type","application/json"),e.send(r)},e.exports.ResourceDeleted=function(e){e.status(204),e.end()},e.exports.ResourceCreated=function(e,t){e.status(201),e.setHeader("Content-Type","application/json"),t?e.send(t):e.send({data:"Created"})},e.exports.ResourceUpdated=function(e,t){e.status(201),e.setHeader("Content-Type","application/json"),t?e.send(t):e.send({data:"Updated"})},e.exports.ResourceFound=function(e,t){var n=t;e.status(200),e.setHeader("Content-Type","application/json"),e.send(n)},e.exports.NotAuthorized=function(e,t){var n={error:{code:"bf-401",message:"Not Authorized",context:{url:e.url}}};t.status(401).send(n)}},function(e,t){e.exports=require("webpack-merge")},function(e,t){e.exports=require("sequelize")},function(e,t,n){"use strict";(function(t){var r=n(6),s={root:r.join(t,"../../"),app:r.join(t,"../../app"),build:r.join(t,"../../build"),style:r.join(t,"../../app/styles/index.less"),antStyle:r.join(t,"../../node_modules/antd/dist/antd.css"),test:r.join(t,"../../tests"),node_modules:r.join(t,"../../node_modules")};e.exports=s}).call(t,"/")},function(e,t){e.exports=require("path")},function(e,t,n){"use strict";var r=n(4),s=n(24),o=n(25).define("user",{ID:{type:r.INTEGER,autoIncrement:!0,primaryKey:!0},name:{type:r.STRING},password:{type:r.STRING},truename:{type:r.STRING}},{timestamps:!1,tableName:"UserEntity"});o.prototype.checkPassword=function(e,t){s.compare(e,this.password,function(e,n){t(e,n)})},o.prototype.initAdminUser=function(e,t,n){o.findAll({where:{name:"admin1"}}).then(function(e){0===e.length?function(e,t){s.genSalt(10,function(n,r){n||s.hash(e,r,null,function(e,n){e||t(n)})})}("123456",function(e){o.build({name:"admin1",password:e}).save().then(function(e){console.log("Creating Admin user")}).catch(function(e){console.log(e)})}):console.log("Admin user already exist")}).catch(function(e){console.log(e)})},e.exports=o},function(e,t,n){"use strict";function r(){return c.base32String(p)}function s(e,t){var n=r(),s=r(),i={access_token:n,token_type:"Bearer",expires_in:l,refresh_token:s};!function(e,t){var n=a.clone(e);n.username=t,d[n.access_token]=n,f[n.refresh_token]=n,setTimeout(function(){o(n.access_token)},1e3*l)}(i),t(i)}function o(e){delete d[e]}var a=n(23),i=n(2),u=n(7),c=n(26),l=3600,p=20,d={},f={};e.exports={logout:function(e,t){var n=(e.headers.authorization||"").split(" "),r=(n[0],n[1]);console.log("validtokens",d),console.log("token",r),o(r),i.ResourceFound(t,a.extend({status:"offline",desc:"1"},r))},authenticate:function(e,t){!function(e,t,n){var r=e.grant_type,o=e.username,c=e.password;"password"!==r?i.BadRequest(n,"用户名或者密码错误",{username:o}):o&&c?u.findAll({where:{name:o}}).then(function(e){if(1===e.length){var t=e[0];console.log("user.password",t.password),t.checkPassword(c,function(e,r){console.log(e,r),r?s(0,function(e){i.ResourceFound(n,a.extend({status:"online",desc:"0",user:t},e))}):i.ResourceNotFound(n,{username:o},"密码错误")})}else i.ResourceNotFound(n,{username:o},"用户名不存在")}):i.BadRequest(n,"用户名或者密码错误",{username:o})}(e.body||{},0,t)},authorizationRequired:function(e,t,n){var r=e.headers.authorization||"";if(!r)return i.NotAuthorized(e,t);var s=r.split(" "),o=s[0],u=s[1];if(!o||"Bearer"!==o||!u)return i.NotAuthorized(e,t);!function(e,t){a.has(d,e)?t({valid:!0,token:d[e]}):t({valid:!1,token:null})}(u,function(r){if(!r.valid)return i.NotAuthorized(e,t);n()})}}},function(e,t,n){"use strict";e.exports=function(e){return{module:{rules:[{test:/\.(js|jsx)$/,loaders:["babel-loader"],include:e}]}}}},function(e,t){e.exports=require("babel-runtime/core-js/json/stringify")},function(e,t,n){"use strict";e.exports=function(e){return{module:{rules:[{test:/\.(css)$/,loaders:["style-loader","css-loader"]}]}}}},function(e,t,n){"use strict";e.exports=function(e){return{module:{rules:[{test:/\.less$/,include:e,loaders:["style-loader","css-loader","less-loader"]}]}}}},function(e,t,n){"use strict";var r=n(42);e.exports=function(e,t){return{plugins:[new r([{context:e,from:"**/*",to:t}])]}}},function(e,t){e.exports=require("extract-text-webpack-plugin")},function(e,t){e.exports=require("clean-webpack-plugin")},function(e,t){e.exports={name:"kanban_app",version:"1.0.0",description:"",main:"index.js",repository:{type:"git",url:"https://github.com/htzguoguo/kanban.git"},scripts:{stats:"webpack --profile --json > stats.json",test:"karma start","build:client":"webpack --config webpack/client.webpack.config.js --progress","build:server":"cross-env NODE_ENV=production webpack --config webpack/server.webpack.config.js --progress",start:"nodemon server/app.js",pru:"set NODE_ENV=production&& pm2 start app.js --name csgs_admin",deploy:"gh-pages -d build",tdd:"karma start --auto-watch --no-single-run",flow:"flow check",lint:"eslint ./app ./tests --ext .js --ext .jsx","lint:style":"stylelint app/**/*.css"},keywords:[],author:"",license:"ISC",devDependencies:{alt:"^0.18.6","alt-container":"^1.1.1","alt-utils":"^2.0.0",antd:"^3.0.0","axios-mock-adapter":"^1.10.0","babel-core":"^6.26.0","babel-eslint":"^8.0.3","babel-loader":"^7.1.2","babel-plugin-import":"^1.6.2","babel-plugin-syntax-decorators":"^6.13.0","babel-plugin-syntax-dynamic-import":"^6.18.0","babel-plugin-transform-class-properties":"^6.24.1","babel-plugin-transform-decorators-legacy":"^1.3.4","babel-plugin-transform-object-rest-spread":"^6.26.0","babel-plugin-transform-runtime":"^6.23.0","babel-preset-env":"^1.6.1","babel-preset-es2015":"^6.24.1","babel-preset-flow":"^6.23.0","babel-preset-latest":"^6.24.1","babel-preset-react":"^6.24.1","babel-preset-react-hmre":"^1.1.1","bcrypt-nodejs":"0.0.3","body-parser":"^1.18.2","clean-webpack-plugin":"^0.1.17","cookie-parser":"^1.4.3","copy-webpack-plugin":"^4.3.0","crispy-string":"0.0.2","cross-env":"^5.1.3","css-loader":"^0.28.7",cssnano:"^3.10.0","es6-shim":"^0.35.3",eslint:"^4.12.1","eslint-loader":"^1.9.0","eslint-plugin-react":"^7.5.1",express:"^4.16.2","express-cache-control":"^1.0.2","express-session":"^1.15.6","extract-text-webpack-plugin":"^3.0.2","file-loader":"^1.1.5","flow-bin":"^0.60.1","gh-pages":"^1.1.0","html-webpack-plugin":"^2.30.1","html-webpack-template":"^6.1.0","isparta-instrumenter-loader":"^1.0.1","isparta-loader":"^2.0.0",jscs:"^3.0.7","jscs-loader":"^0.3.0",karma:"^1.7.1","karma-chrome-launcher":"^2.2.0","karma-coverage":"^1.1.1","karma-mocha":"^1.3.0","karma-phantomjs-launcher":"^1.0.4","karma-sourcemap-loader":"^0.3.7","karma-spec-reporter":"0.0.31","karma-webpack":"^2.0.6",less:"^2.7.3","less-loader":"^4.0.5",lodash:"^4.17.4",mocha:"^4.0.1","node-uuid":"^1.4.8","npm-install-webpack-plugin":"^4.0.5","optimize-css-assets-webpack-plugin":"^3.2.0","phantomjs-polyfill":"0.0.2","phantomjs-prebuilt":"^2.1.16","postcss-loader":"^2.0.9","prop-types":"^15.6.0","react-addons-test-utils":"^15.6.2","react-addons-update":"^15.6.2","react-dnd":"^2.5.4","react-dnd-html5-backend":"^2.5.4","react-dnd-test-backend":"^2.5.4","react-hot-loader":"^3.1.3","redux-devtools":"^3.4.1","redux-devtools-dock-monitor":"^1.1.2","redux-devtools-log-monitor":"^1.4.0",sequelize:"^4.28.6","style-loader":"^0.19.0",stylelint:"^8.3.1","stylelint-config-recommended":"^2.0.0",tedious:"^2.1.5","uglifyjs-webpack-plugin":"^1.1.5",underscore:"^1.8.3","url-loader":"^0.6.2",uuid:"^3.1.0",webpack:"^3.8.1","webpack-dev-middleware":"^2.0.3","webpack-dev-server":"^2.9.4","webpack-hot-middleware":"^2.21.0","webpack-merge":"^4.1.1","webpack-node-externals":"^1.6.0"},dependencies:{axios:"^0.17.1",react:"^16.1.1","react-dom":"^16.1.1","react-intl":"^2.4.0","react-redux":"^5.0.6","react-router":"^4.2.0","react-router-dom":"^4.2.2",redux:"^3.7.2","redux-thunk":"^2.2.0"},bundledDependencies:["cross-env","express"]}},function(e,t,n){e.exports=n(18)},function(e,t,n){"use strict";var r=n(1),s=(n(6),n(19)),o=n(20),a=n(21),i=(new(n(22))).middleware,u=n(8),c=n(7),l=n(27),p=n(55),d=n(56),f=r(),m=Object({NODE_ENV:"production"}).PORT||8180,g=new c;f.use(a.json()),f.use(a.urlencoded({extended:!1})),f.use(o("login")),f.use(s({secret:"TKRv0IJs=HYqrvagQ#&!F!%V]Ww/4KiVs$s,<<MX",resave:!0,saveUninitialized:!0,cookie:{maxAge:3e5}})),l(f),f.use("/auth",i("minutes",2),p),f.use("/api/v1",u.authorizationRequired,d),g.initAdminUser(),e.exports=f,f.listen(m)},function(e,t){e.exports=require("express-session")},function(e,t){e.exports=require("cookie-parser")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("express-cache-control")},function(e,t){e.exports=require("underscore")},function(e,t){e.exports=require("bcrypt-nodejs")},function(e,t,n){"use strict";var r=new(n(4))("SUP_SYS_Expressway_Usermanagement2011_20111102-G","sa","ghjsj",{host:"61.136.61.40",dialect:"mssql",dialectOptions:{options:{tdsVersion:"7_3_A"}},pool:{max:5,min:0,acquire:3e4,idle:1e4}});e.exports=r},function(e,t){e.exports=require("crispy-string")},function(e,t,n){"use strict";(function(t){var r=n(6),s=n(1);e.exports=function(e){var n=r.join(t,"../../build");e.use(s.static(n)),e.get("/",function(e,n){n.sendFile(r.join(t,"../../build/index.html"))})}}).call(t,"/")},function(e,t){e.exports=require("webpack-dev-middleware")},function(e,t){e.exports=require("webpack-hot-middleware")},function(e,t,n){"use strict";n(0);var r=n(3),s=n(31),o=n(37),a=n(43),i=n(53),u=Object({NODE_ENV:"production"}).npm_lifecycle_event;if(Object({NODE_ENV:"production"}).BABEL_ENV=u,console.log("TARGET",u),"start"!==u&&u||(e.exports=r(s,o)),"build:client"!==u&&"stats"!==u||(e.exports=r(s,a)),"test"===u||"tdd"===u){var c=r(s,i);c.entry=null,e.exports=c}},function(e,t,n){"use strict";n(0);var r=n(3),s=n(5),o=n(32),a=n(9),i=(n(34),n(35),r({resolve:{extensions:[".js",".jsx"]},output:{path:s.build,filename:"[name].[hash].js",chunkFilename:"[hash].js"}},o({title:"长深高速公路养护系统",appMountId:"root"}),a(s.app)));e.exports=i},function(e,t,n){"use strict";var r=n(33);e.exports=function(e){return{plugins:[new r({template:"node_modules/html-webpack-template/index.ejs",title:e.title,appMountId:e.appMountId,inject:!1})]}}},function(e,t){e.exports=require("html-webpack-plugin")},function(e,t,n){"use strict";e.exports=function(e){return{module:{rules:[{test:/\.(js|jsx)$/,loaders:["eslint-loader"],enforce:"pre",include:e}]}}}},function(e,t,n){"use strict";e.exports=function(e){return{module:{rules:[{test:/\.css$/,loader:"postcss-loader",enforce:"pre",include:e,options:{plugins:function(){return[n(36)({ignoreFiles:"node_modules/!**!/!*.css"})]}}}]}}}},function(e,t){e.exports=require("stylelint")},function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{default:e}}(n(10)),s=n(0),o=n(3),a=n(5),i=n(11),u=n(12),c=n(38),l=n(40),p=n(41),d=n(13),f=o({devtool:"eval-source-map",entry:["webpack-hot-middleware/client?reload=true",a.app+"/index.jsx"],plugins:[new s.optimize.OccurrenceOrderPlugin,new s.HotModuleReplacementPlugin,new s.NoErrorsPlugin,new s.DefinePlugin({"process.env.NODE_ENV":(0,r.default)("development")})]},i(a.app),u(a.app),l(),p(),c({save:!0}),d(a.app+"/assets",a.build+"/assets"));e.exports=f},function(e,t,n){"use strict";var r=n(39);e.exports=function(e){return e=e||{},{plugins:[new r(e)]}}},function(e,t){e.exports=require("npm-install-webpack-plugin")},function(e,t,n){"use strict";e.exports=function(){return{module:{rules:[{test:/\.(woff|woff2|eot|ttf|otf)$/,use:["url-loader"]}]}}}},function(e,t,n){"use strict";e.exports=function(){return{module:{rules:[{test:/\.(png|svg|jpg|gif)$/,use:["url-loader"]}]}}}},function(e,t){e.exports=require("copy-webpack-plugin")},function(e,t,n){"use strict";n(0);var r=n(3),s=(n(14),n(15),n(16),n(5)),o=n(44),a=n(45),i=n(47),u=n(48),c=n(49),l=n(13),p=n(50),d=r({entry:{app:s.app+"/index.jsx",style:s.style}},i(s.build),u("process.env.NODE_ENV","production"),a(),c(),o(s.app),l(s.app+"/assets",s.build+"/assets"),p({options:{discardComments:{removeAll:!0},safe:!0}}));e.exports=d},function(e,t,n){"use strict";var r=n(14);e.exports=function(e){return{module:{rules:[{test:/\.css$/,use:r.extract({fallback:"style-loader",use:["css-loader"]})},{test:/\.less$/,use:r.extract({fallback:"style-loader",use:["css-loader","less-loader"]}),include:e},{test:/\.(png|jpg)$/,loader:"url-loader?name=assets/images/[name].[ext]&limit=8192"}]},plugins:[new r("[name].[hash].css")]}}},function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{default:e}}(n(46)),s=n(0),o=n(16);e.exports=function(e){return{entry:{vendor:(0,r.default)(o.dependencies).filter(function(e){return"alt-utils"!==e})},plugins:[new s.optimize.CommonsChunkPlugin({names:["vendor","manifest"]})]}}},function(e,t){e.exports=require("babel-runtime/core-js/object/keys")},function(e,t,n){"use strict";var r=n(15);e.exports=function(e){return{plugins:[new r([e],{root:process.cwd()})]}}},function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{default:e}}(n(10)),s=n(0);e.exports=function(e,t){var n={};return n[e]=(0,r.default)(t),{plugins:[new s.DefinePlugin(n)]}}},function(e,t,n){"use strict";var r=n(0);e.exports=function(){return{plugins:[new r.optimize.UglifyJsPlugin({compress:{warnings:!1},mangle:!0,comments:!1})]}}},function(e,t,n){"use strict";var r=n(51),s=n(52);e.exports=function(e){var t=e.options;return{plugins:[new r({cssProcessor:s,cssProcessorOptions:t,canPrint:!1})]}}},function(e,t){e.exports=require("optimize-css-assets-webpack-plugin")},function(e,t){e.exports=require("cssnano")},function(e,t,n){"use strict";n(0);var r=n(3),s=n(5),o=n(54),a=n(11),i=(n(9),n(12)),u=r({entry:{app:s.app+"/index.jsx",style:s.style},devtool:"inline-source-map"},o(s.app),a(s.app),i(s.app));e.exports=u},function(e,t,n){"use strict";e.exports=function(e){return{module:{rules:[{test:/\.(js|jsx)$/,loaders:["isparta-instrumenter-loader"],enforce:"pre",include:e}]}}}},function(e,t,n){"use strict";var r=n(1).Router(),s=n(8);r.post("/",s.authenticate),r.delete("/",s.logout),e.exports=r},function(e,t,n){"use strict";var r=n(1).Router(),s=n(57),o=n(58),a=n(60);r.use("/users",s),r.use("/menu",o),r.use("/workitems",a),e.exports=r},function(e,t,n){"use strict";var r=n(2),s=n(1),o=n(7),a=s.Router();a.get("/my/:id",function(e,t,n){var s=Number(e.params.id);o.findById(s).then(function(e){e?r.ResourceFound(t,e):r.ResourceNotFound(t,{ID:s})}).catch(function(e){console.log("error",e),r.InternalServerError(t,e,{ID:s})})}),e.exports=a},function(e,t,n){"use strict";var r=n(2),s=n(1).Router(),o=n(59);s.get("/",function(e,t,n){Number(e.params.id);r.ResourceFound(t,o)}),e.exports=s},function(e,t,n){"use strict";e.exports={menus:[{key:5,name:"养管合同",icon:"home",url:"/app/yght/list"},{key:1,name:"角色管理",icon:"user",url:"/app/role"},{key:2,name:"用户管理",icon:"laptop",url:"/app/user"},{key:3,name:"权限管理",icon:"notification",url:"/app/auth"}]}},function(e,t,n){"use strict";n(2);var r=n(1),s=n(61),o=r.Router();o.get("/",function(e,t,n){s.pagingQuery(e,t)}),e.exports=o},function(e,t,n){"use strict";var r=function(e){return e&&e.__esModule?e:{default:e}}(n(62)),s=n(4),o=n(63),a=n(2),i=o.define("workitem",{ID:{type:s.INTEGER},CaseCatalog:{type:s.STRING},ParentCatalogName:{type:s.STRING},SubName:{type:s.STRING},ViewResult:{type:s.STRING},DealWithDesc:{type:s.STRING},FacilityDesc:{type:s.STRING},MonitoringUnit:{type:s.STRING},FinishedStandard:{type:s.STRING},RegistStandard:{type:s.STRING}},{timestamps:!1,tableName:"V_W_WorkingItems_Prices"});i.pagingQuery=function(e,t){var n=Number(e.query.page)||1,u=Number(e.query.results)||10,c=e.query.sortField||"ID",l=function(e){return e?e.replace("end",""):"asc"}(e.query.sortOrder),p=e.query.SubName||"%",d=e.query.ParentCatalogName||"%";u>100&&(u=100);var f="declare @rowsPerPage as bigint; declare @pageNum as bigint;set @rowsPerPage="+u+"; set @pageNum="+n+";   With SQLPaging As   ( Select Top(@rowsPerPage * @pageNum) ROW_NUMBER() OVER ( ORDER BY "+c+" "+l+") as resultNum, * FROM V_W_WorkingItems_Prices where SubName like :subName and ParentCatalogName like :parentName)select * from SQLPaging with (nolock) where resultNum > ((@pageNum - 1) * @rowsPerPage); ",m={};i.count({where:{SubName:(0,r.default)({},s.Op.like,"%"+p+"%"),ParentCatalogName:(0,r.default)({},s.Op.like,"%"+d+"%")}}).then(function(e){return m.count=e,o.query(f,{replacements:{subName:"%"+p+"%",parentName:"%"+d+"%"},model:i})}).then(function(e){e?(m.data=e,a.ResourceFound(t,m)):a.ResourceNotFound(t,{ID:all})}).catch(function(e){console.log("error",e),a.InternalServerError(t,e,{ID:all})})},e.exports=i},function(e,t){e.exports=require("babel-runtime/helpers/defineProperty")},function(e,t,n){"use strict";var r=new(n(4))("SUP_APP_RoadInspectCaseDatabase2011_20110428-G","sa","ghjsj",{host:"61.136.61.40",dialect:"mssql",dialectOptions:{options:{tdsVersion:"7_3_A"}},pool:{max:5,min:0,acquire:3e4,idle:1e4}});e.exports=r}]);
//# sourceMappingURL=server.js.map